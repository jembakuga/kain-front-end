{"ast":null,"code":"import { Droppable, isBlazor } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, remove, updateBlazorTemplate, removeClass } from '@syncfusion/ej2-base';\nimport { getUpdateUsingRaf, appendChildren } from '../base/util';\nimport * as events from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowRenderer } from './row-renderer';\nimport { CellMergeRender } from './cell-merge-renderer';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { getScrollBarWidth, isGroupAdaptive } from '../base/util';\n/**\n * Content module is used to render grid content\n * @hidden\n */\n\nvar ContentRender =\n/** @class */\nfunction () {\n  /**\n   * Constructor for content renderer module\n   */\n  function ContentRender(parent, serviceLocator) {\n    var _this = this;\n\n    this.rows = [];\n    this.freezeRows = [];\n    this.movableRows = [];\n    this.freezeRowElements = [];\n    this.isLoaded = true;\n    this.viewColIndexes = [];\n\n    this.drop = function (e) {\n      _this.parent.notify(events.columnDrop, {\n        target: e.target,\n        droppedElement: e.droppedElement\n      });\n\n      remove(e.droppedElement);\n    };\n\n    this.rafCallback = function (args) {\n      var arg = args;\n      return function () {\n        if (_this.parent.getFrozenColumns() && _this.parent.enableVirtualization) {\n          var mContentRows = [].slice.call(_this.parent.getMovableVirtualContent().querySelectorAll('.e-row'));\n          var fContentRows = [].slice.call(_this.parent.getFrozenVirtualContent().querySelectorAll('.e-row'));\n          _this.isLoaded = !mContentRows ? false : mContentRows.length === fContentRows.length;\n\n          if (_this.parent.enableColumnVirtualization && args.requestType === 'virtualscroll' && _this.isLoaded) {\n            var mHdr = [].slice.call(_this.parent.getMovableVirtualHeader().querySelectorAll('.e-row'));\n            var fHdr = [].slice.call(_this.parent.getFrozenVirtualHeader().querySelectorAll('.e-row'));\n            _this.isLoaded = mHdr.length === fHdr.length;\n          }\n        }\n\n        _this.ariaService.setBusy(_this.getPanel().querySelector('.e-content'), false);\n\n        if (_this.parent.isDestroyed) {\n          return;\n        }\n\n        var rows = _this.rows.slice(0);\n\n        if (_this.parent.getFrozenColumns() !== 0) {\n          rows = args.isFrozen ? _this.freezeRows : _this.movableRows;\n        }\n\n        _this.parent.notify(events.contentReady, {\n          rows: rows,\n          args: arg\n        });\n\n        if (_this.isLoaded) {\n          _this.parent.trigger(events.dataBound, {});\n\n          if (_this.parent.allowTextWrap) {\n            _this.parent.notify(events.freezeRender, {\n              case: 'textwrap'\n            });\n          }\n        }\n\n        if (arg) {\n          var action = (arg.requestType || '').toLowerCase() + '-complete';\n\n          _this.parent.notify(action, arg);\n\n          if (args.requestType === 'batchsave') {\n            args.cancel = false;\n\n            _this.parent.trigger(events.actionComplete, args);\n          }\n        }\n\n        if (_this.isLoaded) {\n          _this.parent.hideSpinner();\n        }\n      };\n    };\n\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.ariaService = this.serviceLocator.getService('ariaService');\n    this.generator = this.getModelGenerator();\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (!this.parent.enableColumnVirtualization && !this.parent.enableVirtualization) {\n      this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n    }\n\n    this.parent.on(events.colGroupRefresh, this.colGroupRefresh, this);\n    this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n  }\n  /**\n   * The function is used to render grid content div\n   */\n\n\n  ContentRender.prototype.renderPanel = function () {\n    var gObj = this.parent;\n    var div = this.parent.element.querySelector('.e-gridcontent');\n\n    if (div) {\n      this.ariaService.setOptions(this.parent.element.querySelector('.e-content'), {\n        busy: false\n      });\n      this.setPanel(div);\n      return;\n    }\n\n    div = this.parent.createElement('div', {\n      className: 'e-gridcontent'\n    });\n    var innerDiv = this.parent.createElement('div', {\n      className: 'e-content'\n    });\n    this.ariaService.setOptions(innerDiv, {\n      busy: false\n    });\n    div.appendChild(innerDiv);\n    this.setPanel(div);\n    gObj.element.appendChild(div);\n  };\n  /**\n   * The function is used to render grid content table\n   */\n\n\n  ContentRender.prototype.renderTable = function () {\n    var contentDiv = this.getPanel();\n    var virtualTable = contentDiv.querySelector('.e-virtualtable');\n    var virtualTrack = contentDiv.querySelector('.e-virtualtrack');\n\n    if (this.parent.enableVirtualization && !isNullOrUndefined(virtualTable) && !isNullOrUndefined(virtualTrack)) {\n      remove(virtualTable);\n      remove(virtualTrack);\n    }\n\n    contentDiv.appendChild(this.createContentTable('_content_table'));\n    this.setTable(contentDiv.querySelector('.e-table'));\n    this.ariaService.setOptions(this.getTable(), {\n      multiselectable: this.parent.selectionSettings.type === 'Multiple'\n    });\n    this.initializeContentDrop();\n\n    if (this.parent.frozenRows) {\n      this.parent.getHeaderContent().classList.add('e-frozenhdrcont');\n    }\n  };\n  /**\n   * The function is used to create content table elements\n   * @return {Element}\n   * @hidden\n   */\n\n\n  ContentRender.prototype.createContentTable = function (id) {\n    var innerDiv = this.getPanel().firstElementChild;\n\n    if (!isBlazor()) {\n      if (this.getTable()) {\n        remove(this.getTable());\n      }\n    }\n\n    var table = innerDiv.querySelector('.e-table') ? innerDiv.querySelector('.e-table') : this.parent.createElement('table', {\n      className: 'e-table',\n      attrs: {\n        cellspacing: '0.25px',\n        role: 'grid',\n        id: this.parent.element.id + id\n      }\n    });\n    this.setColGroup(this.parent.element.querySelector('.e-gridheader').querySelector('colgroup').cloneNode(true));\n    table.appendChild(this.getColGroup());\n    table.appendChild(this.parent.createElement('tbody'));\n    innerDiv.appendChild(table);\n    return innerDiv;\n  };\n\n  ContentRender.prototype.splitRows = function (idx) {\n    if (this.parent.getFrozenColumns()) {\n      if (idx === 0) {\n        this.freezeRows = this.rows;\n        this.freezeRowElements = this.rowElements;\n      } else {\n        this.movableRows = this.rows;\n      }\n    }\n  };\n  /**\n   * Refresh the content of the Grid.\n   * @return {void}\n   */\n  // tslint:disable-next-line:max-func-body-length\n\n\n  ContentRender.prototype.refreshContentRows = function (args) {\n    var _this = this;\n\n    if (args === void 0) {\n      args = {};\n    }\n\n    var gObj = this.parent;\n\n    if (gObj.currentViewData.length === 0) {\n      return;\n    }\n\n    var dataSource = gObj.currentViewData;\n    var frag = document.createDocumentFragment();\n    var hdrfrag = document.createDocumentFragment();\n    var columns = gObj.getColumns();\n    var tr;\n    var hdrTbody;\n    var frzCols = gObj.getFrozenColumns();\n    var trElement;\n    var row = new RowRenderer(this.serviceLocator, null, this.parent);\n    this.rowElements = [];\n    this.rows = [];\n    var fCont = this.getPanel().querySelector('.e-frozencontent');\n    var mCont = this.getPanel().querySelector('.e-movablecontent');\n    var cont = this.getPanel().querySelector('.e-content');\n\n    if (isGroupAdaptive(gObj)) {\n      if (['sorting', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder'].some(function (value) {\n        return args.requestType === value;\n      })) {\n        gObj.vcRows = [];\n        gObj.vRows = [];\n      }\n    }\n\n    var modelData;\n    var isServerRendered = 'isServerRendered';\n\n    if (isBlazor() && this.parent[isServerRendered]) {\n      modelData = this.generator.generateRows(dataSource, args);\n      this.rows = modelData;\n      this.freezeRows = modelData;\n      this.rowElements = [].slice.call(this.getTable().querySelectorAll('tr.e-row[data-uid]'));\n\n      if (frzCols) {\n        this.movableRows = modelData.map(function (mRow) {\n          var sRow = new Row(mRow);\n          sRow.cells = mRow.cells.slice(frzCols, mRow.cells.length);\n          mRow.cells = mRow.cells.slice(0, frzCols);\n          return sRow;\n        });\n        this.freezeRowElements = this.rowElements;\n      }\n\n      this.isLoaded = true;\n      this.parent.hideSpinner();\n      args.isFrozen = this.parent.getFrozenColumns() !== 0 && !args.isFrozen;\n      var arg = extend({\n        rows: this.rows\n      }, args);\n\n      if (this.getTable().querySelector('.e-emptyrow')) {\n        remove(this.getTable().querySelector('.e-emptyrow'));\n      }\n\n      if (frzCols) {\n        cont.style.overflowY = 'hidden';\n        fCont.style.height = mCont.offsetHeight - getScrollBarWidth() + 'px';\n        mCont.style.overflowY = this.parent.height !== 'auto' ? 'scroll' : 'auto';\n        fCont.style.borderRightWidth = '1px';\n        this.parent.notify(events.contentReady, {\n          rows: this.movableRows,\n          args: extend({}, arg, {\n            isFrozen: false\n          })\n        });\n      }\n\n      if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple') || !this.parent.isPersistSelection) {\n        if (this.parent.editSettings.mode === 'Normal') {\n          var rowIndex = 'editRowIndex';\n          this.parent.selectRow(args[rowIndex]);\n        }\n      }\n\n      this.rafCallback(arg)();\n      return;\n    }\n\n    if (this.parent.enableVirtualization && this.parent.getFrozenColumns()) {\n      if (this.parent.enableColumnVirtualization) {\n        if (args.requestType === 'virtualscroll' && args.virtualInfo.sentinelInfo.axis === 'X') {\n          modelData = this.parent.contentModule.generateRows(dataSource, args);\n          args.renderMovableContent = true;\n        } else if (mCont.scrollLeft > 0 && !args.renderMovableContent) {\n          this.viewColIndexes = args.virtualInfo.columnIndexes;\n          var indexes = [];\n\n          for (var i = 0; i < this.parent.getFrozenColumns(); i++) {\n            indexes.push(i);\n          }\n\n          this.parent.setColumnIndexesInView(indexes);\n          args.virtualInfo.columnIndexes = indexes;\n        }\n      }\n\n      modelData = this.parent.contentModule.generateRows(dataSource, args);\n    } else {\n      modelData = this.generator.generateRows(dataSource, args);\n    }\n\n    if (isNullOrUndefined(modelData[0].cells[0])) {\n      mCont.querySelector('tbody').innerHTML = '';\n    }\n\n    var idx = modelData[0].cells[0].index;\n\n    if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns() && args.renderMovableContent && args.requestType === 'virtualscroll' && mCont.scrollLeft > 0 && args.virtualInfo.columnIndexes[0] !== 0) {\n      idx = this.parent.getFrozenColumns();\n    }\n    /* tslint:disable:no-any */\n\n\n    if (this.parent.registeredTemplate && this.parent.registeredTemplate.template && !args.isFrozen) {\n      var templatetoclear = [];\n\n      for (var i = 0; i < this.parent.registeredTemplate.template.length; i++) {\n        for (var j = 0; j < this.parent.registeredTemplate.template[i].rootNodes.length; j++) {\n          if (isNullOrUndefined(this.parent.registeredTemplate.template[i].rootNodes[j].parentNode)) {\n            templatetoclear.push(this.parent.registeredTemplate.template[i]);\n            /* tslint:enable:no-any */\n          }\n        }\n      }\n\n      this.parent.destroyTemplate(['template'], templatetoclear);\n    }\n\n    if (this.parent.enableColumnVirtualization) {\n      var cellMerge = new CellMergeRender(this.serviceLocator, this.parent);\n      cellMerge.updateVirtualCells(modelData);\n    }\n\n    if (frzCols && idx >= frzCols) {\n      this.tbody = mCont.querySelector('tbody');\n    } else {\n      this.tbody = this.getTable().querySelector('tbody');\n    }\n\n    var startIndex = 0;\n    var blockLoad = true;\n\n    if (isGroupAdaptive(gObj) && gObj.vcRows.length) {\n      var top_1 = 'top';\n      var scrollTop = !isNullOrUndefined(args.virtualInfo.offsets) ? args.virtualInfo.offsets.top : !isNullOrUndefined(args.scrollTop) ? args.scrollTop[top_1] : 0;\n\n      if (scrollTop !== 0) {\n        var offsets_1 = gObj.vGroupOffsets;\n        var bSize = gObj.pageSettings.pageSize / 2;\n        var values = Object.keys(offsets_1).map(function (key) {\n          return offsets_1[key];\n        });\n\n        for (var m = 0; m < values.length; m++) {\n          if (scrollTop < values[m]) {\n            if (!isNullOrUndefined(args.virtualInfo) && args.virtualInfo.direction === 'up') {\n              args.virtualInfo.blockIndexes = m === 0 || m === 1 ? [1, 2] : [m, m + 1];\n              startIndex = m === 0 || m === 1 ? 0 : m * bSize;\n              break;\n            } else {\n              args.virtualInfo.blockIndexes = m === 0 || m === 1 ? [1, 2] : [m, m + 1];\n              startIndex = m === 0 || m === 1 ? 0 : m * bSize;\n              break;\n            }\n          }\n        }\n\n        if (scrollTop + this.contentPanel.firstElementChild.offsetHeight === this.contentPanel.firstElementChild.scrollHeight && !args.rowObject) {\n          blockLoad = false;\n        }\n      }\n    }\n\n    if (gObj.frozenRows && args.requestType === 'virtualscroll' && args.virtualInfo.sentinelInfo.axis === 'X') {\n      var bIndex = args.virtualInfo.blockIndexes;\n      args.virtualInfo.blockIndexes = [1, 2];\n      var mhdrData = this.vgenerator.generateRows(dataSource, args);\n      mhdrData.splice(this.parent.frozenRows);\n\n      for (var i = 0; i < this.parent.frozenRows; i++) {\n        if (args.virtualInfo.columnIndexes[0] === 0) {\n          mhdrData[i].cells.splice(0, this.parent.getFrozenColumns());\n        }\n\n        tr = row.render(mhdrData[i], columns);\n        hdrfrag.appendChild(tr);\n      }\n\n      args.virtualInfo.blockIndexes = bIndex;\n    }\n\n    for (var i = startIndex, len = modelData.length; i < len; i++) {\n      this.rows.push(modelData[i]);\n\n      if (isGroupAdaptive(gObj) && this.rows.length >= gObj.pageSettings.pageSize && blockLoad) {\n        break;\n      }\n\n      if (!gObj.rowTemplate) {\n        tr = row.render(modelData[i], columns);\n\n        if (gObj.frozenRows && i < gObj.frozenRows && args.requestType !== 'virtualscroll') {\n          hdrfrag.appendChild(tr);\n        } else {\n          frag.appendChild(tr);\n        }\n\n        if (modelData[i].isExpand) {\n          gObj.notify(events.expandChildGrid, tr.cells[gObj.groupSettings.columns.length]);\n        }\n      } else {\n        var rowTemplateID = gObj.element.id + 'rowTemplate';\n        var elements = gObj.getRowTemplate()(extend({\n          index: i\n        }, dataSource[i]), gObj, 'rowTemplate', rowTemplateID);\n\n        if (elements[0].tagName === 'TBODY') {\n          for (var j = 0; j < elements.length; j++) {\n            var isTR = elements[j].nodeName.toLowerCase() === 'tr';\n\n            if (isTR || elements[j].querySelectorAll && elements[j].querySelectorAll('tr').length) {\n              tr = isTR ? elements[j] : elements[j].querySelector('tr');\n            }\n          }\n\n          if (gObj.frozenRows && i < gObj.frozenRows) {\n            hdrfrag.appendChild(tr);\n          } else {\n            frag.appendChild(tr);\n          }\n        } else {\n          if (gObj.frozenRows && i < gObj.frozenRows) {\n            tr = appendChildren(hdrfrag, elements);\n          } else {\n            // frag.appendChild(tr);\n            tr = appendChildren(frag, elements);\n            trElement = tr.lastElementChild;\n          }\n        }\n\n        var arg = {\n          data: modelData[i].data,\n          row: trElement ? trElement : tr\n        };\n        this.parent.trigger(events.rowDataBound, arg);\n      }\n\n      if (modelData[i].isDataRow) {\n        this.rowElements.push(tr);\n      }\n\n      this.ariaService.setOptions(this.getTable(), {\n        colcount: gObj.getColumns().length.toString()\n      });\n    }\n\n    this.splitRows(idx);\n\n    if (gObj.frozenRows && args.requestType !== 'virtualscroll' || args.requestType === 'virtualscroll' && args.virtualInfo.sentinelInfo && args.virtualInfo.sentinelInfo.axis === 'X') {\n      hdrTbody = frzCols ? gObj.getHeaderContent().querySelector(idx === 0 ? '.e-frozenheader' : '.e-movableheader').querySelector('tbody') : gObj.getHeaderTable().querySelector('tbody');\n      hdrTbody.innerHTML = '';\n      hdrTbody.appendChild(hdrfrag);\n    }\n\n    if (gObj.frozenRows && idx === 0 && cont.offsetHeight === Number(gObj.height)) {\n      cont.style.height = cont.offsetHeight - hdrTbody.offsetHeight + 'px';\n    }\n\n    if (frzCols && idx === 0) {\n      this.getPanel().firstChild.style.overflowY = 'hidden';\n    }\n\n    if (!isBlazor() || this.parent.isJsComponent) {\n      args.rows = this.rows.slice(0);\n    }\n\n    args.isFrozen = this.parent.getFrozenColumns() !== 0 && !args.isFrozen;\n    this.index = idx;\n    getUpdateUsingRaf(function () {\n      _this.parent.notify(events.beforeFragAppend, args);\n\n      var isVFTable = _this.parent.enableVirtualization && _this.parent.getFrozenColumns() !== 0;\n\n      if (!_this.parent.enableVirtualization) {\n        remove(_this.tbody);\n        _this.tbody = _this.parent.createElement('tbody');\n      }\n\n      if (frzCols && !isVFTable) {\n        _this.tbody.appendChild(frag);\n\n        if (_this.index === 0) {\n          _this.isLoaded = false;\n          fCont.querySelector('table').appendChild(_this.tbody);\n        } else {\n          if (_this.tbody.childElementCount < 1) {\n            _this.tbody.appendChild(_this.parent.createElement('tr').appendChild(_this.parent.createElement('td')));\n          }\n\n          _this.isLoaded = true;\n          mCont.querySelector('table').appendChild(_this.tbody);\n\n          if (_this.parent.getFrozenColumns() !== 0 && !_this.parent.allowTextWrap) {\n            _this.parent.notify(events.freezeRender, {\n              case: 'refreshHeight'\n            });\n          }\n\n          fCont.style.height = mCont.offsetHeight - getScrollBarWidth() + 'px';\n          mCont.style.overflowY = _this.parent.height !== 'auto' ? 'scroll' : 'auto';\n          fCont.style.borderRightWidth = '1px';\n        }\n      } else {\n        if (gObj.rowTemplate) {\n          updateBlazorTemplate(gObj.element.id + 'rowTemplate', 'RowTemplate', gObj);\n        }\n\n        if (isVFTable) {\n          if (!args.renderMovableContent) {\n            _this.appendContent(fCont.querySelector('tbody'), frag, args);\n\n            if (_this.parent.enableColumnVirtualization && mCont.scrollLeft > 0) {\n              _this.parent.setColumnIndexesInView(_this.viewColIndexes);\n\n              args.virtualInfo.columnIndexes = _this.viewColIndexes;\n            }\n          } else {\n            _this.appendContent(mCont.querySelector('tbody'), frag, args);\n\n            if (args.virtualInfo && args.virtualInfo.direction !== 'right' && args.virtualInfo.direction !== 'left') {\n              fCont.style.height = mCont.offsetHeight - getScrollBarWidth() + 'px';\n            }\n\n            args.renderMovableContent = false;\n          }\n        } else {\n          _this.appendContent(_this.tbody, frag, args);\n        }\n      }\n\n      if (frzCols && idx === 0) {\n        if (isVFTable) {\n          args.renderMovableContent = true;\n        }\n\n        _this.refreshContentRows(extend({}, args));\n      }\n\n      frag = null;\n    }, this.rafCallback(extend({}, args)));\n  };\n\n  ContentRender.prototype.appendContent = function (tbody, frag, args) {\n    tbody.appendChild(frag);\n    this.getTable().appendChild(tbody);\n  };\n  /**\n   * Get the content div element of grid\n   * @return {Element}\n   */\n\n\n  ContentRender.prototype.getPanel = function () {\n    return this.contentPanel;\n  };\n  /**\n   * Set the content div element of grid\n   * @param  {Element} panel\n   */\n\n\n  ContentRender.prototype.setPanel = function (panel) {\n    this.contentPanel = panel;\n  };\n  /**\n   * Get the content table element of grid\n   * @return {Element}\n   */\n\n\n  ContentRender.prototype.getTable = function () {\n    return this.contentTable;\n  };\n  /**\n   * Set the content table element of grid\n   * @param  {Element} table\n   */\n\n\n  ContentRender.prototype.setTable = function (table) {\n    this.contentTable = table;\n  };\n  /**\n   * Get the Row collection in the Grid.\n   * @returns {Row[] | HTMLCollectionOf<HTMLTableRowElement>}\n   */\n\n\n  ContentRender.prototype.getRows = function () {\n    return this.parent.getFrozenColumns() ? this.freezeRows : this.rows;\n  };\n  /**\n   * Get the Movable Row collection in the Freeze pane Grid.\n   * @returns {Row[] | HTMLCollectionOf<HTMLTableRowElement>}\n   */\n\n\n  ContentRender.prototype.getMovableRows = function () {\n    return this.movableRows;\n  };\n  /**\n   * Get the content table data row elements\n   * @return {Element}\n   */\n\n\n  ContentRender.prototype.getRowElements = function () {\n    return this.parent.getFrozenColumns() ? this.freezeRowElements : this.rowElements;\n  };\n  /**\n   * Get the Freeze pane movable content table data row elements\n   * @return {Element}\n   */\n\n\n  ContentRender.prototype.getMovableRowElements = function () {\n    return this.rowElements;\n  };\n  /**\n   * Get the content table data row elements\n   * @return {Element}\n   */\n\n\n  ContentRender.prototype.setRowElements = function (elements) {\n    this.rowElements = elements;\n  };\n  /**\n   * Get the header colgroup element\n   * @returns {Element}\n   */\n\n\n  ContentRender.prototype.getColGroup = function () {\n    return this.colgroup;\n  };\n  /**\n   * Set the header colgroup element\n   * @param {Element} colgroup\n   * @returns {Element}\n   */\n\n\n  ContentRender.prototype.setColGroup = function (colGroup) {\n    if (!isNullOrUndefined(colGroup)) {\n      colGroup.id = 'content-' + colGroup.id;\n    }\n\n    return this.colgroup = colGroup;\n  };\n  /**\n   * Function to hide content table column based on visible property\n   * @param  {Column[]} columns?\n   */\n\n\n  ContentRender.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n\n    if (isBlazor() && gObj.isServerRendered) {\n      this.parent.notify('setvisibility', columns);\n    }\n\n    var frzCols = gObj.getFrozenColumns();\n    var rows = [];\n\n    if (frzCols) {\n      var fRows = this.freezeRows;\n      var mRows = this.movableRows;\n      var rowLen = fRows.length;\n      var cellLen = void 0;\n\n      for (var i = 0, row = void 0; i < rowLen; i++) {\n        cellLen = mRows[i].cells.length;\n        row = fRows[i].clone();\n\n        for (var j = 0; j < cellLen; j++) {\n          row.cells.push(mRows[i].cells[j]);\n        }\n\n        rows.push(row);\n      }\n    } else {\n      rows = this.getRows();\n    }\n\n    var element;\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n\n      return r.isDataRow;\n    });\n    var tasks = [];\n    var needFullRefresh = true;\n\n    if (!gObj.groupSettings.columns.length && testRow) {\n      needFullRefresh = false;\n    }\n\n    var tr = gObj.getDataRows();\n    var args = {};\n    var contentrows = this.rows.filter(function (row) {\n      return !row.isDetailRow;\n    });\n\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[c];\n      var idx = this.parent.getNormalizedColumnIndex(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        if (frzCols) {\n          if (idx < frzCols) {\n            setStyleAttribute(this.getColGroup().childNodes[idx], {\n              'display': displayVal\n            });\n            contentrows = this.freezeRows;\n          } else {\n            var mTable = gObj.getContent().querySelector('.e-movablecontent').querySelector('colgroup');\n            idx = idx - frzCols;\n            setStyleAttribute(mTable.childNodes[idx], {\n              'display': displayVal\n            });\n            tr = gObj.getMovableDataRows();\n            contentrows = this.movableRows;\n          }\n        } else {\n          if (gObj.isRowDragable()) {\n            idx++;\n          }\n\n          setStyleAttribute(this.getColGroup().childNodes[idx], {\n            'display': displayVal\n          });\n\n          if (gObj.isRowDragable()) {\n            idx--;\n          }\n        }\n      }\n\n      idx = gObj.isDetail() ? idx - 1 : idx;\n\n      if (!needFullRefresh) {\n        this.setDisplayNone(tr, idx, displayVal, contentrows);\n      }\n\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n\n      this.parent.invokedFromMedia = false;\n    }\n\n    if (needFullRefresh) {\n      this.refreshContentRows({\n        requestType: 'refresh'\n      });\n    } else {\n      if (!this.parent.getFrozenColumns()) {\n        this.parent.notify(events.partialRefresh, {\n          rows: contentrows,\n          args: args\n        });\n      } else {\n        this.parent.notify(events.partialRefresh, {\n          rows: this.freezeRows,\n          args: {\n            isFrozen: true,\n            rows: this.freezeRows\n          }\n        });\n        this.parent.notify(events.partialRefresh, {\n          rows: this.movableRows,\n          args: {\n            isFrozen: false,\n            rows: this.movableRows\n          }\n        });\n      }\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  ContentRender.prototype.setDisplayNone = function (tr, idx, displayVal, rows) {\n    Object.keys(tr).forEach(function (i) {\n      if (tr[i].querySelectorAll('td.e-rowcell').length) {\n        setStyleAttribute(tr[i].querySelectorAll('td.e-rowcell')[idx], {\n          'display': displayVal\n        });\n\n        if (tr[i].querySelectorAll('td.e-rowcell')[idx].classList.contains('e-hide')) {\n          removeClass([tr[i].querySelectorAll('td.e-rowcell')[idx]], ['e-hide']);\n        }\n\n        rows[i].cells[idx].visible = displayVal === '' ? true : false;\n      }\n    });\n  };\n\n  ContentRender.prototype.colGroupRefresh = function () {\n    if (this.getColGroup()) {\n      var colGroup = void 0;\n\n      if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns()) {\n        colGroup = this.parent.getMovableVirtualHeader().querySelector('colgroup').cloneNode(true);\n      } else {\n        colGroup = isBlazor() ? this.parent.getHeaderTable().querySelector('colgroup').cloneNode(true) : this.parent.element.querySelector('.e-gridheader').querySelector('colgroup').cloneNode(true);\n      }\n\n      this.getTable().replaceChild(colGroup, this.getColGroup());\n      this.setColGroup(colGroup);\n    }\n  };\n\n  ContentRender.prototype.initializeContentDrop = function () {\n    var gObj = this.parent;\n    var drop = new Droppable(gObj.getContent(), {\n      accept: '.e-dragclone',\n      drop: this.drop\n    });\n  };\n\n  ContentRender.prototype.canSkip = function (column, row, index) {\n    /**\n     * Skip the toggle visiblity operation when one of the following success\n     * 1. Grid has empty records\n     * 2. column visible property is unchanged\n     * 3. cell`s isVisible property is same as column`s visible property.\n     */\n    return isNullOrUndefined(row) || //(1)\n    isNullOrUndefined(column.visible) || //(2)    \n    row.cells[index].visible === column.visible; //(3)\n  };\n\n  ContentRender.prototype.getModelGenerator = function () {\n    return this.generator = this.parent.allowGrouping ? new GroupModelGenerator(this.parent) : new RowModelGenerator(this.parent);\n  };\n\n  ContentRender.prototype.renderEmpty = function (tbody) {\n    if (isBlazor() && !this.parent.isJsComponent && this.parent.frozenRows) {\n      return;\n    }\n\n    this.getTable().appendChild(tbody);\n\n    if (this.parent.frozenRows) {\n      this.parent.getHeaderContent().querySelector('tbody').innerHTML = '';\n    }\n  };\n\n  ContentRender.prototype.setSelection = function (uid, set, clearAll) {\n    if (this.parent.getFrozenColumns()) {\n      this.getMovableRows().filter(function (row) {\n        return clearAll || uid === row.uid;\n      }).forEach(function (row) {\n        return row.isSelected = set;\n      });\n    }\n\n    this.getRows().filter(function (row) {\n      return clearAll || uid === row.uid;\n    }).forEach(function (row) {\n      row.isSelected = set;\n      row.cells.forEach(function (cell) {\n        return cell.isSelected = set;\n      });\n    });\n  };\n\n  ContentRender.prototype.getRowByIndex = function (index) {\n    return this.parent.getDataRows()[index];\n  };\n\n  ContentRender.prototype.getVirtualRowIndex = function (index) {\n    return index;\n  };\n\n  ContentRender.prototype.getMovableRowByIndex = function (index) {\n    return this.parent.getMovableDataRows()[index];\n  };\n\n  ContentRender.prototype.enableAfterRender = function (e) {\n    if (e.module === 'group' && e.enable) {\n      this.generator = this.getModelGenerator();\n    }\n  };\n\n  ContentRender.prototype.setRowObjects = function (rows) {\n    this.rows = rows;\n  };\n\n  return ContentRender;\n}();\n\nexport { ContentRender };","map":{"version":3,"sources":["C:/CN2/workspace-trunk/kain-front-end/node_modules/@syncfusion/ej2-grids/src/grid/renderer/content-renderer.js"],"names":["Droppable","isBlazor","isNullOrUndefined","extend","setStyleAttribute","remove","updateBlazorTemplate","removeClass","getUpdateUsingRaf","appendChildren","events","Row","RowRenderer","CellMergeRender","RowModelGenerator","GroupModelGenerator","getScrollBarWidth","isGroupAdaptive","ContentRender","parent","serviceLocator","_this","rows","freezeRows","movableRows","freezeRowElements","isLoaded","viewColIndexes","drop","e","notify","columnDrop","target","droppedElement","rafCallback","args","arg","getFrozenColumns","enableVirtualization","mContentRows","slice","call","getMovableVirtualContent","querySelectorAll","fContentRows","getFrozenVirtualContent","length","enableColumnVirtualization","requestType","mHdr","getMovableVirtualHeader","fHdr","getFrozenVirtualHeader","ariaService","setBusy","getPanel","querySelector","isDestroyed","isFrozen","contentReady","trigger","dataBound","allowTextWrap","freezeRender","case","action","toLowerCase","cancel","actionComplete","hideSpinner","getService","generator","getModelGenerator","on","columnVisibilityChanged","setVisible","colGroupRefresh","uiUpdate","enableAfterRender","prototype","renderPanel","gObj","div","element","setOptions","busy","setPanel","createElement","className","innerDiv","appendChild","renderTable","contentDiv","virtualTable","virtualTrack","createContentTable","setTable","getTable","multiselectable","selectionSettings","type","initializeContentDrop","frozenRows","getHeaderContent","classList","add","id","firstElementChild","table","attrs","cellspacing","role","setColGroup","cloneNode","getColGroup","splitRows","idx","rowElements","refreshContentRows","currentViewData","dataSource","frag","document","createDocumentFragment","hdrfrag","columns","getColumns","tr","hdrTbody","frzCols","trElement","row","fCont","mCont","cont","some","value","vcRows","vRows","modelData","isServerRendered","generateRows","map","mRow","sRow","cells","style","overflowY","height","offsetHeight","borderRightWidth","isCheckBoxSelection","isPersistSelection","editSettings","mode","rowIndex","selectRow","virtualInfo","sentinelInfo","axis","contentModule","renderMovableContent","scrollLeft","columnIndexes","indexes","i","push","setColumnIndexesInView","innerHTML","index","registeredTemplate","template","templatetoclear","j","rootNodes","parentNode","destroyTemplate","cellMerge","updateVirtualCells","tbody","startIndex","blockLoad","top_1","scrollTop","offsets","top","offsets_1","vGroupOffsets","bSize","pageSettings","pageSize","values","Object","keys","key","m","direction","blockIndexes","contentPanel","scrollHeight","rowObject","bIndex","mhdrData","vgenerator","splice","render","len","rowTemplate","isExpand","expandChildGrid","groupSettings","rowTemplateID","elements","getRowTemplate","tagName","isTR","nodeName","lastElementChild","data","rowDataBound","isDataRow","colcount","toString","getHeaderTable","Number","firstChild","isJsComponent","beforeFragAppend","isVFTable","childElementCount","appendContent","panel","contentTable","getRows","getMovableRows","getRowElements","getMovableRowElements","setRowElements","colgroup","colGroup","fRows","mRows","rowLen","cellLen","clone","testRow","r","tasks","needFullRefresh","getDataRows","contentrows","filter","isDetailRow","c","clen","column","getNormalizedColumnIndex","uid","displayVal","visible","childNodes","mTable","getContent","getMovableDataRows","isRowDragable","isDetail","setDisplayNone","invokedFromMedia","hideAtMedia","updateMediaColumns","partialRefresh","forEach","contains","replaceChild","accept","canSkip","allowGrouping","renderEmpty","setSelection","set","clearAll","isSelected","cell","getRowByIndex","getVirtualRowIndex","getMovableRowByIndex","module","enable","setRowObjects"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,sBAApC;AACA,SAASC,iBAAT,EAA4BC,MAA5B,QAA0C,sBAA1C;AACA,SAASC,iBAAT,EAA4BC,MAA5B,EAAoCC,oBAApC,EAA0DC,WAA1D,QAA6E,sBAA7E;AACA,SAASC,iBAAT,EAA4BC,cAA5B,QAAkD,cAAlD;AACA,OAAO,KAAKC,MAAZ,MAAwB,kBAAxB;AACA,SAASC,GAAT,QAAoB,eAApB;AACA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAASC,eAAT,QAAgC,uBAAhC;AACA,SAASC,iBAAT,QAAkC,iCAAlC;AACA,SAASC,mBAAT,QAAoC,mCAApC;AACA,SAASC,iBAAT,EAA4BC,eAA5B,QAAmD,cAAnD;AACA;;;;;AAIA,IAAIC,aAAa;AAAG;AAAe,YAAY;AAC3C;;;AAGA,WAASA,aAAT,CAAuBC,MAAvB,EAA+BC,cAA/B,EAA+C;AAC3C,QAAIC,KAAK,GAAG,IAAZ;;AACA,SAAKC,IAAL,GAAY,EAAZ;AACA,SAAKC,UAAL,GAAkB,EAAlB;AACA,SAAKC,WAAL,GAAmB,EAAnB;AACA,SAAKC,iBAAL,GAAyB,EAAzB;AACA,SAAKC,QAAL,GAAgB,IAAhB;AACA,SAAKC,cAAL,GAAsB,EAAtB;;AACA,SAAKC,IAAL,GAAY,UAAUC,CAAV,EAAa;AACrBR,MAAAA,KAAK,CAACF,MAAN,CAAaW,MAAb,CAAoBpB,MAAM,CAACqB,UAA3B,EAAuC;AAAEC,QAAAA,MAAM,EAAEH,CAAC,CAACG,MAAZ;AAAoBC,QAAAA,cAAc,EAAEJ,CAAC,CAACI;AAAtC,OAAvC;;AACA5B,MAAAA,MAAM,CAACwB,CAAC,CAACI,cAAH,CAAN;AACH,KAHD;;AAIA,SAAKC,WAAL,GAAmB,UAAUC,IAAV,EAAgB;AAC/B,UAAIC,GAAG,GAAGD,IAAV;AACA,aAAO,YAAY;AACf,YAAId,KAAK,CAACF,MAAN,CAAakB,gBAAb,MAAmChB,KAAK,CAACF,MAAN,CAAamB,oBAApD,EAA0E;AACtE,cAAIC,YAAY,GAAG,GAAGC,KAAH,CAASC,IAAT,CAAcpB,KAAK,CAACF,MAAN,CAAauB,wBAAb,GAAwCC,gBAAxC,CAAyD,QAAzD,CAAd,CAAnB;AACA,cAAIC,YAAY,GAAG,GAAGJ,KAAH,CAASC,IAAT,CAAcpB,KAAK,CAACF,MAAN,CAAa0B,uBAAb,GAAuCF,gBAAvC,CAAwD,QAAxD,CAAd,CAAnB;AACAtB,UAAAA,KAAK,CAACK,QAAN,GAAiB,CAACa,YAAD,GAAgB,KAAhB,GAAwBA,YAAY,CAACO,MAAb,KAAwBF,YAAY,CAACE,MAA9E;;AACA,cAAIzB,KAAK,CAACF,MAAN,CAAa4B,0BAAb,IAA2CZ,IAAI,CAACa,WAAL,KAAqB,eAAhE,IAAmF3B,KAAK,CAACK,QAA7F,EAAuG;AACnG,gBAAIuB,IAAI,GAAG,GAAGT,KAAH,CAASC,IAAT,CAAcpB,KAAK,CAACF,MAAN,CAAa+B,uBAAb,GAAuCP,gBAAvC,CAAwD,QAAxD,CAAd,CAAX;AACA,gBAAIQ,IAAI,GAAG,GAAGX,KAAH,CAASC,IAAT,CAAcpB,KAAK,CAACF,MAAN,CAAaiC,sBAAb,GAAsCT,gBAAtC,CAAuD,QAAvD,CAAd,CAAX;AACAtB,YAAAA,KAAK,CAACK,QAAN,GAAiBuB,IAAI,CAACH,MAAL,KAAgBK,IAAI,CAACL,MAAtC;AACH;AACJ;;AACDzB,QAAAA,KAAK,CAACgC,WAAN,CAAkBC,OAAlB,CAA0BjC,KAAK,CAACkC,QAAN,GAAiBC,aAAjB,CAA+B,YAA/B,CAA1B,EAAwE,KAAxE;;AACA,YAAInC,KAAK,CAACF,MAAN,CAAasC,WAAjB,EAA8B;AAC1B;AACH;;AACD,YAAInC,IAAI,GAAGD,KAAK,CAACC,IAAN,CAAWkB,KAAX,CAAiB,CAAjB,CAAX;;AACA,YAAInB,KAAK,CAACF,MAAN,CAAakB,gBAAb,OAAoC,CAAxC,EAA2C;AACvCf,UAAAA,IAAI,GAAGa,IAAI,CAACuB,QAAL,GAAgBrC,KAAK,CAACE,UAAtB,GAAmCF,KAAK,CAACG,WAAhD;AACH;;AACDH,QAAAA,KAAK,CAACF,MAAN,CAAaW,MAAb,CAAoBpB,MAAM,CAACiD,YAA3B,EAAyC;AAAErC,UAAAA,IAAI,EAAEA,IAAR;AAAca,UAAAA,IAAI,EAAEC;AAApB,SAAzC;;AACA,YAAIf,KAAK,CAACK,QAAV,EAAoB;AAChBL,UAAAA,KAAK,CAACF,MAAN,CAAayC,OAAb,CAAqBlD,MAAM,CAACmD,SAA5B,EAAuC,EAAvC;;AACA,cAAIxC,KAAK,CAACF,MAAN,CAAa2C,aAAjB,EAAgC;AAC5BzC,YAAAA,KAAK,CAACF,MAAN,CAAaW,MAAb,CAAoBpB,MAAM,CAACqD,YAA3B,EAAyC;AAAEC,cAAAA,IAAI,EAAE;AAAR,aAAzC;AACH;AACJ;;AACD,YAAI5B,GAAJ,EAAS;AACL,cAAI6B,MAAM,GAAG,CAAC7B,GAAG,CAACY,WAAJ,IAAmB,EAApB,EAAwBkB,WAAxB,KAAwC,WAArD;;AACA7C,UAAAA,KAAK,CAACF,MAAN,CAAaW,MAAb,CAAoBmC,MAApB,EAA4B7B,GAA5B;;AACA,cAAID,IAAI,CAACa,WAAL,KAAqB,WAAzB,EAAsC;AAClCb,YAAAA,IAAI,CAACgC,MAAL,GAAc,KAAd;;AACA9C,YAAAA,KAAK,CAACF,MAAN,CAAayC,OAAb,CAAqBlD,MAAM,CAAC0D,cAA5B,EAA4CjC,IAA5C;AACH;AACJ;;AACD,YAAId,KAAK,CAACK,QAAV,EAAoB;AAChBL,UAAAA,KAAK,CAACF,MAAN,CAAakD,WAAb;AACH;AACJ,OArCD;AAsCH,KAxCD;;AAyCA,SAAKlD,MAAL,GAAcA,MAAd;AACA,SAAKC,cAAL,GAAsBA,cAAtB;AACA,SAAKiC,WAAL,GAAmB,KAAKjC,cAAL,CAAoBkD,UAApB,CAA+B,aAA/B,CAAnB;AACA,SAAKC,SAAL,GAAiB,KAAKC,iBAAL,EAAjB;;AACA,QAAI,KAAKrD,MAAL,CAAYsC,WAAhB,EAA6B;AACzB;AACH;;AACD,QAAI,CAAC,KAAKtC,MAAL,CAAY4B,0BAAb,IAA2C,CAAC,KAAK5B,MAAL,CAAYmB,oBAA5D,EAAkF;AAC9E,WAAKnB,MAAL,CAAYsD,EAAZ,CAAe/D,MAAM,CAACgE,uBAAtB,EAA+C,KAAKC,UAApD,EAAgE,IAAhE;AACH;;AACD,SAAKxD,MAAL,CAAYsD,EAAZ,CAAe/D,MAAM,CAACkE,eAAtB,EAAuC,KAAKA,eAA5C,EAA6D,IAA7D;AACA,SAAKzD,MAAL,CAAYsD,EAAZ,CAAe/D,MAAM,CAACmE,QAAtB,EAAgC,KAAKC,iBAArC,EAAwD,IAAxD;AACH;AACD;;;;;AAGA5D,EAAAA,aAAa,CAAC6D,SAAd,CAAwBC,WAAxB,GAAsC,YAAY;AAC9C,QAAIC,IAAI,GAAG,KAAK9D,MAAhB;AACA,QAAI+D,GAAG,GAAG,KAAK/D,MAAL,CAAYgE,OAAZ,CAAoB3B,aAApB,CAAkC,gBAAlC,CAAV;;AACA,QAAI0B,GAAJ,EAAS;AACL,WAAK7B,WAAL,CAAiB+B,UAAjB,CAA4B,KAAKjE,MAAL,CAAYgE,OAAZ,CAAoB3B,aAApB,CAAkC,YAAlC,CAA5B,EAA6E;AAAE6B,QAAAA,IAAI,EAAE;AAAR,OAA7E;AACA,WAAKC,QAAL,CAAcJ,GAAd;AACA;AACH;;AACDA,IAAAA,GAAG,GAAG,KAAK/D,MAAL,CAAYoE,aAAZ,CAA0B,KAA1B,EAAiC;AAAEC,MAAAA,SAAS,EAAE;AAAb,KAAjC,CAAN;AACA,QAAIC,QAAQ,GAAG,KAAKtE,MAAL,CAAYoE,aAAZ,CAA0B,KAA1B,EAAiC;AAC5CC,MAAAA,SAAS,EAAE;AADiC,KAAjC,CAAf;AAGA,SAAKnC,WAAL,CAAiB+B,UAAjB,CAA4BK,QAA5B,EAAsC;AAAEJ,MAAAA,IAAI,EAAE;AAAR,KAAtC;AACAH,IAAAA,GAAG,CAACQ,WAAJ,CAAgBD,QAAhB;AACA,SAAKH,QAAL,CAAcJ,GAAd;AACAD,IAAAA,IAAI,CAACE,OAAL,CAAaO,WAAb,CAAyBR,GAAzB;AACH,GAhBD;AAiBA;;;;;AAGAhE,EAAAA,aAAa,CAAC6D,SAAd,CAAwBY,WAAxB,GAAsC,YAAY;AAC9C,QAAIC,UAAU,GAAG,KAAKrC,QAAL,EAAjB;AACA,QAAIsC,YAAY,GAAGD,UAAU,CAACpC,aAAX,CAAyB,iBAAzB,CAAnB;AACA,QAAIsC,YAAY,GAAGF,UAAU,CAACpC,aAAX,CAAyB,iBAAzB,CAAnB;;AACA,QAAI,KAAKrC,MAAL,CAAYmB,oBAAZ,IAAoC,CAACpC,iBAAiB,CAAC2F,YAAD,CAAtD,IAAwE,CAAC3F,iBAAiB,CAAC4F,YAAD,CAA9F,EAA8G;AAC1GzF,MAAAA,MAAM,CAACwF,YAAD,CAAN;AACAxF,MAAAA,MAAM,CAACyF,YAAD,CAAN;AACH;;AACDF,IAAAA,UAAU,CAACF,WAAX,CAAuB,KAAKK,kBAAL,CAAwB,gBAAxB,CAAvB;AACA,SAAKC,QAAL,CAAcJ,UAAU,CAACpC,aAAX,CAAyB,UAAzB,CAAd;AACA,SAAKH,WAAL,CAAiB+B,UAAjB,CAA4B,KAAKa,QAAL,EAA5B,EAA6C;AACzCC,MAAAA,eAAe,EAAE,KAAK/E,MAAL,CAAYgF,iBAAZ,CAA8BC,IAA9B,KAAuC;AADf,KAA7C;AAGA,SAAKC,qBAAL;;AACA,QAAI,KAAKlF,MAAL,CAAYmF,UAAhB,EAA4B;AACxB,WAAKnF,MAAL,CAAYoF,gBAAZ,GAA+BC,SAA/B,CAAyCC,GAAzC,CAA6C,iBAA7C;AACH;AACJ,GAjBD;AAkBA;;;;;;;AAKAvF,EAAAA,aAAa,CAAC6D,SAAd,CAAwBgB,kBAAxB,GAA6C,UAAUW,EAAV,EAAc;AACvD,QAAIjB,QAAQ,GAAG,KAAKlC,QAAL,GAAgBoD,iBAA/B;;AACA,QAAI,CAAC1G,QAAQ,EAAb,EAAiB;AACb,UAAI,KAAKgG,QAAL,EAAJ,EAAqB;AACjB5F,QAAAA,MAAM,CAAC,KAAK4F,QAAL,EAAD,CAAN;AACH;AACJ;;AACD,QAAIW,KAAK,GAAGnB,QAAQ,CAACjC,aAAT,CAAuB,UAAvB,IAAqCiC,QAAQ,CAACjC,aAAT,CAAuB,UAAvB,CAArC,GACR,KAAKrC,MAAL,CAAYoE,aAAZ,CAA0B,OAA1B,EAAmC;AAAEC,MAAAA,SAAS,EAAE,SAAb;AAAwBqB,MAAAA,KAAK,EAAE;AAC1DC,QAAAA,WAAW,EAAE,QAD6C;AACnCC,QAAAA,IAAI,EAAE,MAD6B;AAE1DL,QAAAA,EAAE,EAAE,KAAKvF,MAAL,CAAYgE,OAAZ,CAAoBuB,EAApB,GAAyBA;AAF6B;AAA/B,KAAnC,CADJ;AAMA,SAAKM,WAAL,CAAiB,KAAK7F,MAAL,CAAYgE,OAAZ,CAAoB3B,aAApB,CAAkC,eAAlC,EAAmDA,aAAnD,CAAiE,UAAjE,EAA6EyD,SAA7E,CAAuF,IAAvF,CAAjB;AACAL,IAAAA,KAAK,CAAClB,WAAN,CAAkB,KAAKwB,WAAL,EAAlB;AACAN,IAAAA,KAAK,CAAClB,WAAN,CAAkB,KAAKvE,MAAL,CAAYoE,aAAZ,CAA0B,OAA1B,CAAlB;AACAE,IAAAA,QAAQ,CAACC,WAAT,CAAqBkB,KAArB;AACA,WAAOnB,QAAP;AACH,GAlBD;;AAmBAvE,EAAAA,aAAa,CAAC6D,SAAd,CAAwBoC,SAAxB,GAAoC,UAAUC,GAAV,EAAe;AAC/C,QAAI,KAAKjG,MAAL,CAAYkB,gBAAZ,EAAJ,EAAoC;AAChC,UAAI+E,GAAG,KAAK,CAAZ,EAAe;AACX,aAAK7F,UAAL,GAAkB,KAAKD,IAAvB;AACA,aAAKG,iBAAL,GAAyB,KAAK4F,WAA9B;AACH,OAHD,MAIK;AACD,aAAK7F,WAAL,GAAmB,KAAKF,IAAxB;AACH;AACJ;AACJ,GAVD;AAWA;;;;AAIA;;;AACAJ,EAAAA,aAAa,CAAC6D,SAAd,CAAwBuC,kBAAxB,GAA6C,UAAUnF,IAAV,EAAgB;AACzD,QAAId,KAAK,GAAG,IAAZ;;AACA,QAAIc,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAEA,MAAAA,IAAI,GAAG,EAAP;AAAY;;AACnC,QAAI8C,IAAI,GAAG,KAAK9D,MAAhB;;AACA,QAAI8D,IAAI,CAACsC,eAAL,CAAqBzE,MAArB,KAAgC,CAApC,EAAuC;AACnC;AACH;;AACD,QAAI0E,UAAU,GAAGvC,IAAI,CAACsC,eAAtB;AACA,QAAIE,IAAI,GAAGC,QAAQ,CAACC,sBAAT,EAAX;AACA,QAAIC,OAAO,GAAGF,QAAQ,CAACC,sBAAT,EAAd;AACA,QAAIE,OAAO,GAAG5C,IAAI,CAAC6C,UAAL,EAAd;AACA,QAAIC,EAAJ;AACA,QAAIC,QAAJ;AACA,QAAIC,OAAO,GAAGhD,IAAI,CAAC5C,gBAAL,EAAd;AACA,QAAI6F,SAAJ;AACA,QAAIC,GAAG,GAAG,IAAIvH,WAAJ,CAAgB,KAAKQ,cAArB,EAAqC,IAArC,EAA2C,KAAKD,MAAhD,CAAV;AACA,SAAKkG,WAAL,GAAmB,EAAnB;AACA,SAAK/F,IAAL,GAAY,EAAZ;AACA,QAAI8G,KAAK,GAAG,KAAK7E,QAAL,GAAgBC,aAAhB,CAA8B,kBAA9B,CAAZ;AACA,QAAI6E,KAAK,GAAG,KAAK9E,QAAL,GAAgBC,aAAhB,CAA8B,mBAA9B,CAAZ;AACA,QAAI8E,IAAI,GAAG,KAAK/E,QAAL,GAAgBC,aAAhB,CAA8B,YAA9B,CAAX;;AACA,QAAIvC,eAAe,CAACgE,IAAD,CAAnB,EAA2B;AACvB,UAAI,CAAC,SAAD,EAAY,WAAZ,EAAyB,WAAzB,EAAsC,UAAtC,EAAkD,YAAlD,EAAgE,SAAhE,EACCsD,IADD,CACM,UAAUC,KAAV,EAAiB;AAAE,eAAOrG,IAAI,CAACa,WAAL,KAAqBwF,KAA5B;AAAoC,OAD7D,CAAJ,EACoE;AAChEvD,QAAAA,IAAI,CAACwD,MAAL,GAAc,EAAd;AACAxD,QAAAA,IAAI,CAACyD,KAAL,GAAa,EAAb;AACH;AACJ;;AACD,QAAIC,SAAJ;AACA,QAAIC,gBAAgB,GAAG,kBAAvB;;AACA,QAAI3I,QAAQ,MAAM,KAAKkB,MAAL,CAAYyH,gBAAZ,CAAlB,EAAiD;AAC7CD,MAAAA,SAAS,GAAG,KAAKpE,SAAL,CAAesE,YAAf,CAA4BrB,UAA5B,EAAwCrF,IAAxC,CAAZ;AACA,WAAKb,IAAL,GAAYqH,SAAZ;AACA,WAAKpH,UAAL,GAAkBoH,SAAlB;AACA,WAAKtB,WAAL,GAAmB,GAAG7E,KAAH,CAASC,IAAT,CAAc,KAAKwD,QAAL,GAAgBtD,gBAAhB,CAAiC,oBAAjC,CAAd,CAAnB;;AACA,UAAIsF,OAAJ,EAAa;AACT,aAAKzG,WAAL,GAAmBmH,SAAS,CAACG,GAAV,CAAc,UAAUC,IAAV,EAAgB;AAC7C,cAAIC,IAAI,GAAG,IAAIrI,GAAJ,CAAQoI,IAAR,CAAX;AACAC,UAAAA,IAAI,CAACC,KAAL,GAAaF,IAAI,CAACE,KAAL,CAAWzG,KAAX,CAAiByF,OAAjB,EAA0Bc,IAAI,CAACE,KAAL,CAAWnG,MAArC,CAAb;AACAiG,UAAAA,IAAI,CAACE,KAAL,GAAaF,IAAI,CAACE,KAAL,CAAWzG,KAAX,CAAiB,CAAjB,EAAoByF,OAApB,CAAb;AACA,iBAAOe,IAAP;AACH,SALkB,CAAnB;AAMA,aAAKvH,iBAAL,GAAyB,KAAK4F,WAA9B;AACH;;AACD,WAAK3F,QAAL,GAAgB,IAAhB;AACA,WAAKP,MAAL,CAAYkD,WAAZ;AACAlC,MAAAA,IAAI,CAACuB,QAAL,GAAgB,KAAKvC,MAAL,CAAYkB,gBAAZ,OAAmC,CAAnC,IAAwC,CAACF,IAAI,CAACuB,QAA9D;AACA,UAAItB,GAAG,GAAGjC,MAAM,CAAC;AAAEmB,QAAAA,IAAI,EAAE,KAAKA;AAAb,OAAD,EAAsBa,IAAtB,CAAhB;;AACA,UAAI,KAAK8D,QAAL,GAAgBzC,aAAhB,CAA8B,aAA9B,CAAJ,EAAkD;AAC9CnD,QAAAA,MAAM,CAAC,KAAK4F,QAAL,GAAgBzC,aAAhB,CAA8B,aAA9B,CAAD,CAAN;AACH;;AACD,UAAIyE,OAAJ,EAAa;AACTK,QAAAA,IAAI,CAACY,KAAL,CAAWC,SAAX,GAAuB,QAAvB;AACAf,QAAAA,KAAK,CAACc,KAAN,CAAYE,MAAZ,GAAuBf,KAAK,CAACgB,YAAP,GAAuBrI,iBAAiB,EAAzC,GAA+C,IAApE;AACAqH,QAAAA,KAAK,CAACa,KAAN,CAAYC,SAAZ,GAAwB,KAAKhI,MAAL,CAAYiI,MAAZ,KAAuB,MAAvB,GAAgC,QAAhC,GAA2C,MAAnE;AACAhB,QAAAA,KAAK,CAACc,KAAN,CAAYI,gBAAZ,GAA+B,KAA/B;AACA,aAAKnI,MAAL,CAAYW,MAAZ,CAAmBpB,MAAM,CAACiD,YAA1B,EAAwC;AAAErC,UAAAA,IAAI,EAAE,KAAKE,WAAb;AAA0BW,UAAAA,IAAI,EAAEhC,MAAM,CAAC,EAAD,EAAKiC,GAAL,EAAU;AAAEsB,YAAAA,QAAQ,EAAE;AAAZ,WAAV;AAAtC,SAAxC;AACH;;AACD,UAAI,EAAE,KAAKvC,MAAL,CAAYoI,mBAAZ,IAAmC,KAAKpI,MAAL,CAAYgF,iBAAZ,CAA8BC,IAA9B,KAAuC,UAA5E,KACI,CAAC,KAAKjF,MAAL,CAAYqI,kBADrB,EAC0C;AACtC,YAAI,KAAKrI,MAAL,CAAYsI,YAAZ,CAAyBC,IAAzB,KAAkC,QAAtC,EAAgD;AAC5C,cAAIC,QAAQ,GAAG,cAAf;AACA,eAAKxI,MAAL,CAAYyI,SAAZ,CAAsBzH,IAAI,CAACwH,QAAD,CAA1B;AACH;AACJ;;AACD,WAAKzH,WAAL,CAAiBE,GAAjB;AACA;AACH;;AACD,QAAI,KAAKjB,MAAL,CAAYmB,oBAAZ,IAAoC,KAAKnB,MAAL,CAAYkB,gBAAZ,EAAxC,EAAwE;AACpE,UAAI,KAAKlB,MAAL,CAAY4B,0BAAhB,EAA4C;AACxC,YAAIZ,IAAI,CAACa,WAAL,KAAqB,eAArB,IAAwCb,IAAI,CAAC0H,WAAL,CAAiBC,YAAjB,CAA8BC,IAA9B,KAAuC,GAAnF,EAAwF;AACpFpB,UAAAA,SAAS,GAAG,KAAKxH,MAAL,CAAY6I,aAAZ,CAA0BnB,YAA1B,CAAuCrB,UAAvC,EAAmDrF,IAAnD,CAAZ;AACAA,UAAAA,IAAI,CAAC8H,oBAAL,GAA4B,IAA5B;AACH,SAHD,MAIK,IAAI5B,KAAK,CAAC6B,UAAN,GAAmB,CAAnB,IAAwB,CAAC/H,IAAI,CAAC8H,oBAAlC,EAAwD;AACzD,eAAKtI,cAAL,GAAsBQ,IAAI,CAAC0H,WAAL,CAAiBM,aAAvC;AACA,cAAIC,OAAO,GAAG,EAAd;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKlJ,MAAL,CAAYkB,gBAAZ,EAApB,EAAoDgI,CAAC,EAArD,EAAyD;AACrDD,YAAAA,OAAO,CAACE,IAAR,CAAaD,CAAb;AACH;;AACD,eAAKlJ,MAAL,CAAYoJ,sBAAZ,CAAmCH,OAAnC;AACAjI,UAAAA,IAAI,CAAC0H,WAAL,CAAiBM,aAAjB,GAAiCC,OAAjC;AACH;AACJ;;AACDzB,MAAAA,SAAS,GAAG,KAAKxH,MAAL,CAAY6I,aAAZ,CAA0BnB,YAA1B,CAAuCrB,UAAvC,EAAmDrF,IAAnD,CAAZ;AACH,KAjBD,MAkBK;AACDwG,MAAAA,SAAS,GAAG,KAAKpE,SAAL,CAAesE,YAAf,CAA4BrB,UAA5B,EAAwCrF,IAAxC,CAAZ;AACH;;AACD,QAAIjC,iBAAiB,CAACyI,SAAS,CAAC,CAAD,CAAT,CAAaM,KAAb,CAAmB,CAAnB,CAAD,CAArB,EAA8C;AAC1CZ,MAAAA,KAAK,CAAC7E,aAAN,CAAoB,OAApB,EAA6BgH,SAA7B,GAAyC,EAAzC;AACH;;AACD,QAAIpD,GAAG,GAAGuB,SAAS,CAAC,CAAD,CAAT,CAAaM,KAAb,CAAmB,CAAnB,EAAsBwB,KAAhC;;AACA,QAAI,KAAKtJ,MAAL,CAAY4B,0BAAZ,IAA0C,KAAK5B,MAAL,CAAYkB,gBAAZ,EAA1C,IAA4EF,IAAI,CAAC8H,oBAAjF,IACG9H,IAAI,CAACa,WAAL,KAAqB,eADxB,IAC2CqF,KAAK,CAAC6B,UAAN,GAAmB,CAD9D,IACmE/H,IAAI,CAAC0H,WAAL,CAAiBM,aAAjB,CAA+B,CAA/B,MAAsC,CAD7G,EACgH;AAC5G/C,MAAAA,GAAG,GAAG,KAAKjG,MAAL,CAAYkB,gBAAZ,EAAN;AACH;AACD;;;AACA,QAAI,KAAKlB,MAAL,CAAYuJ,kBAAZ,IAAkC,KAAKvJ,MAAL,CAAYuJ,kBAAZ,CAA+BC,QAAjE,IAA6E,CAACxI,IAAI,CAACuB,QAAvF,EAAiG;AAC7F,UAAIkH,eAAe,GAAG,EAAtB;;AACA,WAAK,IAAIP,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKlJ,MAAL,CAAYuJ,kBAAZ,CAA+BC,QAA/B,CAAwC7H,MAA5D,EAAoEuH,CAAC,EAArE,EAAyE;AACrE,aAAK,IAAIQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK1J,MAAL,CAAYuJ,kBAAZ,CAA+BC,QAA/B,CAAwCN,CAAxC,EAA2CS,SAA3C,CAAqDhI,MAAzE,EAAiF+H,CAAC,EAAlF,EAAsF;AAClF,cAAI3K,iBAAiB,CAAC,KAAKiB,MAAL,CAAYuJ,kBAAZ,CAA+BC,QAA/B,CAAwCN,CAAxC,EAA2CS,SAA3C,CAAqDD,CAArD,EAAwDE,UAAzD,CAArB,EAA2F;AACvFH,YAAAA,eAAe,CAACN,IAAhB,CAAqB,KAAKnJ,MAAL,CAAYuJ,kBAAZ,CAA+BC,QAA/B,CAAwCN,CAAxC,CAArB;AACA;AACH;AACJ;AACJ;;AACD,WAAKlJ,MAAL,CAAY6J,eAAZ,CAA4B,CAAC,UAAD,CAA5B,EAA0CJ,eAA1C;AACH;;AACD,QAAI,KAAKzJ,MAAL,CAAY4B,0BAAhB,EAA4C;AACxC,UAAIkI,SAAS,GAAG,IAAIpK,eAAJ,CAAoB,KAAKO,cAAzB,EAAyC,KAAKD,MAA9C,CAAhB;AACA8J,MAAAA,SAAS,CAACC,kBAAV,CAA6BvC,SAA7B;AACH;;AACD,QAAIV,OAAO,IAAIb,GAAG,IAAIa,OAAtB,EAA+B;AAC3B,WAAKkD,KAAL,GAAa9C,KAAK,CAAC7E,aAAN,CAAoB,OAApB,CAAb;AACH,KAFD,MAGK;AACD,WAAK2H,KAAL,GAAa,KAAKlF,QAAL,GAAgBzC,aAAhB,CAA8B,OAA9B,CAAb;AACH;;AACD,QAAI4H,UAAU,GAAG,CAAjB;AACA,QAAIC,SAAS,GAAG,IAAhB;;AACA,QAAIpK,eAAe,CAACgE,IAAD,CAAf,IAAyBA,IAAI,CAACwD,MAAL,CAAY3F,MAAzC,EAAiD;AAC7C,UAAIwI,KAAK,GAAG,KAAZ;AACA,UAAIC,SAAS,GAAG,CAACrL,iBAAiB,CAACiC,IAAI,CAAC0H,WAAL,CAAiB2B,OAAlB,CAAlB,GAA+CrJ,IAAI,CAAC0H,WAAL,CAAiB2B,OAAjB,CAAyBC,GAAxE,GACX,CAACvL,iBAAiB,CAACiC,IAAI,CAACoJ,SAAN,CAAlB,GAAqCpJ,IAAI,CAACoJ,SAAL,CAAeD,KAAf,CAArC,GAA6D,CADlE;;AAEA,UAAIC,SAAS,KAAK,CAAlB,EAAqB;AACjB,YAAIG,SAAS,GAAGzG,IAAI,CAAC0G,aAArB;AACA,YAAIC,KAAK,GAAG3G,IAAI,CAAC4G,YAAL,CAAkBC,QAAlB,GAA6B,CAAzC;AACA,YAAIC,MAAM,GAAGC,MAAM,CAACC,IAAP,CAAYP,SAAZ,EAAuB5C,GAAvB,CAA2B,UAAUoD,GAAV,EAAe;AAAE,iBAAOR,SAAS,CAACQ,GAAD,CAAhB;AAAwB,SAApE,CAAb;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,MAAM,CAACjJ,MAA3B,EAAmCqJ,CAAC,EAApC,EAAwC;AACpC,cAAIZ,SAAS,GAAGQ,MAAM,CAACI,CAAD,CAAtB,EAA2B;AACvB,gBAAI,CAACjM,iBAAiB,CAACiC,IAAI,CAAC0H,WAAN,CAAlB,IAAwC1H,IAAI,CAAC0H,WAAL,CAAiBuC,SAAjB,KAA+B,IAA3E,EAAiF;AAC7EjK,cAAAA,IAAI,CAAC0H,WAAL,CAAiBwC,YAAjB,GAAgCF,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAAjB,GAAqB,CAAC,CAAD,EAAI,CAAJ,CAArB,GAA8B,CAACA,CAAD,EAAIA,CAAC,GAAG,CAAR,CAA9D;AACAf,cAAAA,UAAU,GAAGe,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAAjB,GAAqB,CAArB,GAA0BA,CAAC,GAAGP,KAA3C;AACA;AACH,aAJD,MAKK;AACDzJ,cAAAA,IAAI,CAAC0H,WAAL,CAAiBwC,YAAjB,GAAgCF,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAAjB,GAAqB,CAAC,CAAD,EAAI,CAAJ,CAArB,GAA8B,CAACA,CAAD,EAAIA,CAAC,GAAG,CAAR,CAA9D;AACAf,cAAAA,UAAU,GAAGe,CAAC,KAAK,CAAN,IAAWA,CAAC,KAAK,CAAjB,GAAqB,CAArB,GAA0BA,CAAD,GAAMP,KAA5C;AACA;AACH;AACJ;AACJ;;AACD,YAAIL,SAAS,GAAG,KAAKe,YAAL,CAAkB3F,iBAAlB,CAAoC0C,YAAhD,KACA,KAAKiD,YAAL,CAAkB3F,iBAAlB,CAAoC4F,YADpC,IACoD,CAACpK,IAAI,CAACqK,SAD9D,EACyE;AACrEnB,UAAAA,SAAS,GAAG,KAAZ;AACH;AACJ;AACJ;;AACD,QAAIpG,IAAI,CAACqB,UAAL,IAAmBnE,IAAI,CAACa,WAAL,KAAqB,eAAxC,IAA2Db,IAAI,CAAC0H,WAAL,CAAiBC,YAAjB,CAA8BC,IAA9B,KAAuC,GAAtG,EAA2G;AACvG,UAAI0C,MAAM,GAAGtK,IAAI,CAAC0H,WAAL,CAAiBwC,YAA9B;AACAlK,MAAAA,IAAI,CAAC0H,WAAL,CAAiBwC,YAAjB,GAAgC,CAAC,CAAD,EAAI,CAAJ,CAAhC;AACA,UAAIK,QAAQ,GAAG,KAAKC,UAAL,CACV9D,YADU,CACGrB,UADH,EACerF,IADf,CAAf;AAEAuK,MAAAA,QAAQ,CAACE,MAAT,CAAgB,KAAKzL,MAAL,CAAYmF,UAA5B;;AACA,WAAK,IAAI+D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKlJ,MAAL,CAAYmF,UAAhC,EAA4C+D,CAAC,EAA7C,EAAiD;AAC7C,YAAIlI,IAAI,CAAC0H,WAAL,CAAiBM,aAAjB,CAA+B,CAA/B,MAAsC,CAA1C,EAA6C;AACzCuC,UAAAA,QAAQ,CAACrC,CAAD,CAAR,CAAYpB,KAAZ,CAAkB2D,MAAlB,CAAyB,CAAzB,EAA4B,KAAKzL,MAAL,CAAYkB,gBAAZ,EAA5B;AACH;;AACD0F,QAAAA,EAAE,GAAGI,GAAG,CAAC0E,MAAJ,CAAWH,QAAQ,CAACrC,CAAD,CAAnB,EAAwBxC,OAAxB,CAAL;AACAD,QAAAA,OAAO,CAAClC,WAAR,CAAoBqC,EAApB;AACH;;AACD5F,MAAAA,IAAI,CAAC0H,WAAL,CAAiBwC,YAAjB,GAAgCI,MAAhC;AACH;;AACD,SAAK,IAAIpC,CAAC,GAAGe,UAAR,EAAoB0B,GAAG,GAAGnE,SAAS,CAAC7F,MAAzC,EAAiDuH,CAAC,GAAGyC,GAArD,EAA0DzC,CAAC,EAA3D,EAA+D;AAC3D,WAAK/I,IAAL,CAAUgJ,IAAV,CAAe3B,SAAS,CAAC0B,CAAD,CAAxB;;AACA,UAAIpJ,eAAe,CAACgE,IAAD,CAAf,IAAyB,KAAK3D,IAAL,CAAUwB,MAAV,IAAqBmC,IAAI,CAAC4G,YAAL,CAAkBC,QAAhE,IAA6ET,SAAjF,EAA4F;AACxF;AACH;;AACD,UAAI,CAACpG,IAAI,CAAC8H,WAAV,EAAuB;AACnBhF,QAAAA,EAAE,GAAGI,GAAG,CAAC0E,MAAJ,CAAWlE,SAAS,CAAC0B,CAAD,CAApB,EAAyBxC,OAAzB,CAAL;;AACA,YAAI5C,IAAI,CAACqB,UAAL,IAAmB+D,CAAC,GAAGpF,IAAI,CAACqB,UAA5B,IAA0CnE,IAAI,CAACa,WAAL,KAAqB,eAAnE,EAAoF;AAChF4E,UAAAA,OAAO,CAAClC,WAAR,CAAoBqC,EAApB;AACH,SAFD,MAGK;AACDN,UAAAA,IAAI,CAAC/B,WAAL,CAAiBqC,EAAjB;AACH;;AACD,YAAIY,SAAS,CAAC0B,CAAD,CAAT,CAAa2C,QAAjB,EAA2B;AACvB/H,UAAAA,IAAI,CAACnD,MAAL,CAAYpB,MAAM,CAACuM,eAAnB,EAAoClF,EAAE,CAACkB,KAAH,CAAShE,IAAI,CAACiI,aAAL,CAAmBrF,OAAnB,CAA2B/E,MAApC,CAApC;AACH;AACJ,OAXD,MAYK;AACD,YAAIqK,aAAa,GAAGlI,IAAI,CAACE,OAAL,CAAauB,EAAb,GAAkB,aAAtC;AACA,YAAI0G,QAAQ,GAAGnI,IAAI,CAACoI,cAAL,GAAsBlN,MAAM,CAAC;AAAEsK,UAAAA,KAAK,EAAEJ;AAAT,SAAD,EAAe7C,UAAU,CAAC6C,CAAD,CAAzB,CAA5B,EAA2DpF,IAA3D,EAAiE,aAAjE,EAAgFkI,aAAhF,CAAf;;AACA,YAAIC,QAAQ,CAAC,CAAD,CAAR,CAAYE,OAAZ,KAAwB,OAA5B,EAAqC;AACjC,eAAK,IAAIzC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGuC,QAAQ,CAACtK,MAA7B,EAAqC+H,CAAC,EAAtC,EAA0C;AACtC,gBAAI0C,IAAI,GAAGH,QAAQ,CAACvC,CAAD,CAAR,CAAY2C,QAAZ,CAAqBtJ,WAArB,OAAuC,IAAlD;;AACA,gBAAIqJ,IAAI,IAAKH,QAAQ,CAACvC,CAAD,CAAR,CAAYlI,gBAAZ,IAAgCyK,QAAQ,CAACvC,CAAD,CAAR,CAAYlI,gBAAZ,CAA6B,IAA7B,EAAmCG,MAAhF,EAAyF;AACrFiF,cAAAA,EAAE,GAAGwF,IAAI,GAAGH,QAAQ,CAACvC,CAAD,CAAX,GAAiBuC,QAAQ,CAACvC,CAAD,CAAR,CAAYrH,aAAZ,CAA0B,IAA1B,CAA1B;AACH;AACJ;;AACD,cAAIyB,IAAI,CAACqB,UAAL,IAAmB+D,CAAC,GAAGpF,IAAI,CAACqB,UAAhC,EAA4C;AACxCsB,YAAAA,OAAO,CAAClC,WAAR,CAAoBqC,EAApB;AACH,WAFD,MAGK;AACDN,YAAAA,IAAI,CAAC/B,WAAL,CAAiBqC,EAAjB;AACH;AACJ,SAbD,MAcK;AACD,cAAI9C,IAAI,CAACqB,UAAL,IAAmB+D,CAAC,GAAGpF,IAAI,CAACqB,UAAhC,EAA4C;AACxCyB,YAAAA,EAAE,GAAGtH,cAAc,CAACmH,OAAD,EAAUwF,QAAV,CAAnB;AACH,WAFD,MAGK;AACD;AACArF,YAAAA,EAAE,GAAGtH,cAAc,CAACgH,IAAD,EAAO2F,QAAP,CAAnB;AACAlF,YAAAA,SAAS,GAAGH,EAAE,CAAC0F,gBAAf;AACH;AACJ;;AACD,YAAIrL,GAAG,GAAG;AAAEsL,UAAAA,IAAI,EAAE/E,SAAS,CAAC0B,CAAD,CAAT,CAAaqD,IAArB;AAA2BvF,UAAAA,GAAG,EAAED,SAAS,GAAGA,SAAH,GAAeH;AAAxD,SAAV;AACA,aAAK5G,MAAL,CAAYyC,OAAZ,CAAoBlD,MAAM,CAACiN,YAA3B,EAAyCvL,GAAzC;AACH;;AACD,UAAIuG,SAAS,CAAC0B,CAAD,CAAT,CAAauD,SAAjB,EAA4B;AACxB,aAAKvG,WAAL,CAAiBiD,IAAjB,CAAsBvC,EAAtB;AACH;;AACD,WAAK1E,WAAL,CAAiB+B,UAAjB,CAA4B,KAAKa,QAAL,EAA5B,EAA6C;AAAE4H,QAAAA,QAAQ,EAAE5I,IAAI,CAAC6C,UAAL,GAAkBhF,MAAlB,CAAyBgL,QAAzB;AAAZ,OAA7C;AACH;;AACD,SAAK3G,SAAL,CAAeC,GAAf;;AACA,QAAKnC,IAAI,CAACqB,UAAL,IAAmBnE,IAAI,CAACa,WAAL,KAAqB,eAAzC,IAA8Db,IAAI,CAACa,WAAL,KAAqB,eAArB,IAC3Db,IAAI,CAAC0H,WAAL,CAAiBC,YAD0C,IAC1B3H,IAAI,CAAC0H,WAAL,CAAiBC,YAAjB,CAA8BC,IAA9B,KAAuC,GAD/E,EACqF;AACjF/B,MAAAA,QAAQ,GAAGC,OAAO,GAAGhD,IAAI,CAACsB,gBAAL,GAAwB/C,aAAxB,CAAsC4D,GAAG,KAAK,CAAR,GAAY,iBAAZ,GACrD,kBADe,EACK5D,aADL,CACmB,OADnB,CAAH,GACiCyB,IAAI,CAAC8I,cAAL,GAAsBvK,aAAtB,CAAoC,OAApC,CADnD;AAEAwE,MAAAA,QAAQ,CAACwC,SAAT,GAAqB,EAArB;AACAxC,MAAAA,QAAQ,CAACtC,WAAT,CAAqBkC,OAArB;AACH;;AACD,QAAI3C,IAAI,CAACqB,UAAL,IAAmBc,GAAG,KAAK,CAA3B,IAAgCkB,IAAI,CAACe,YAAL,KAAsB2E,MAAM,CAAC/I,IAAI,CAACmE,MAAN,CAAhE,EAA+E;AAC3Ed,MAAAA,IAAI,CAACY,KAAL,CAAWE,MAAX,GAAqBd,IAAI,CAACe,YAAL,GAAoBrB,QAAQ,CAACqB,YAA9B,GAA8C,IAAlE;AACH;;AACD,QAAIpB,OAAO,IAAIb,GAAG,KAAK,CAAvB,EAA0B;AACtB,WAAK7D,QAAL,GAAgB0K,UAAhB,CAA2B/E,KAA3B,CAAiCC,SAAjC,GAA6C,QAA7C;AACH;;AACD,QAAI,CAAClJ,QAAQ,EAAT,IAAe,KAAKkB,MAAL,CAAY+M,aAA/B,EAA8C;AAC1C/L,MAAAA,IAAI,CAACb,IAAL,GAAY,KAAKA,IAAL,CAAUkB,KAAV,CAAgB,CAAhB,CAAZ;AACH;;AACDL,IAAAA,IAAI,CAACuB,QAAL,GAAgB,KAAKvC,MAAL,CAAYkB,gBAAZ,OAAmC,CAAnC,IAAwC,CAACF,IAAI,CAACuB,QAA9D;AACA,SAAK+G,KAAL,GAAarD,GAAb;AACA5G,IAAAA,iBAAiB,CAAC,YAAY;AAC1Ba,MAAAA,KAAK,CAACF,MAAN,CAAaW,MAAb,CAAoBpB,MAAM,CAACyN,gBAA3B,EAA6ChM,IAA7C;;AACA,UAAIiM,SAAS,GAAG/M,KAAK,CAACF,MAAN,CAAamB,oBAAb,IAAqCjB,KAAK,CAACF,MAAN,CAAakB,gBAAb,OAAoC,CAAzF;;AACA,UAAI,CAAChB,KAAK,CAACF,MAAN,CAAamB,oBAAlB,EAAwC;AACpCjC,QAAAA,MAAM,CAACgB,KAAK,CAAC8J,KAAP,CAAN;AACA9J,QAAAA,KAAK,CAAC8J,KAAN,GAAc9J,KAAK,CAACF,MAAN,CAAaoE,aAAb,CAA2B,OAA3B,CAAd;AACH;;AACD,UAAI0C,OAAO,IAAI,CAACmG,SAAhB,EAA2B;AACvB/M,QAAAA,KAAK,CAAC8J,KAAN,CAAYzF,WAAZ,CAAwB+B,IAAxB;;AACA,YAAIpG,KAAK,CAACoJ,KAAN,KAAgB,CAApB,EAAuB;AACnBpJ,UAAAA,KAAK,CAACK,QAAN,GAAiB,KAAjB;AACA0G,UAAAA,KAAK,CAAC5E,aAAN,CAAoB,OAApB,EAA6BkC,WAA7B,CAAyCrE,KAAK,CAAC8J,KAA/C;AACH,SAHD,MAIK;AACD,cAAI9J,KAAK,CAAC8J,KAAN,CAAYkD,iBAAZ,GAAgC,CAApC,EAAuC;AACnChN,YAAAA,KAAK,CAAC8J,KAAN,CAAYzF,WAAZ,CAAwBrE,KAAK,CAACF,MAAN,CAAaoE,aAAb,CAA2B,IAA3B,EAAiCG,WAAjC,CAA6CrE,KAAK,CAACF,MAAN,CAAaoE,aAAb,CAA2B,IAA3B,CAA7C,CAAxB;AACH;;AACDlE,UAAAA,KAAK,CAACK,QAAN,GAAiB,IAAjB;AACA2G,UAAAA,KAAK,CAAC7E,aAAN,CAAoB,OAApB,EAA6BkC,WAA7B,CAAyCrE,KAAK,CAAC8J,KAA/C;;AACA,cAAI9J,KAAK,CAACF,MAAN,CAAakB,gBAAb,OAAoC,CAApC,IAAyC,CAAChB,KAAK,CAACF,MAAN,CAAa2C,aAA3D,EAA0E;AACtEzC,YAAAA,KAAK,CAACF,MAAN,CAAaW,MAAb,CAAoBpB,MAAM,CAACqD,YAA3B,EAAyC;AAAEC,cAAAA,IAAI,EAAE;AAAR,aAAzC;AACH;;AACDoE,UAAAA,KAAK,CAACc,KAAN,CAAYE,MAAZ,GAAuBf,KAAK,CAACgB,YAAP,GAAuBrI,iBAAiB,EAAzC,GAA+C,IAApE;AACAqH,UAAAA,KAAK,CAACa,KAAN,CAAYC,SAAZ,GAAwB9H,KAAK,CAACF,MAAN,CAAaiI,MAAb,KAAwB,MAAxB,GAAiC,QAAjC,GAA4C,MAApE;AACAhB,UAAAA,KAAK,CAACc,KAAN,CAAYI,gBAAZ,GAA+B,KAA/B;AACH;AACJ,OAnBD,MAoBK;AACD,YAAIrE,IAAI,CAAC8H,WAAT,EAAsB;AAClBzM,UAAAA,oBAAoB,CAAC2E,IAAI,CAACE,OAAL,CAAauB,EAAb,GAAkB,aAAnB,EAAkC,aAAlC,EAAiDzB,IAAjD,CAApB;AACH;;AACD,YAAImJ,SAAJ,EAAe;AACX,cAAI,CAACjM,IAAI,CAAC8H,oBAAV,EAAgC;AAC5B5I,YAAAA,KAAK,CAACiN,aAAN,CAAoBlG,KAAK,CAAC5E,aAAN,CAAoB,OAApB,CAApB,EAAkDiE,IAAlD,EAAwDtF,IAAxD;;AACA,gBAAId,KAAK,CAACF,MAAN,CAAa4B,0BAAb,IAA2CsF,KAAK,CAAC6B,UAAN,GAAmB,CAAlE,EAAqE;AACjE7I,cAAAA,KAAK,CAACF,MAAN,CAAaoJ,sBAAb,CAAoClJ,KAAK,CAACM,cAA1C;;AACAQ,cAAAA,IAAI,CAAC0H,WAAL,CAAiBM,aAAjB,GAAiC9I,KAAK,CAACM,cAAvC;AACH;AACJ,WAND,MAOK;AACDN,YAAAA,KAAK,CAACiN,aAAN,CAAoBjG,KAAK,CAAC7E,aAAN,CAAoB,OAApB,CAApB,EAAkDiE,IAAlD,EAAwDtF,IAAxD;;AACA,gBAAIA,IAAI,CAAC0H,WAAL,IAAoB1H,IAAI,CAAC0H,WAAL,CAAiBuC,SAAjB,KAA+B,OAAnD,IAA8DjK,IAAI,CAAC0H,WAAL,CAAiBuC,SAAjB,KAA+B,MAAjG,EAAyG;AACrGhE,cAAAA,KAAK,CAACc,KAAN,CAAYE,MAAZ,GAAuBf,KAAK,CAACgB,YAAP,GAAuBrI,iBAAiB,EAAzC,GAA+C,IAApE;AACH;;AACDmB,YAAAA,IAAI,CAAC8H,oBAAL,GAA4B,KAA5B;AACH;AACJ,SAfD,MAgBK;AACD5I,UAAAA,KAAK,CAACiN,aAAN,CAAoBjN,KAAK,CAAC8J,KAA1B,EAAiC1D,IAAjC,EAAuCtF,IAAvC;AACH;AACJ;;AACD,UAAI8F,OAAO,IAAIb,GAAG,KAAK,CAAvB,EAA0B;AACtB,YAAIgH,SAAJ,EAAe;AACXjM,UAAAA,IAAI,CAAC8H,oBAAL,GAA4B,IAA5B;AACH;;AACD5I,QAAAA,KAAK,CAACiG,kBAAN,CAAyBnH,MAAM,CAAC,EAAD,EAAKgC,IAAL,CAA/B;AACH;;AACDsF,MAAAA,IAAI,GAAG,IAAP;AACH,KA1DgB,EA0Dd,KAAKvF,WAAL,CAAiB/B,MAAM,CAAC,EAAD,EAAKgC,IAAL,CAAvB,CA1Dc,CAAjB;AA2DH,GAvSD;;AAwSAjB,EAAAA,aAAa,CAAC6D,SAAd,CAAwBuJ,aAAxB,GAAwC,UAAUnD,KAAV,EAAiB1D,IAAjB,EAAuBtF,IAAvB,EAA6B;AACjEgJ,IAAAA,KAAK,CAACzF,WAAN,CAAkB+B,IAAlB;AACA,SAAKxB,QAAL,GAAgBP,WAAhB,CAA4ByF,KAA5B;AACH,GAHD;AAIA;;;;;;AAIAjK,EAAAA,aAAa,CAAC6D,SAAd,CAAwBxB,QAAxB,GAAmC,YAAY;AAC3C,WAAO,KAAK+I,YAAZ;AACH,GAFD;AAGA;;;;;;AAIApL,EAAAA,aAAa,CAAC6D,SAAd,CAAwBO,QAAxB,GAAmC,UAAUiJ,KAAV,EAAiB;AAChD,SAAKjC,YAAL,GAAoBiC,KAApB;AACH,GAFD;AAGA;;;;;;AAIArN,EAAAA,aAAa,CAAC6D,SAAd,CAAwBkB,QAAxB,GAAmC,YAAY;AAC3C,WAAO,KAAKuI,YAAZ;AACH,GAFD;AAGA;;;;;;AAIAtN,EAAAA,aAAa,CAAC6D,SAAd,CAAwBiB,QAAxB,GAAmC,UAAUY,KAAV,EAAiB;AAChD,SAAK4H,YAAL,GAAoB5H,KAApB;AACH,GAFD;AAGA;;;;;;AAIA1F,EAAAA,aAAa,CAAC6D,SAAd,CAAwB0J,OAAxB,GAAkC,YAAY;AAC1C,WAAO,KAAKtN,MAAL,CAAYkB,gBAAZ,KAAiC,KAAKd,UAAtC,GAAmD,KAAKD,IAA/D;AACH,GAFD;AAGA;;;;;;AAIAJ,EAAAA,aAAa,CAAC6D,SAAd,CAAwB2J,cAAxB,GAAyC,YAAY;AACjD,WAAO,KAAKlN,WAAZ;AACH,GAFD;AAGA;;;;;;AAIAN,EAAAA,aAAa,CAAC6D,SAAd,CAAwB4J,cAAxB,GAAyC,YAAY;AACjD,WAAO,KAAKxN,MAAL,CAAYkB,gBAAZ,KAAiC,KAAKZ,iBAAtC,GAA0D,KAAK4F,WAAtE;AACH,GAFD;AAGA;;;;;;AAIAnG,EAAAA,aAAa,CAAC6D,SAAd,CAAwB6J,qBAAxB,GAAgD,YAAY;AACxD,WAAO,KAAKvH,WAAZ;AACH,GAFD;AAGA;;;;;;AAIAnG,EAAAA,aAAa,CAAC6D,SAAd,CAAwB8J,cAAxB,GAAyC,UAAUzB,QAAV,EAAoB;AACzD,SAAK/F,WAAL,GAAmB+F,QAAnB;AACH,GAFD;AAGA;;;;;;AAIAlM,EAAAA,aAAa,CAAC6D,SAAd,CAAwBmC,WAAxB,GAAsC,YAAY;AAC9C,WAAO,KAAK4H,QAAZ;AACH,GAFD;AAGA;;;;;;;AAKA5N,EAAAA,aAAa,CAAC6D,SAAd,CAAwBiC,WAAxB,GAAsC,UAAU+H,QAAV,EAAoB;AACtD,QAAI,CAAC7O,iBAAiB,CAAC6O,QAAD,CAAtB,EAAkC;AAC9BA,MAAAA,QAAQ,CAACrI,EAAT,GAAc,aAAaqI,QAAQ,CAACrI,EAApC;AACH;;AACD,WAAO,KAAKoI,QAAL,GAAgBC,QAAvB;AACH,GALD;AAMA;;;;;;AAIA7N,EAAAA,aAAa,CAAC6D,SAAd,CAAwBJ,UAAxB,GAAqC,UAAUkD,OAAV,EAAmB;AACpD,QAAI5C,IAAI,GAAG,KAAK9D,MAAhB;;AACA,QAAIlB,QAAQ,MAAMgF,IAAI,CAAC2D,gBAAvB,EAAyC;AACrC,WAAKzH,MAAL,CAAYW,MAAZ,CAAmB,eAAnB,EAAoC+F,OAApC;AACH;;AACD,QAAII,OAAO,GAAGhD,IAAI,CAAC5C,gBAAL,EAAd;AACA,QAAIf,IAAI,GAAG,EAAX;;AACA,QAAI2G,OAAJ,EAAa;AACT,UAAI+G,KAAK,GAAG,KAAKzN,UAAjB;AACA,UAAI0N,KAAK,GAAG,KAAKzN,WAAjB;AACA,UAAI0N,MAAM,GAAGF,KAAK,CAAClM,MAAnB;AACA,UAAIqM,OAAO,GAAG,KAAK,CAAnB;;AACA,WAAK,IAAI9E,CAAC,GAAG,CAAR,EAAWlC,GAAG,GAAG,KAAK,CAA3B,EAA8BkC,CAAC,GAAG6E,MAAlC,EAA0C7E,CAAC,EAA3C,EAA+C;AAC3C8E,QAAAA,OAAO,GAAGF,KAAK,CAAC5E,CAAD,CAAL,CAASpB,KAAT,CAAenG,MAAzB;AACAqF,QAAAA,GAAG,GAAG6G,KAAK,CAAC3E,CAAD,CAAL,CAAS+E,KAAT,EAAN;;AACA,aAAK,IAAIvE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsE,OAApB,EAA6BtE,CAAC,EAA9B,EAAkC;AAC9B1C,UAAAA,GAAG,CAACc,KAAJ,CAAUqB,IAAV,CAAe2E,KAAK,CAAC5E,CAAD,CAAL,CAASpB,KAAT,CAAe4B,CAAf,CAAf;AACH;;AACDvJ,QAAAA,IAAI,CAACgJ,IAAL,CAAUnC,GAAV;AACH;AACJ,KAbD,MAcK;AACD7G,MAAAA,IAAI,GAAG,KAAKmN,OAAL,EAAP;AACH;;AACD,QAAItJ,OAAJ;AACA,QAAIkK,OAAJ;AACA/N,IAAAA,IAAI,CAACiH,IAAL,CAAU,UAAU+G,CAAV,EAAa;AAAE,UAAIA,CAAC,CAAC1B,SAAN,EAAiB;AACtCyB,QAAAA,OAAO,GAAGC,CAAV;AACH;;AAAC,aAAOA,CAAC,CAAC1B,SAAT;AAAqB,KAFvB;AAGA,QAAI2B,KAAK,GAAG,EAAZ;AACA,QAAIC,eAAe,GAAG,IAAtB;;AACA,QAAI,CAACvK,IAAI,CAACiI,aAAL,CAAmBrF,OAAnB,CAA2B/E,MAA5B,IAAsCuM,OAA1C,EAAmD;AAC/CG,MAAAA,eAAe,GAAG,KAAlB;AACH;;AACD,QAAIzH,EAAE,GAAG9C,IAAI,CAACwK,WAAL,EAAT;AACA,QAAItN,IAAI,GAAG,EAAX;AACA,QAAIuN,WAAW,GAAG,KAAKpO,IAAL,CAAUqO,MAAV,CAAiB,UAAUxH,GAAV,EAAe;AAAE,aAAO,CAACA,GAAG,CAACyH,WAAZ;AAA0B,KAA5D,CAAlB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,IAAI,GAAGjI,OAAO,CAAC/E,MAA/B,EAAuC+M,CAAC,GAAGC,IAA3C,EAAiDD,CAAC,EAAlD,EAAsD;AAClD,UAAIE,MAAM,GAAGlI,OAAO,CAACgI,CAAD,CAApB;AACA,UAAIzI,GAAG,GAAG,KAAKjG,MAAL,CAAY6O,wBAAZ,CAAqCD,MAAM,CAACE,GAA5C,CAAV;AACA,UAAIC,UAAU,GAAGH,MAAM,CAACI,OAAP,KAAmB,IAAnB,GAA0B,EAA1B,GAA+B,MAAhD;;AACA,UAAI/I,GAAG,KAAK,CAAC,CAAT,IAAciI,OAAd,IAAyBjI,GAAG,GAAGiI,OAAO,CAACpG,KAAR,CAAcnG,MAAjD,EAAyD;AACrD,YAAImF,OAAJ,EAAa;AACT,cAAIb,GAAG,GAAGa,OAAV,EAAmB;AACf7H,YAAAA,iBAAiB,CAAC,KAAK8G,WAAL,GAAmBkJ,UAAnB,CAA8BhJ,GAA9B,CAAD,EAAqC;AAAE,yBAAW8I;AAAb,aAArC,CAAjB;AACAR,YAAAA,WAAW,GAAG,KAAKnO,UAAnB;AACH,WAHD,MAIK;AACD,gBAAI8O,MAAM,GAAGpL,IAAI,CAACqL,UAAL,GAAkB9M,aAAlB,CAAgC,mBAAhC,EAAqDA,aAArD,CAAmE,UAAnE,CAAb;AACA4D,YAAAA,GAAG,GAAGA,GAAG,GAAGa,OAAZ;AACA7H,YAAAA,iBAAiB,CAACiQ,MAAM,CAACD,UAAP,CAAkBhJ,GAAlB,CAAD,EAAyB;AAAE,yBAAW8I;AAAb,aAAzB,CAAjB;AACAnI,YAAAA,EAAE,GAAG9C,IAAI,CAACsL,kBAAL,EAAL;AACAb,YAAAA,WAAW,GAAG,KAAKlO,WAAnB;AACH;AACJ,SAZD,MAaK;AACD,cAAIyD,IAAI,CAACuL,aAAL,EAAJ,EAA0B;AACtBpJ,YAAAA,GAAG;AACN;;AACDhH,UAAAA,iBAAiB,CAAC,KAAK8G,WAAL,GAAmBkJ,UAAnB,CAA8BhJ,GAA9B,CAAD,EAAqC;AAAE,uBAAW8I;AAAb,WAArC,CAAjB;;AACA,cAAIjL,IAAI,CAACuL,aAAL,EAAJ,EAA0B;AACtBpJ,YAAAA,GAAG;AACN;AACJ;AACJ;;AACDA,MAAAA,GAAG,GAAGnC,IAAI,CAACwL,QAAL,KAAkBrJ,GAAG,GAAG,CAAxB,GAA4BA,GAAlC;;AACA,UAAI,CAACoI,eAAL,EAAsB;AAClB,aAAKkB,cAAL,CAAoB3I,EAApB,EAAwBX,GAAxB,EAA6B8I,UAA7B,EAAyCR,WAAzC;AACH;;AACD,UAAI,CAAC,KAAKvO,MAAL,CAAYwP,gBAAb,IAAiCZ,MAAM,CAACa,WAA5C,EAAyD;AACrD,aAAKzP,MAAL,CAAY0P,kBAAZ,CAA+Bd,MAA/B;AACH;;AACD,WAAK5O,MAAL,CAAYwP,gBAAZ,GAA+B,KAA/B;AACH;;AACD,QAAInB,eAAJ,EAAqB;AACjB,WAAKlI,kBAAL,CAAwB;AAAEtE,QAAAA,WAAW,EAAE;AAAf,OAAxB;AACH,KAFD,MAGK;AACD,UAAI,CAAC,KAAK7B,MAAL,CAAYkB,gBAAZ,EAAL,EAAqC;AACjC,aAAKlB,MAAL,CAAYW,MAAZ,CAAmBpB,MAAM,CAACoQ,cAA1B,EAA0C;AAAExP,UAAAA,IAAI,EAAEoO,WAAR;AAAqBvN,UAAAA,IAAI,EAAEA;AAA3B,SAA1C;AACH,OAFD,MAGK;AACD,aAAKhB,MAAL,CAAYW,MAAZ,CAAmBpB,MAAM,CAACoQ,cAA1B,EAA0C;AAAExP,UAAAA,IAAI,EAAE,KAAKC,UAAb;AAAyBY,UAAAA,IAAI,EAAE;AAAEuB,YAAAA,QAAQ,EAAE,IAAZ;AAAkBpC,YAAAA,IAAI,EAAE,KAAKC;AAA7B;AAA/B,SAA1C;AACA,aAAKJ,MAAL,CAAYW,MAAZ,CAAmBpB,MAAM,CAACoQ,cAA1B,EAA0C;AAAExP,UAAAA,IAAI,EAAE,KAAKE,WAAb;AAA0BW,UAAAA,IAAI,EAAE;AAAEuB,YAAAA,QAAQ,EAAE,KAAZ;AAAmBpC,YAAAA,IAAI,EAAE,KAAKE;AAA9B;AAAhC,SAA1C;AACH;AACJ;AACJ,GAtFD;AAuFA;;;;;AAGAN,EAAAA,aAAa,CAAC6D,SAAd,CAAwB2L,cAAxB,GAAyC,UAAU3I,EAAV,EAAcX,GAAd,EAAmB8I,UAAnB,EAA+B5O,IAA/B,EAAqC;AAC1E0K,IAAAA,MAAM,CAACC,IAAP,CAAYlE,EAAZ,EAAgBgJ,OAAhB,CAAwB,UAAU1G,CAAV,EAAa;AACjC,UAAItC,EAAE,CAACsC,CAAD,CAAF,CAAM1H,gBAAN,CAAuB,cAAvB,EAAuCG,MAA3C,EAAmD;AAC/C1C,QAAAA,iBAAiB,CAAC2H,EAAE,CAACsC,CAAD,CAAF,CAAM1H,gBAAN,CAAuB,cAAvB,EAAuCyE,GAAvC,CAAD,EAA8C;AAAE,qBAAW8I;AAAb,SAA9C,CAAjB;;AACA,YAAInI,EAAE,CAACsC,CAAD,CAAF,CAAM1H,gBAAN,CAAuB,cAAvB,EAAuCyE,GAAvC,EAA4CZ,SAA5C,CAAsDwK,QAAtD,CAA+D,QAA/D,CAAJ,EAA8E;AAC1EzQ,UAAAA,WAAW,CAAC,CAACwH,EAAE,CAACsC,CAAD,CAAF,CAAM1H,gBAAN,CAAuB,cAAvB,EAAuCyE,GAAvC,CAAD,CAAD,EAAgD,CAAC,QAAD,CAAhD,CAAX;AACH;;AACD9F,QAAAA,IAAI,CAAC+I,CAAD,CAAJ,CAAQpB,KAAR,CAAc7B,GAAd,EAAmB+I,OAAnB,GAA6BD,UAAU,KAAK,EAAf,GAAoB,IAApB,GAA2B,KAAxD;AACH;AACJ,KARD;AASH,GAVD;;AAWAhP,EAAAA,aAAa,CAAC6D,SAAd,CAAwBH,eAAxB,GAA0C,YAAY;AAClD,QAAI,KAAKsC,WAAL,EAAJ,EAAwB;AACpB,UAAI6H,QAAQ,GAAG,KAAK,CAApB;;AACA,UAAI,KAAK5N,MAAL,CAAY4B,0BAAZ,IAA0C,KAAK5B,MAAL,CAAYkB,gBAAZ,EAA9C,EAA8E;AAC1E0M,QAAAA,QAAQ,GAAG,KAAK5N,MAAL,CAAY+B,uBAAZ,GAAsCM,aAAtC,CAAoD,UAApD,EAAgEyD,SAAhE,CAA0E,IAA1E,CAAX;AACH,OAFD,MAGK;AACD8H,QAAAA,QAAQ,GAAG9O,QAAQ,KAAK,KAAKkB,MAAL,CAAY4M,cAAZ,GAA6BvK,aAA7B,CAA2C,UAA3C,EAAuDyD,SAAvD,CAAiE,IAAjE,CAAL,GACf,KAAK9F,MAAL,CAAYgE,OAAZ,CAAoB3B,aAApB,CAAkC,eAAlC,EAAmDA,aAAnD,CAAiE,UAAjE,EAA6EyD,SAA7E,CAAuF,IAAvF,CADJ;AAEH;;AACD,WAAKhB,QAAL,GAAgBgL,YAAhB,CAA6BlC,QAA7B,EAAuC,KAAK7H,WAAL,EAAvC;AACA,WAAKF,WAAL,CAAiB+H,QAAjB;AACH;AACJ,GAbD;;AAcA7N,EAAAA,aAAa,CAAC6D,SAAd,CAAwBsB,qBAAxB,GAAgD,YAAY;AACxD,QAAIpB,IAAI,GAAG,KAAK9D,MAAhB;AACA,QAAIS,IAAI,GAAG,IAAI5B,SAAJ,CAAciF,IAAI,CAACqL,UAAL,EAAd,EAAiC;AACxCY,MAAAA,MAAM,EAAE,cADgC;AAExCtP,MAAAA,IAAI,EAAE,KAAKA;AAF6B,KAAjC,CAAX;AAIH,GAND;;AAOAV,EAAAA,aAAa,CAAC6D,SAAd,CAAwBoM,OAAxB,GAAkC,UAAUpB,MAAV,EAAkB5H,GAAlB,EAAuBsC,KAAvB,EAA8B;AAC5D;;;;;;AAMA,WAAOvK,iBAAiB,CAACiI,GAAD,CAAjB,IAA0B;AAC7BjI,IAAAA,iBAAiB,CAAC6P,MAAM,CAACI,OAAR,CADd,IACkC;AACrChI,IAAAA,GAAG,CAACc,KAAJ,CAAUwB,KAAV,EAAiB0F,OAAjB,KAA6BJ,MAAM,CAACI,OAFxC,CAP4D,CASX;AACpD,GAVD;;AAWAjP,EAAAA,aAAa,CAAC6D,SAAd,CAAwBP,iBAAxB,GAA4C,YAAY;AACpD,WAAO,KAAKD,SAAL,GAAiB,KAAKpD,MAAL,CAAYiQ,aAAZ,GAA4B,IAAIrQ,mBAAJ,CAAwB,KAAKI,MAA7B,CAA5B,GAAmE,IAAIL,iBAAJ,CAAsB,KAAKK,MAA3B,CAA3F;AACH,GAFD;;AAGAD,EAAAA,aAAa,CAAC6D,SAAd,CAAwBsM,WAAxB,GAAsC,UAAUlG,KAAV,EAAiB;AACnD,QAAIlL,QAAQ,MAAM,CAAC,KAAKkB,MAAL,CAAY+M,aAA3B,IAA4C,KAAK/M,MAAL,CAAYmF,UAA5D,EAAwE;AACpE;AACH;;AACD,SAAKL,QAAL,GAAgBP,WAAhB,CAA4ByF,KAA5B;;AACA,QAAI,KAAKhK,MAAL,CAAYmF,UAAhB,EAA4B;AACxB,WAAKnF,MAAL,CAAYoF,gBAAZ,GAA+B/C,aAA/B,CAA6C,OAA7C,EAAsDgH,SAAtD,GAAkE,EAAlE;AACH;AACJ,GARD;;AASAtJ,EAAAA,aAAa,CAAC6D,SAAd,CAAwBuM,YAAxB,GAAuC,UAAUrB,GAAV,EAAesB,GAAf,EAAoBC,QAApB,EAA8B;AACjE,QAAI,KAAKrQ,MAAL,CAAYkB,gBAAZ,EAAJ,EAAoC;AAChC,WAAKqM,cAAL,GAAsBiB,MAAtB,CAA6B,UAAUxH,GAAV,EAAe;AAAE,eAAOqJ,QAAQ,IAAIvB,GAAG,KAAK9H,GAAG,CAAC8H,GAA/B;AAAqC,OAAnF,EAAqFc,OAArF,CAA6F,UAAU5I,GAAV,EAAe;AAAE,eAAOA,GAAG,CAACsJ,UAAJ,GAAiBF,GAAxB;AAA8B,OAA5I;AACH;;AACD,SAAK9C,OAAL,GAAekB,MAAf,CAAsB,UAAUxH,GAAV,EAAe;AAAE,aAAOqJ,QAAQ,IAAIvB,GAAG,KAAK9H,GAAG,CAAC8H,GAA/B;AAAqC,KAA5E,EACKc,OADL,CACa,UAAU5I,GAAV,EAAe;AACxBA,MAAAA,GAAG,CAACsJ,UAAJ,GAAiBF,GAAjB;AACApJ,MAAAA,GAAG,CAACc,KAAJ,CAAU8H,OAAV,CAAkB,UAAUW,IAAV,EAAgB;AAAE,eAAOA,IAAI,CAACD,UAAL,GAAkBF,GAAzB;AAA+B,OAAnE;AACH,KAJD;AAKH,GATD;;AAUArQ,EAAAA,aAAa,CAAC6D,SAAd,CAAwB4M,aAAxB,GAAwC,UAAUlH,KAAV,EAAiB;AACrD,WAAO,KAAKtJ,MAAL,CAAYsO,WAAZ,GAA0BhF,KAA1B,CAAP;AACH,GAFD;;AAGAvJ,EAAAA,aAAa,CAAC6D,SAAd,CAAwB6M,kBAAxB,GAA6C,UAAUnH,KAAV,EAAiB;AAC1D,WAAOA,KAAP;AACH,GAFD;;AAGAvJ,EAAAA,aAAa,CAAC6D,SAAd,CAAwB8M,oBAAxB,GAA+C,UAAUpH,KAAV,EAAiB;AAC5D,WAAO,KAAKtJ,MAAL,CAAYoP,kBAAZ,GAAiC9F,KAAjC,CAAP;AACH,GAFD;;AAGAvJ,EAAAA,aAAa,CAAC6D,SAAd,CAAwBD,iBAAxB,GAA4C,UAAUjD,CAAV,EAAa;AACrD,QAAIA,CAAC,CAACiQ,MAAF,KAAa,OAAb,IAAwBjQ,CAAC,CAACkQ,MAA9B,EAAsC;AAClC,WAAKxN,SAAL,GAAiB,KAAKC,iBAAL,EAAjB;AACH;AACJ,GAJD;;AAKAtD,EAAAA,aAAa,CAAC6D,SAAd,CAAwBiN,aAAxB,GAAwC,UAAU1Q,IAAV,EAAgB;AACpD,SAAKA,IAAL,GAAYA,IAAZ;AACH,GAFD;;AAGA,SAAOJ,aAAP;AACH,CArsBkC,EAAnC;;AAssBA,SAASA,aAAT","sourcesContent":["import { Droppable, isBlazor } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { setStyleAttribute, remove, updateBlazorTemplate, removeClass } from '@syncfusion/ej2-base';\nimport { getUpdateUsingRaf, appendChildren } from '../base/util';\nimport * as events from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowRenderer } from './row-renderer';\nimport { CellMergeRender } from './cell-merge-renderer';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { getScrollBarWidth, isGroupAdaptive } from '../base/util';\n/**\n * Content module is used to render grid content\n * @hidden\n */\nvar ContentRender = /** @class */ (function () {\n    /**\n     * Constructor for content renderer module\n     */\n    function ContentRender(parent, serviceLocator) {\n        var _this = this;\n        this.rows = [];\n        this.freezeRows = [];\n        this.movableRows = [];\n        this.freezeRowElements = [];\n        this.isLoaded = true;\n        this.viewColIndexes = [];\n        this.drop = function (e) {\n            _this.parent.notify(events.columnDrop, { target: e.target, droppedElement: e.droppedElement });\n            remove(e.droppedElement);\n        };\n        this.rafCallback = function (args) {\n            var arg = args;\n            return function () {\n                if (_this.parent.getFrozenColumns() && _this.parent.enableVirtualization) {\n                    var mContentRows = [].slice.call(_this.parent.getMovableVirtualContent().querySelectorAll('.e-row'));\n                    var fContentRows = [].slice.call(_this.parent.getFrozenVirtualContent().querySelectorAll('.e-row'));\n                    _this.isLoaded = !mContentRows ? false : mContentRows.length === fContentRows.length;\n                    if (_this.parent.enableColumnVirtualization && args.requestType === 'virtualscroll' && _this.isLoaded) {\n                        var mHdr = [].slice.call(_this.parent.getMovableVirtualHeader().querySelectorAll('.e-row'));\n                        var fHdr = [].slice.call(_this.parent.getFrozenVirtualHeader().querySelectorAll('.e-row'));\n                        _this.isLoaded = mHdr.length === fHdr.length;\n                    }\n                }\n                _this.ariaService.setBusy(_this.getPanel().querySelector('.e-content'), false);\n                if (_this.parent.isDestroyed) {\n                    return;\n                }\n                var rows = _this.rows.slice(0);\n                if (_this.parent.getFrozenColumns() !== 0) {\n                    rows = args.isFrozen ? _this.freezeRows : _this.movableRows;\n                }\n                _this.parent.notify(events.contentReady, { rows: rows, args: arg });\n                if (_this.isLoaded) {\n                    _this.parent.trigger(events.dataBound, {});\n                    if (_this.parent.allowTextWrap) {\n                        _this.parent.notify(events.freezeRender, { case: 'textwrap' });\n                    }\n                }\n                if (arg) {\n                    var action = (arg.requestType || '').toLowerCase() + '-complete';\n                    _this.parent.notify(action, arg);\n                    if (args.requestType === 'batchsave') {\n                        args.cancel = false;\n                        _this.parent.trigger(events.actionComplete, args);\n                    }\n                }\n                if (_this.isLoaded) {\n                    _this.parent.hideSpinner();\n                }\n            };\n        };\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.ariaService = this.serviceLocator.getService('ariaService');\n        this.generator = this.getModelGenerator();\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (!this.parent.enableColumnVirtualization && !this.parent.enableVirtualization) {\n            this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n        }\n        this.parent.on(events.colGroupRefresh, this.colGroupRefresh, this);\n        this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n    }\n    /**\n     * The function is used to render grid content div\n     */\n    ContentRender.prototype.renderPanel = function () {\n        var gObj = this.parent;\n        var div = this.parent.element.querySelector('.e-gridcontent');\n        if (div) {\n            this.ariaService.setOptions(this.parent.element.querySelector('.e-content'), { busy: false });\n            this.setPanel(div);\n            return;\n        }\n        div = this.parent.createElement('div', { className: 'e-gridcontent' });\n        var innerDiv = this.parent.createElement('div', {\n            className: 'e-content'\n        });\n        this.ariaService.setOptions(innerDiv, { busy: false });\n        div.appendChild(innerDiv);\n        this.setPanel(div);\n        gObj.element.appendChild(div);\n    };\n    /**\n     * The function is used to render grid content table\n     */\n    ContentRender.prototype.renderTable = function () {\n        var contentDiv = this.getPanel();\n        var virtualTable = contentDiv.querySelector('.e-virtualtable');\n        var virtualTrack = contentDiv.querySelector('.e-virtualtrack');\n        if (this.parent.enableVirtualization && !isNullOrUndefined(virtualTable) && !isNullOrUndefined(virtualTrack)) {\n            remove(virtualTable);\n            remove(virtualTrack);\n        }\n        contentDiv.appendChild(this.createContentTable('_content_table'));\n        this.setTable(contentDiv.querySelector('.e-table'));\n        this.ariaService.setOptions(this.getTable(), {\n            multiselectable: this.parent.selectionSettings.type === 'Multiple'\n        });\n        this.initializeContentDrop();\n        if (this.parent.frozenRows) {\n            this.parent.getHeaderContent().classList.add('e-frozenhdrcont');\n        }\n    };\n    /**\n     * The function is used to create content table elements\n     * @return {Element}\n     * @hidden\n     */\n    ContentRender.prototype.createContentTable = function (id) {\n        var innerDiv = this.getPanel().firstElementChild;\n        if (!isBlazor()) {\n            if (this.getTable()) {\n                remove(this.getTable());\n            }\n        }\n        var table = innerDiv.querySelector('.e-table') ? innerDiv.querySelector('.e-table') :\n            this.parent.createElement('table', { className: 'e-table', attrs: {\n                    cellspacing: '0.25px', role: 'grid',\n                    id: this.parent.element.id + id\n                }\n            });\n        this.setColGroup(this.parent.element.querySelector('.e-gridheader').querySelector('colgroup').cloneNode(true));\n        table.appendChild(this.getColGroup());\n        table.appendChild(this.parent.createElement('tbody'));\n        innerDiv.appendChild(table);\n        return innerDiv;\n    };\n    ContentRender.prototype.splitRows = function (idx) {\n        if (this.parent.getFrozenColumns()) {\n            if (idx === 0) {\n                this.freezeRows = this.rows;\n                this.freezeRowElements = this.rowElements;\n            }\n            else {\n                this.movableRows = this.rows;\n            }\n        }\n    };\n    /**\n     * Refresh the content of the Grid.\n     * @return {void}\n     */\n    // tslint:disable-next-line:max-func-body-length\n    ContentRender.prototype.refreshContentRows = function (args) {\n        var _this = this;\n        if (args === void 0) { args = {}; }\n        var gObj = this.parent;\n        if (gObj.currentViewData.length === 0) {\n            return;\n        }\n        var dataSource = gObj.currentViewData;\n        var frag = document.createDocumentFragment();\n        var hdrfrag = document.createDocumentFragment();\n        var columns = gObj.getColumns();\n        var tr;\n        var hdrTbody;\n        var frzCols = gObj.getFrozenColumns();\n        var trElement;\n        var row = new RowRenderer(this.serviceLocator, null, this.parent);\n        this.rowElements = [];\n        this.rows = [];\n        var fCont = this.getPanel().querySelector('.e-frozencontent');\n        var mCont = this.getPanel().querySelector('.e-movablecontent');\n        var cont = this.getPanel().querySelector('.e-content');\n        if (isGroupAdaptive(gObj)) {\n            if (['sorting', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder']\n                .some(function (value) { return args.requestType === value; })) {\n                gObj.vcRows = [];\n                gObj.vRows = [];\n            }\n        }\n        var modelData;\n        var isServerRendered = 'isServerRendered';\n        if (isBlazor() && this.parent[isServerRendered]) {\n            modelData = this.generator.generateRows(dataSource, args);\n            this.rows = modelData;\n            this.freezeRows = modelData;\n            this.rowElements = [].slice.call(this.getTable().querySelectorAll('tr.e-row[data-uid]'));\n            if (frzCols) {\n                this.movableRows = modelData.map(function (mRow) {\n                    var sRow = new Row(mRow);\n                    sRow.cells = mRow.cells.slice(frzCols, mRow.cells.length);\n                    mRow.cells = mRow.cells.slice(0, frzCols);\n                    return sRow;\n                });\n                this.freezeRowElements = this.rowElements;\n            }\n            this.isLoaded = true;\n            this.parent.hideSpinner();\n            args.isFrozen = this.parent.getFrozenColumns() !== 0 && !args.isFrozen;\n            var arg = extend({ rows: this.rows }, args);\n            if (this.getTable().querySelector('.e-emptyrow')) {\n                remove(this.getTable().querySelector('.e-emptyrow'));\n            }\n            if (frzCols) {\n                cont.style.overflowY = 'hidden';\n                fCont.style.height = ((mCont.offsetHeight) - getScrollBarWidth()) + 'px';\n                mCont.style.overflowY = this.parent.height !== 'auto' ? 'scroll' : 'auto';\n                fCont.style.borderRightWidth = '1px';\n                this.parent.notify(events.contentReady, { rows: this.movableRows, args: extend({}, arg, { isFrozen: false }) });\n            }\n            if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple')\n                || (!this.parent.isPersistSelection)) {\n                if (this.parent.editSettings.mode === 'Normal') {\n                    var rowIndex = 'editRowIndex';\n                    this.parent.selectRow(args[rowIndex]);\n                }\n            }\n            this.rafCallback(arg)();\n            return;\n        }\n        if (this.parent.enableVirtualization && this.parent.getFrozenColumns()) {\n            if (this.parent.enableColumnVirtualization) {\n                if (args.requestType === 'virtualscroll' && args.virtualInfo.sentinelInfo.axis === 'X') {\n                    modelData = this.parent.contentModule.generateRows(dataSource, args);\n                    args.renderMovableContent = true;\n                }\n                else if (mCont.scrollLeft > 0 && !args.renderMovableContent) {\n                    this.viewColIndexes = args.virtualInfo.columnIndexes;\n                    var indexes = [];\n                    for (var i = 0; i < this.parent.getFrozenColumns(); i++) {\n                        indexes.push(i);\n                    }\n                    this.parent.setColumnIndexesInView(indexes);\n                    args.virtualInfo.columnIndexes = indexes;\n                }\n            }\n            modelData = this.parent.contentModule.generateRows(dataSource, args);\n        }\n        else {\n            modelData = this.generator.generateRows(dataSource, args);\n        }\n        if (isNullOrUndefined(modelData[0].cells[0])) {\n            mCont.querySelector('tbody').innerHTML = '';\n        }\n        var idx = modelData[0].cells[0].index;\n        if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns() && args.renderMovableContent\n            && args.requestType === 'virtualscroll' && mCont.scrollLeft > 0 && args.virtualInfo.columnIndexes[0] !== 0) {\n            idx = this.parent.getFrozenColumns();\n        }\n        /* tslint:disable:no-any */\n        if (this.parent.registeredTemplate && this.parent.registeredTemplate.template && !args.isFrozen) {\n            var templatetoclear = [];\n            for (var i = 0; i < this.parent.registeredTemplate.template.length; i++) {\n                for (var j = 0; j < this.parent.registeredTemplate.template[i].rootNodes.length; j++) {\n                    if (isNullOrUndefined(this.parent.registeredTemplate.template[i].rootNodes[j].parentNode)) {\n                        templatetoclear.push(this.parent.registeredTemplate.template[i]);\n                        /* tslint:enable:no-any */\n                    }\n                }\n            }\n            this.parent.destroyTemplate(['template'], templatetoclear);\n        }\n        if (this.parent.enableColumnVirtualization) {\n            var cellMerge = new CellMergeRender(this.serviceLocator, this.parent);\n            cellMerge.updateVirtualCells(modelData);\n        }\n        if (frzCols && idx >= frzCols) {\n            this.tbody = mCont.querySelector('tbody');\n        }\n        else {\n            this.tbody = this.getTable().querySelector('tbody');\n        }\n        var startIndex = 0;\n        var blockLoad = true;\n        if (isGroupAdaptive(gObj) && gObj.vcRows.length) {\n            var top_1 = 'top';\n            var scrollTop = !isNullOrUndefined(args.virtualInfo.offsets) ? args.virtualInfo.offsets.top :\n                (!isNullOrUndefined(args.scrollTop) ? args.scrollTop[top_1] : 0);\n            if (scrollTop !== 0) {\n                var offsets_1 = gObj.vGroupOffsets;\n                var bSize = gObj.pageSettings.pageSize / 2;\n                var values = Object.keys(offsets_1).map(function (key) { return offsets_1[key]; });\n                for (var m = 0; m < values.length; m++) {\n                    if (scrollTop < values[m]) {\n                        if (!isNullOrUndefined(args.virtualInfo) && args.virtualInfo.direction === 'up') {\n                            args.virtualInfo.blockIndexes = m === 0 || m === 1 ? [1, 2] : [m, m + 1];\n                            startIndex = m === 0 || m === 1 ? 0 : (m * bSize);\n                            break;\n                        }\n                        else {\n                            args.virtualInfo.blockIndexes = m === 0 || m === 1 ? [1, 2] : [m, m + 1];\n                            startIndex = m === 0 || m === 1 ? 0 : (m) * bSize;\n                            break;\n                        }\n                    }\n                }\n                if (scrollTop + this.contentPanel.firstElementChild.offsetHeight ===\n                    this.contentPanel.firstElementChild.scrollHeight && !args.rowObject) {\n                    blockLoad = false;\n                }\n            }\n        }\n        if (gObj.frozenRows && args.requestType === 'virtualscroll' && args.virtualInfo.sentinelInfo.axis === 'X') {\n            var bIndex = args.virtualInfo.blockIndexes;\n            args.virtualInfo.blockIndexes = [1, 2];\n            var mhdrData = this.vgenerator\n                .generateRows(dataSource, args);\n            mhdrData.splice(this.parent.frozenRows);\n            for (var i = 0; i < this.parent.frozenRows; i++) {\n                if (args.virtualInfo.columnIndexes[0] === 0) {\n                    mhdrData[i].cells.splice(0, this.parent.getFrozenColumns());\n                }\n                tr = row.render(mhdrData[i], columns);\n                hdrfrag.appendChild(tr);\n            }\n            args.virtualInfo.blockIndexes = bIndex;\n        }\n        for (var i = startIndex, len = modelData.length; i < len; i++) {\n            this.rows.push(modelData[i]);\n            if (isGroupAdaptive(gObj) && this.rows.length >= (gObj.pageSettings.pageSize) && blockLoad) {\n                break;\n            }\n            if (!gObj.rowTemplate) {\n                tr = row.render(modelData[i], columns);\n                if (gObj.frozenRows && i < gObj.frozenRows && args.requestType !== 'virtualscroll') {\n                    hdrfrag.appendChild(tr);\n                }\n                else {\n                    frag.appendChild(tr);\n                }\n                if (modelData[i].isExpand) {\n                    gObj.notify(events.expandChildGrid, tr.cells[gObj.groupSettings.columns.length]);\n                }\n            }\n            else {\n                var rowTemplateID = gObj.element.id + 'rowTemplate';\n                var elements = gObj.getRowTemplate()(extend({ index: i }, dataSource[i]), gObj, 'rowTemplate', rowTemplateID);\n                if (elements[0].tagName === 'TBODY') {\n                    for (var j = 0; j < elements.length; j++) {\n                        var isTR = elements[j].nodeName.toLowerCase() === 'tr';\n                        if (isTR || (elements[j].querySelectorAll && elements[j].querySelectorAll('tr').length)) {\n                            tr = isTR ? elements[j] : elements[j].querySelector('tr');\n                        }\n                    }\n                    if (gObj.frozenRows && i < gObj.frozenRows) {\n                        hdrfrag.appendChild(tr);\n                    }\n                    else {\n                        frag.appendChild(tr);\n                    }\n                }\n                else {\n                    if (gObj.frozenRows && i < gObj.frozenRows) {\n                        tr = appendChildren(hdrfrag, elements);\n                    }\n                    else {\n                        // frag.appendChild(tr);\n                        tr = appendChildren(frag, elements);\n                        trElement = tr.lastElementChild;\n                    }\n                }\n                var arg = { data: modelData[i].data, row: trElement ? trElement : tr };\n                this.parent.trigger(events.rowDataBound, arg);\n            }\n            if (modelData[i].isDataRow) {\n                this.rowElements.push(tr);\n            }\n            this.ariaService.setOptions(this.getTable(), { colcount: gObj.getColumns().length.toString() });\n        }\n        this.splitRows(idx);\n        if ((gObj.frozenRows && args.requestType !== 'virtualscroll') || (args.requestType === 'virtualscroll'\n            && args.virtualInfo.sentinelInfo && args.virtualInfo.sentinelInfo.axis === 'X')) {\n            hdrTbody = frzCols ? gObj.getHeaderContent().querySelector(idx === 0 ? '.e-frozenheader'\n                : '.e-movableheader').querySelector('tbody') : gObj.getHeaderTable().querySelector('tbody');\n            hdrTbody.innerHTML = '';\n            hdrTbody.appendChild(hdrfrag);\n        }\n        if (gObj.frozenRows && idx === 0 && cont.offsetHeight === Number(gObj.height)) {\n            cont.style.height = (cont.offsetHeight - hdrTbody.offsetHeight) + 'px';\n        }\n        if (frzCols && idx === 0) {\n            this.getPanel().firstChild.style.overflowY = 'hidden';\n        }\n        if (!isBlazor() || this.parent.isJsComponent) {\n            args.rows = this.rows.slice(0);\n        }\n        args.isFrozen = this.parent.getFrozenColumns() !== 0 && !args.isFrozen;\n        this.index = idx;\n        getUpdateUsingRaf(function () {\n            _this.parent.notify(events.beforeFragAppend, args);\n            var isVFTable = _this.parent.enableVirtualization && _this.parent.getFrozenColumns() !== 0;\n            if (!_this.parent.enableVirtualization) {\n                remove(_this.tbody);\n                _this.tbody = _this.parent.createElement('tbody');\n            }\n            if (frzCols && !isVFTable) {\n                _this.tbody.appendChild(frag);\n                if (_this.index === 0) {\n                    _this.isLoaded = false;\n                    fCont.querySelector('table').appendChild(_this.tbody);\n                }\n                else {\n                    if (_this.tbody.childElementCount < 1) {\n                        _this.tbody.appendChild(_this.parent.createElement('tr').appendChild(_this.parent.createElement('td')));\n                    }\n                    _this.isLoaded = true;\n                    mCont.querySelector('table').appendChild(_this.tbody);\n                    if (_this.parent.getFrozenColumns() !== 0 && !_this.parent.allowTextWrap) {\n                        _this.parent.notify(events.freezeRender, { case: 'refreshHeight' });\n                    }\n                    fCont.style.height = ((mCont.offsetHeight) - getScrollBarWidth()) + 'px';\n                    mCont.style.overflowY = _this.parent.height !== 'auto' ? 'scroll' : 'auto';\n                    fCont.style.borderRightWidth = '1px';\n                }\n            }\n            else {\n                if (gObj.rowTemplate) {\n                    updateBlazorTemplate(gObj.element.id + 'rowTemplate', 'RowTemplate', gObj);\n                }\n                if (isVFTable) {\n                    if (!args.renderMovableContent) {\n                        _this.appendContent(fCont.querySelector('tbody'), frag, args);\n                        if (_this.parent.enableColumnVirtualization && mCont.scrollLeft > 0) {\n                            _this.parent.setColumnIndexesInView(_this.viewColIndexes);\n                            args.virtualInfo.columnIndexes = _this.viewColIndexes;\n                        }\n                    }\n                    else {\n                        _this.appendContent(mCont.querySelector('tbody'), frag, args);\n                        if (args.virtualInfo && args.virtualInfo.direction !== 'right' && args.virtualInfo.direction !== 'left') {\n                            fCont.style.height = ((mCont.offsetHeight) - getScrollBarWidth()) + 'px';\n                        }\n                        args.renderMovableContent = false;\n                    }\n                }\n                else {\n                    _this.appendContent(_this.tbody, frag, args);\n                }\n            }\n            if (frzCols && idx === 0) {\n                if (isVFTable) {\n                    args.renderMovableContent = true;\n                }\n                _this.refreshContentRows(extend({}, args));\n            }\n            frag = null;\n        }, this.rafCallback(extend({}, args)));\n    };\n    ContentRender.prototype.appendContent = function (tbody, frag, args) {\n        tbody.appendChild(frag);\n        this.getTable().appendChild(tbody);\n    };\n    /**\n     * Get the content div element of grid\n     * @return {Element}\n     */\n    ContentRender.prototype.getPanel = function () {\n        return this.contentPanel;\n    };\n    /**\n     * Set the content div element of grid\n     * @param  {Element} panel\n     */\n    ContentRender.prototype.setPanel = function (panel) {\n        this.contentPanel = panel;\n    };\n    /**\n     * Get the content table element of grid\n     * @return {Element}\n     */\n    ContentRender.prototype.getTable = function () {\n        return this.contentTable;\n    };\n    /**\n     * Set the content table element of grid\n     * @param  {Element} table\n     */\n    ContentRender.prototype.setTable = function (table) {\n        this.contentTable = table;\n    };\n    /**\n     * Get the Row collection in the Grid.\n     * @returns {Row[] | HTMLCollectionOf<HTMLTableRowElement>}\n     */\n    ContentRender.prototype.getRows = function () {\n        return this.parent.getFrozenColumns() ? this.freezeRows : this.rows;\n    };\n    /**\n     * Get the Movable Row collection in the Freeze pane Grid.\n     * @returns {Row[] | HTMLCollectionOf<HTMLTableRowElement>}\n     */\n    ContentRender.prototype.getMovableRows = function () {\n        return this.movableRows;\n    };\n    /**\n     * Get the content table data row elements\n     * @return {Element}\n     */\n    ContentRender.prototype.getRowElements = function () {\n        return this.parent.getFrozenColumns() ? this.freezeRowElements : this.rowElements;\n    };\n    /**\n     * Get the Freeze pane movable content table data row elements\n     * @return {Element}\n     */\n    ContentRender.prototype.getMovableRowElements = function () {\n        return this.rowElements;\n    };\n    /**\n     * Get the content table data row elements\n     * @return {Element}\n     */\n    ContentRender.prototype.setRowElements = function (elements) {\n        this.rowElements = elements;\n    };\n    /**\n     * Get the header colgroup element\n     * @returns {Element}\n     */\n    ContentRender.prototype.getColGroup = function () {\n        return this.colgroup;\n    };\n    /**\n     * Set the header colgroup element\n     * @param {Element} colgroup\n     * @returns {Element}\n     */\n    ContentRender.prototype.setColGroup = function (colGroup) {\n        if (!isNullOrUndefined(colGroup)) {\n            colGroup.id = 'content-' + colGroup.id;\n        }\n        return this.colgroup = colGroup;\n    };\n    /**\n     * Function to hide content table column based on visible property\n     * @param  {Column[]} columns?\n     */\n    ContentRender.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        if (isBlazor() && gObj.isServerRendered) {\n            this.parent.notify('setvisibility', columns);\n        }\n        var frzCols = gObj.getFrozenColumns();\n        var rows = [];\n        if (frzCols) {\n            var fRows = this.freezeRows;\n            var mRows = this.movableRows;\n            var rowLen = fRows.length;\n            var cellLen = void 0;\n            for (var i = 0, row = void 0; i < rowLen; i++) {\n                cellLen = mRows[i].cells.length;\n                row = fRows[i].clone();\n                for (var j = 0; j < cellLen; j++) {\n                    row.cells.push(mRows[i].cells[j]);\n                }\n                rows.push(row);\n            }\n        }\n        else {\n            rows = this.getRows();\n        }\n        var element;\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var tasks = [];\n        var needFullRefresh = true;\n        if (!gObj.groupSettings.columns.length && testRow) {\n            needFullRefresh = false;\n        }\n        var tr = gObj.getDataRows();\n        var args = {};\n        var contentrows = this.rows.filter(function (row) { return !row.isDetailRow; });\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[c];\n            var idx = this.parent.getNormalizedColumnIndex(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                if (frzCols) {\n                    if (idx < frzCols) {\n                        setStyleAttribute(this.getColGroup().childNodes[idx], { 'display': displayVal });\n                        contentrows = this.freezeRows;\n                    }\n                    else {\n                        var mTable = gObj.getContent().querySelector('.e-movablecontent').querySelector('colgroup');\n                        idx = idx - frzCols;\n                        setStyleAttribute(mTable.childNodes[idx], { 'display': displayVal });\n                        tr = gObj.getMovableDataRows();\n                        contentrows = this.movableRows;\n                    }\n                }\n                else {\n                    if (gObj.isRowDragable()) {\n                        idx++;\n                    }\n                    setStyleAttribute(this.getColGroup().childNodes[idx], { 'display': displayVal });\n                    if (gObj.isRowDragable()) {\n                        idx--;\n                    }\n                }\n            }\n            idx = gObj.isDetail() ? idx - 1 : idx;\n            if (!needFullRefresh) {\n                this.setDisplayNone(tr, idx, displayVal, contentrows);\n            }\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n        if (needFullRefresh) {\n            this.refreshContentRows({ requestType: 'refresh' });\n        }\n        else {\n            if (!this.parent.getFrozenColumns()) {\n                this.parent.notify(events.partialRefresh, { rows: contentrows, args: args });\n            }\n            else {\n                this.parent.notify(events.partialRefresh, { rows: this.freezeRows, args: { isFrozen: true, rows: this.freezeRows } });\n                this.parent.notify(events.partialRefresh, { rows: this.movableRows, args: { isFrozen: false, rows: this.movableRows } });\n            }\n        }\n    };\n    /**\n     * @hidden\n     */\n    ContentRender.prototype.setDisplayNone = function (tr, idx, displayVal, rows) {\n        Object.keys(tr).forEach(function (i) {\n            if (tr[i].querySelectorAll('td.e-rowcell').length) {\n                setStyleAttribute(tr[i].querySelectorAll('td.e-rowcell')[idx], { 'display': displayVal });\n                if (tr[i].querySelectorAll('td.e-rowcell')[idx].classList.contains('e-hide')) {\n                    removeClass([tr[i].querySelectorAll('td.e-rowcell')[idx]], ['e-hide']);\n                }\n                rows[i].cells[idx].visible = displayVal === '' ? true : false;\n            }\n        });\n    };\n    ContentRender.prototype.colGroupRefresh = function () {\n        if (this.getColGroup()) {\n            var colGroup = void 0;\n            if (this.parent.enableColumnVirtualization && this.parent.getFrozenColumns()) {\n                colGroup = this.parent.getMovableVirtualHeader().querySelector('colgroup').cloneNode(true);\n            }\n            else {\n                colGroup = isBlazor() ? this.parent.getHeaderTable().querySelector('colgroup').cloneNode(true) :\n                    this.parent.element.querySelector('.e-gridheader').querySelector('colgroup').cloneNode(true);\n            }\n            this.getTable().replaceChild(colGroup, this.getColGroup());\n            this.setColGroup(colGroup);\n        }\n    };\n    ContentRender.prototype.initializeContentDrop = function () {\n        var gObj = this.parent;\n        var drop = new Droppable(gObj.getContent(), {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n    };\n    ContentRender.prototype.canSkip = function (column, row, index) {\n        /**\n         * Skip the toggle visiblity operation when one of the following success\n         * 1. Grid has empty records\n         * 2. column visible property is unchanged\n         * 3. cell`s isVisible property is same as column`s visible property.\n         */\n        return isNullOrUndefined(row) || //(1)\n            isNullOrUndefined(column.visible) || //(2)    \n            row.cells[index].visible === column.visible; //(3)\n    };\n    ContentRender.prototype.getModelGenerator = function () {\n        return this.generator = this.parent.allowGrouping ? new GroupModelGenerator(this.parent) : new RowModelGenerator(this.parent);\n    };\n    ContentRender.prototype.renderEmpty = function (tbody) {\n        if (isBlazor() && !this.parent.isJsComponent && this.parent.frozenRows) {\n            return;\n        }\n        this.getTable().appendChild(tbody);\n        if (this.parent.frozenRows) {\n            this.parent.getHeaderContent().querySelector('tbody').innerHTML = '';\n        }\n    };\n    ContentRender.prototype.setSelection = function (uid, set, clearAll) {\n        if (this.parent.getFrozenColumns()) {\n            this.getMovableRows().filter(function (row) { return clearAll || uid === row.uid; }).forEach(function (row) { return row.isSelected = set; });\n        }\n        this.getRows().filter(function (row) { return clearAll || uid === row.uid; })\n            .forEach(function (row) {\n            row.isSelected = set;\n            row.cells.forEach(function (cell) { return cell.isSelected = set; });\n        });\n    };\n    ContentRender.prototype.getRowByIndex = function (index) {\n        return this.parent.getDataRows()[index];\n    };\n    ContentRender.prototype.getVirtualRowIndex = function (index) {\n        return index;\n    };\n    ContentRender.prototype.getMovableRowByIndex = function (index) {\n        return this.parent.getMovableDataRows()[index];\n    };\n    ContentRender.prototype.enableAfterRender = function (e) {\n        if (e.module === 'group' && e.enable) {\n            this.generator = this.getModelGenerator();\n        }\n    };\n    ContentRender.prototype.setRowObjects = function (rows) {\n        this.rows = rows;\n    };\n    return ContentRender;\n}());\nexport { ContentRender };\n"]},"metadata":{},"sourceType":"module"}