{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\n/**\n * FocusStrategy class\n * @hidden\n */\n\nvar FocusStrategy =\n/** @class */\nfunction () {\n  function FocusStrategy(parent) {\n    this.currentInfo = {};\n    this.oneTime = true;\n    this.swap = {};\n    this.forget = true;\n    this.skipFocus = true;\n    this.focusByClick = false;\n    this.prevIndexes = {};\n    this.refMatrix = this.refreshMatrix(true);\n    this.parent = parent;\n    this.rowModelGen = new RowModelGenerator(this.parent);\n    this.addEventListener();\n  }\n\n  FocusStrategy.prototype.focusCheck = function (e) {\n    var target = e.target;\n    this.focusByClick = true;\n    this.skipFocus = target.classList.contains('e-grid');\n  };\n\n  FocusStrategy.prototype.onFocus = function () {\n    if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization) {\n      return;\n    }\n\n    this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0, this.parent.frozenColumns !== 0);\n\n    if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length) {\n      this.getContent().matrix.generate(this.rowModelGen.generateRows({\n        rows: [new Row({\n          isDataRow: true\n        })]\n      }), this.getContent().selector, false);\n    }\n\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n    this.getContent().matrix.select(current[0], current[1]);\n\n    if (this.skipFocus) {\n      this.focus();\n      this.skipFocus = false;\n    }\n  };\n\n  FocusStrategy.prototype.passiveFocus = function (e) {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (e.target && e.target.classList.contains('e-detailcell')) {\n      this.currentInfo.skipAction = false;\n      addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n    }\n  };\n\n  FocusStrategy.prototype.onBlur = function (e) {\n    if (this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid'))) {\n      return;\n    }\n\n    this.removeFocus();\n    this.skipFocus = false;\n    this.currentInfo.skipAction = false;\n\n    if (this.getContent().getFocusInfo().elementToFocus) {\n      this.getContent().getFocusInfo().elementToFocus.tabIndex = 0;\n    }\n  };\n\n  FocusStrategy.prototype.onClick = function (e, force) {\n    var isContent = !isNullOrUndefined(closest(e.target, '.e-gridcontent'));\n    var isHeader = !isNullOrUndefined(closest(e.target, '.e-gridheader'));\n    isContent = isContent && isHeader ? !isContent : isContent;\n    var isFrozen = !isNullOrUndefined(closest(e.target, '.e-frozencontent')) || !isNullOrUndefined(closest(e.target, '.e-frozenheader'));\n\n    if (!isContent && isNullOrUndefined(closest(e.target, '.e-gridheader')) || e.target.classList.contains('e-content') || !isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n      return;\n    }\n\n    this.setActive(isContent, isFrozen);\n\n    if (!isContent && isNullOrUndefined(closest(e.target, '.e-gridheader')) || e.target.classList.contains('e-filtermenudiv')) {\n      this.clearOutline();\n      return;\n    }\n\n    var beforeArgs = {\n      cancel: false,\n      byKey: false,\n      byClick: !isNullOrUndefined(e.target),\n      clickArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n\n    if (beforeArgs.cancel || closest(e.target, '.e-inline-edit')) {\n      return;\n    }\n\n    this.setActive(isContent, isFrozen);\n\n    if (this.getContent()) {\n      var returnVal = this.getContent().onClick(e, force);\n\n      if (returnVal === false) {\n        return;\n      }\n\n      this.focus();\n    }\n  };\n\n  FocusStrategy.prototype.onKeyPress = function (e) {\n    if (this.skipOn(e)) {\n      return;\n    }\n\n    var beforeArgs = {\n      cancel: false,\n      byKey: true,\n      byClick: false,\n      keyArgs: e\n    };\n    this.parent.notify(event.beforeCellFocused, beforeArgs);\n\n    if (beforeArgs.cancel) {\n      return;\n    }\n\n    var bValue = this.getContent().matrix.current;\n    this.currentInfo.outline = true;\n    var swapInfo = this.getContent().jump(e.action, bValue);\n    this.swap = swapInfo;\n\n    if (swapInfo.swap) {\n      this.setActive(!swapInfo.toHeader, swapInfo.toFrozen);\n      this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n      this.prevIndexes = {};\n    }\n\n    this.setActiveByKey(e.action, this.getContent());\n    var returnVal = this.getContent().onKeyPress(e);\n\n    if (returnVal === false) {\n      this.clearIndicator();\n      return;\n    }\n\n    e.preventDefault();\n    this.focus(e);\n  };\n\n  FocusStrategy.prototype.skipOn = function (e) {\n    var target = e.target;\n\n    if (!target) {\n      return false;\n    }\n\n    if (this.currentInfo.skipAction) {\n      this.clearIndicator();\n      return true;\n    }\n\n    if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n      this.clearIndicator();\n      return true;\n    }\n\n    var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n\n    if (th && closest(document.activeElement, '.e-filterbarcell') !== null) {\n      this.removeFocus();\n    }\n\n    var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n\n    if (this.parent.enableHeaderFocus && filterCell) {\n      var matrix = this.active.matrix;\n      var current = matrix.current;\n      filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n    }\n\n    return e.action === 'delete' || this.parent.editSettings.mode !== 'Batch' && (this.parent.isEdit || ['insert', 'f2'].indexOf(e.action) > -1) || filterCell || closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null && ['enter', 'leftArrow', 'rightArrow', 'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1 || closest(target, '.e-gridcontent') === null && closest(target, '.e-gridheader') === null || e.action === 'space' && !target.classList.contains('e-gridchkbox') && closest(target, '.e-gridchkbox') === null && closest(target, '.e-headerchkcelldiv') === null || closest(target, '.e-filter-popup') !== null;\n  };\n\n  FocusStrategy.prototype.getFocusedElement = function () {\n    return this.currentInfo.elementToFocus;\n  };\n\n  FocusStrategy.prototype.getContent = function () {\n    return this.active || this.content;\n  };\n\n  FocusStrategy.prototype.setActive = function (content, isFrozen) {\n    this.active = content ? isFrozen ? this.fContent : this.content : isFrozen ? this.fHeader : this.header;\n  };\n\n  FocusStrategy.prototype.setFocusedElement = function (element, e) {\n    var _this = this;\n\n    this.currentInfo.elementToFocus = element;\n    setTimeout(function () {\n      if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n        _this.parent.notify('virtaul-key-handler', e);\n\n        _this.currentInfo.elementToFocus.focus();\n      }\n    }, 0);\n  };\n\n  FocusStrategy.prototype.focus = function (e) {\n    this.parent.notify(event.virtaulCellFocus, e);\n    this.removeFocus();\n    this.addFocus(this.getContent().getFocusInfo(), e);\n  };\n\n  FocusStrategy.prototype.removeFocus = function (e) {\n    if (!this.currentInfo.element) {\n      return;\n    }\n\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n    this.currentInfo.element.tabIndex = -1;\n  };\n  /** @hidden */\n\n\n  FocusStrategy.prototype.addOutline = function () {\n    var info = this.getContent().getFocusInfo();\n\n    if (info.element) {\n      addClass([info.element], ['e-focused']);\n      addClass([info.elementToFocus], ['e-focus']);\n    }\n  };\n  /** @hidden */\n\n\n  FocusStrategy.prototype.focusHeader = function () {\n    this.setActive(false, this.parent.frozenColumns !== 0);\n    this.resetFocus();\n  };\n  /** @hidden */\n\n\n  FocusStrategy.prototype.focusContent = function () {\n    this.setActive(true, this.parent.frozenColumns !== 0);\n    this.resetFocus();\n  };\n\n  FocusStrategy.prototype.resetFocus = function () {\n    var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n    this.getContent().matrix.select(current[0], current[1]);\n    this.focus();\n  };\n\n  FocusStrategy.prototype.addFocus = function (info, e) {\n    this.currentInfo = info;\n    this.currentInfo.outline = info.outline && !isNullOrUndefined(e);\n\n    if (!info.element) {\n      return;\n    }\n\n    var isFocused = info.elementToFocus.classList.contains('e-focus');\n\n    if (isFocused) {\n      return;\n    }\n\n    if (this.currentInfo.outline) {\n      addClass([info.element], ['e-focused']);\n    }\n\n    addClass([info.elementToFocus], ['e-focus']);\n    info.element.tabIndex = 0;\n\n    if (!isFocused) {\n      this.setFocusedElement(info.elementToFocus, e);\n    }\n\n    this.parent.notify(event.cellFocused, {\n      element: info.elementToFocus,\n      parent: info.element,\n      indexes: this.getContent().matrix.current,\n      byKey: !isNullOrUndefined(e),\n      byClick: isNullOrUndefined(e),\n      keyArgs: e,\n      isJump: this.swap.swap,\n      container: this.getContent().getInfo(e),\n      outline: !isNullOrUndefined(e),\n      swapInfo: this.swap\n    });\n    var _a = this.getContent().matrix.current,\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    this.prevIndexes = {\n      rowIndex: rowIndex,\n      cellIndex: cellIndex\n    };\n    this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n    this.focusByClick = false;\n  };\n\n  FocusStrategy.prototype.refreshMatrix = function (content) {\n    var _this = this;\n\n    return function (e) {\n      if (content && e.args && e.args.isFrozen && !_this.fContent) {\n        _this.fContent = new FixedContentFocus(_this.parent);\n      } else if (content && !_this.content) {\n        _this.content = new ContentFocus(_this.parent);\n      }\n\n      if (!content && e.args && e.args.isFrozen && !_this.fHeader) {\n        _this.fHeader = new FixedHeaderFocus(_this.parent);\n      } else if (!content && !_this.header) {\n        _this.header = new HeaderFocus(_this.parent);\n      }\n\n      var cFocus = content ? e.args && e.args.isFrozen ? _this.fContent : _this.content : e.args && e.args.isFrozen ? _this.fHeader : _this.header;\n      var rows = content ? e.rows.slice(_this.parent.frozenRows) : e.rows;\n      var updateRow = content ? e.rows.slice(0, _this.parent.frozenRows) : e.rows;\n      var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n      var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n\n      var frozenColumnsCount = _this.parent.getFrozenColumns();\n\n      if (e.name === 'batchAdd' && frozenColumnsCount) {\n        var newMovableRows = rows.map(function (row) {\n          return row.clone();\n        });\n        var newFrozenRows = rows.map(function (row) {\n          return row.clone();\n        });\n\n        for (var i = 0; i < rows.length; i++) {\n          if (rows[i].cells.length > frozenColumnsCount) {\n            newFrozenRows[i].cells = rows[i].cells.slice(0, frozenColumnsCount);\n            newMovableRows[i].cells = rows[i].cells.slice(frozenColumnsCount);\n          }\n        }\n\n        _this.fContent.matrix.generate(newFrozenRows, _this.fContent.selector, isRowTemplate);\n\n        cFocus.matrix.generate(newMovableRows, cFocus.selector, isRowTemplate);\n      } else {\n        cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n      }\n\n      cFocus.generateRows(updateRow, {\n        matrix: matrix,\n        handlerInstance: e.args && e.args.isFrozen ? _this.fHeader : _this.header\n      });\n\n      if (!Browser.isDevice && e && e.args) {\n        if (!_this.focusByClick && e.args.requestType === 'paging') {\n          _this.skipFocus = false;\n\n          _this.parent.element.focus();\n        }\n\n        if (e.args.requestType === 'grouping') {\n          _this.skipFocus = true;\n        }\n      }\n\n      if (e && e.args && e.args.requestType === 'virtualscroll') {\n        if (_this.currentInfo.uid) {\n          var index_1;\n          var bool = e.rows.some(function (row, i) {\n            index_1 = i;\n            return row.uid === _this.currentInfo.uid;\n          });\n\n          if (bool) {\n            _this.content.matrix.current[0] = index_1;\n            _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n\n            var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n\n            if (focusElement) {\n              var cellPosition = focusElement.getBoundingClientRect();\n\n              var gridPosition = _this.parent.element.getBoundingClientRect();\n\n              if (cellPosition.top >= 0 && cellPosition.left >= 0 && cellPosition.right <= Math.min(gridPosition.right, window.innerWidth || document.documentElement.clientWidth) && cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight || document.documentElement.clientHeight)) {\n                _this.focus();\n              }\n            }\n          }\n        } else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n          var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n\n          if (focusElement) {\n            focusElement.focus();\n          }\n        }\n      }\n    };\n  };\n\n  FocusStrategy.prototype.addEventListener = function () {\n    var _this = this;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n    EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n    this.parent.element.addEventListener('focus', this.passiveHandler = function (e) {\n      return _this.passiveFocus(e);\n    }, true);\n    EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n    this.parent.on(event.keyPressed, this.onKeyPress, this);\n    this.parent.on(event.click, this.onClick, this);\n    this.parent.on(event.contentReady, this.refMatrix, this);\n    this.parent.on(event.partialRefresh, this.refMatrix, this);\n    this.parent.on(event.headerRefreshed, this.refreshMatrix(), this);\n    this.parent.on('close-edit', this.restoreFocus, this);\n    this.parent.on('restore-Focus', this.restoreFocus, this);\n    ['start-edit', 'start-add'].forEach(function (evt) {\n      return _this.parent.on(evt, _this.clearIndicator, _this);\n    });\n    ['sorting', 'filtering'].forEach(function (action) {\n      return _this.parent.on(action + \"-complete\", _this.restoreFocus, _this);\n    });\n    ['grouping', 'ungrouping'].forEach(function (action) {\n      return _this.parent.on(action + \"-complete\", _this.restoreFocusWithAction, _this);\n    });\n    this.parent.on(event.batchAdd, this.refMatrix, this);\n    this.parent.on(event.batchCancel, this.refMatrix, this);\n    this.parent.on(event.batchDelete, this.refMatrix, this);\n    this.parent.on(event.detailDataBound, this.refMatrix, this);\n    this.parent.on(event.onEmpty, this.refMatrix, this);\n    this.parent.on(event.cellFocused, this.internalCellFocus, this);\n  };\n\n  FocusStrategy.prototype.removeEventListener = function () {\n    var _this = this;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n    EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n    EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n    this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n    this.parent.off(event.keyPressed, this.onKeyPress);\n    this.parent.off(event.click, this.onClick);\n    this.parent.off(event.contentReady, this.refMatrix);\n    this.parent.off(event.partialRefresh, this.refMatrix);\n    this.parent.off(event.headerRefreshed, this.refreshMatrix());\n    this.parent.off('close-edit', this.restoreFocus);\n    this.parent.off('restore-focus', this.restoreFocus);\n    ['start-edit', 'start-add'].forEach(function (evt) {\n      return _this.parent.off(evt, _this.clearOutline);\n    });\n    ['sorting', 'filtering'].forEach(function (action) {\n      return _this.parent.off(action + \"-complete\", _this.restoreFocus);\n    });\n    ['grouping', 'ungrouping'].forEach(function (action) {\n      return _this.parent.on(action + \"-complete\", _this.restoreFocusWithAction);\n    });\n    this.parent.off(event.batchAdd, this.refMatrix);\n    this.parent.off(event.batchDelete, this.refMatrix);\n    this.parent.off(event.batchCancel, this.refMatrix);\n    this.parent.off(event.detailDataBound, this.refMatrix);\n    this.parent.off(event.onEmpty, this.refMatrix);\n    this.parent.off(event.cellFocused, this.internalCellFocus);\n  };\n\n  FocusStrategy.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n\n  FocusStrategy.prototype.restoreFocus = function () {\n    this.addFocus(this.getContent().getFocusInfo());\n  };\n\n  FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n    var matrix = this.getContent().matrix;\n    var current = matrix.current;\n\n    switch (e.requestType) {\n      case 'grouping':\n      case 'ungrouping':\n        current[1] = current.length && !this.parent.groupSettings.showGroupedColumn ? matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n        break;\n    }\n\n    this.getContent().matrix.current = current;\n    this.addFocus(this.getContent().getFocusInfo());\n  };\n\n  FocusStrategy.prototype.clearOutline = function () {\n    this.getContent().matrix.current = this.getContent().matrix.get(0, -1, [0, 1], 'downArrow', this.getContent().validator());\n    this.clearIndicator();\n  };\n\n  FocusStrategy.prototype.clearIndicator = function () {\n    if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n      return;\n    }\n\n    removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n  };\n\n  FocusStrategy.prototype.getPrevIndexes = function () {\n    var forget = this.forget;\n    this.forget = false;\n    return forget ? {\n      rowIndex: null,\n      cellIndex: null\n    } : this.prevIndexes;\n  };\n\n  FocusStrategy.prototype.forgetPrevious = function () {\n    this.forget = true;\n  };\n\n  FocusStrategy.prototype.setActiveByKey = function (action, active) {\n    var _this = this;\n\n    if (this.parent.frozenColumns === 0 && this.parent.frozenRows === 0) {\n      return;\n    }\n\n    var info;\n    var actions = {\n      'home': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: true\n        };\n      },\n      'end': function () {\n        return {\n          toHeader: !info.isContent,\n          toFrozen: false\n        };\n      },\n      'ctrlHome': function () {\n        return {\n          toHeader: true,\n          toFrozen: _this.parent.frozenColumns !== 0\n        };\n      },\n      'ctrlEnd': function () {\n        return {\n          toHeader: false,\n          toFrozen: false\n        };\n      }\n    };\n\n    if (!(action in actions)) {\n      return;\n    }\n\n    info = active.getInfo();\n    var swap = actions[action]();\n    this.setActive(!swap.toHeader, swap.toFrozen);\n    this.getContent().matrix.current = active.matrix.current;\n  };\n\n  FocusStrategy.prototype.internalCellFocus = function (e) {\n    if (!(e.byKey && e.container.isContent && e.keyArgs.action === 'enter' && (e.parent.classList.contains('e-detailcell') || e.parent.classList.contains('e-unboundcell') || e.parent.classList.contains('e-templatecell')))) {\n      return;\n    }\n\n    this.clearIndicator();\n    var focusEle = this.getContent().getFocusable(this.getFocusedElement());\n    this.setFocusedElement(focusEle);\n    this.currentInfo.skipAction = true;\n  };\n\n  return FocusStrategy;\n}();\n\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n * @hidden\n */\n\nvar Matrix =\n/** @class */\nfunction () {\n  function Matrix() {\n    this.matrix = [];\n    this.current = [];\n  }\n\n  Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n    this.matrix[rowIndex] = this.matrix[rowIndex] || [];\n    this.matrix[rowIndex][columnIndex] = allow ? 1 : 0;\n  };\n\n  Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator) {\n    var tmp = columnIndex;\n\n    if (rowIndex + navigator[0] < 0) {\n      return [rowIndex, columnIndex];\n    }\n\n    rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n\n    if (isNullOrUndefined(this.matrix[rowIndex])) {\n      return null;\n    }\n\n    columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[rowIndex].length - 1));\n\n    if (tmp + navigator[1] > this.matrix[rowIndex].length - 1 && validator(rowIndex, columnIndex, action)) {\n      return [rowIndex, tmp];\n    }\n\n    var first = this.first(this.matrix[rowIndex], columnIndex, navigator, true, action);\n    columnIndex = first === null ? tmp : first;\n    var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n\n    if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n      navigator[0] = -1;\n    }\n\n    return this.inValid(val) || !validator(rowIndex, columnIndex, action) ? this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n  };\n\n  Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n    if ((index < 0 || index === vector.length) && this.inValid(vector[index]) && action !== 'upArrow' && action !== 'downArrow' || !vector.some(function (v) {\n      return v === 1;\n    })) {\n      return null;\n    }\n\n    return !this.inValid(vector[index]) ? index : this.first(vector, ['upArrow', 'downArrow', 'shiftUp', 'shiftDown'].indexOf(action) !== -1 ? moveTo ? 0 : ++index : index + navigator[1], navigator, false, action);\n  };\n\n  Matrix.prototype.select = function (rowIndex, columnIndex) {\n    rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n    columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[rowIndex].length - 1));\n    this.current = [rowIndex, columnIndex];\n  };\n\n  Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n    var _this = this;\n\n    this.rows = rows.length - 1;\n    this.matrix = [];\n    rows.forEach(function (row, rIndex) {\n      var cells = row.cells.filter(function (c) {\n        return c.isSpanned !== true;\n      });\n      _this.columns = Math.max(cells.length - 1, _this.columns | 0);\n      cells.forEach(function (cell, cIndex) {\n        _this.set(rIndex, cIndex, selector(row, cell, isRowTemplate));\n      });\n    });\n    return this.matrix;\n  };\n\n  Matrix.prototype.inValid = function (value) {\n    return value === 0 || value === undefined;\n  };\n\n  return Matrix;\n}();\n\nexport { Matrix };\n/**\n * @hidden\n */\n\nvar ContentFocus =\n/** @class */\nfunction () {\n  function ContentFocus(parent) {\n    var _this = this;\n\n    this.matrix = new Matrix();\n    this.parent = parent;\n    this.keyActions = {\n      'rightArrow': [0, 1],\n      'tab': [0, 1],\n      'leftArrow': [0, -1],\n      'shiftTab': [0, -1],\n      'upArrow': [-1, 0],\n      'downArrow': [1, 0],\n      'shiftUp': [-1, 0],\n      'shiftDown': [1, 0],\n      'shiftRight': [0, 1],\n      'shiftLeft': [0, -1],\n      'enter': [1, 0],\n      'shiftEnter': [-1, 0]\n    };\n\n    this.indexesByKey = function (action) {\n      var opt = {\n        'home': [_this.matrix.current[0], -1, 0, 1],\n        'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n        'ctrlHome': [0, -1, 0, 1],\n        'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n      };\n      return opt[action] || null;\n    };\n  }\n\n  ContentFocus.prototype.getTable = function () {\n    return this.parent.frozenColumns ? this.parent.getContent().querySelector('.e-movablecontent .e-table') : this.parent.getContentTable();\n  };\n\n  ContentFocus.prototype.onKeyPress = function (e) {\n    var navigator = this.keyActions[e.action];\n    var current = this.getCurrentFromAction(e.action, navigator, e.action in this.keyActions, e);\n\n    if (!current) {\n      return;\n    }\n\n    if ((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString()) {\n      if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() || current.toString() === [0, 0].toString() || this.matrix.current[0] === this.matrix.rows && this.matrix.current.toString() === current.toString()) {\n        return false;\n      } else {\n        current = this.editNextRow(current[0], current[1], e.action);\n      }\n    }\n\n    this.matrix.select(current[0], current[1]);\n  };\n\n  ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n    var gObj = this.parent;\n    var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n    var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n    var cell = this.getTable().rows[rowIndex].cells[cellIndex];\n\n    if (action === 'tab' && editNextRow) {\n      rowIndex++;\n      var index = this.getTable().rows[rowIndex].querySelectorAll('.e-indentcell').length + this.getTable().rows[rowIndex].querySelectorAll('.e-detailrowcollapse').length;\n      cellIndex = visibleIndex + index;\n    }\n\n    if (action === 'shiftTab' && editNextRow) {\n      rowIndex--;\n      cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n    }\n\n    return !cell.classList.contains('e-rowcell') && !cell.classList.contains('e-headercell') && !cell.classList.contains('e-groupcaption') ? this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n  };\n\n  ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n    if (navigator === void 0) {\n      navigator = [0, 0];\n    }\n\n    if (!isPresent && !this.indexesByKey(action) || this.matrix.current.length === 0) {\n      return null;\n    }\n\n    if (!this.shouldFocusChange(e)) {\n      return this.matrix.current;\n    }\n\n    var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator),\n        rowIndex = _a[0],\n        cellIndex = _a[1],\n        rN = _a[2],\n        cN = _a[3];\n\n    var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator());\n    return current;\n  };\n\n  ContentFocus.prototype.onClick = function (e, force) {\n    var target = e.target;\n    target = target.classList.contains('e-rowcell') ? target : closest(target, 'td');\n    target = target ? target : closest(e.target, 'td.e-detailrowcollapse') || closest(e.target, 'td.e-detailrowexpand');\n    target = closest(e.target, 'td.e-detailcell') ? isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n    target = target && closest(target, 'table').classList.contains('e-table') ? target : null;\n\n    if (!target) {\n      return false;\n    }\n\n    var _a = [target.parentElement.rowIndex, target.cellIndex],\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    var _b = this.matrix.current,\n        oRowIndex = _b[0],\n        oCellIndex = _b[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n\n    if (this.matrix.inValid(val) || !force && oRowIndex === rowIndex && oCellIndex === cellIndex) {\n      return false;\n    }\n\n    this.matrix.select(rowIndex, cellIndex);\n  };\n\n  ContentFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rowIndex = _b === void 0 ? 0 : _b,\n        _c = _a[1],\n        cellIndex = _c === void 0 ? 0 : _c;\n    this.matrix.current = [rowIndex, cellIndex];\n    info.element = !isNullOrUndefined(this.getTable().rows[rowIndex]) ? this.getTable().rows[rowIndex].cells[cellIndex] : null;\n\n    if (!info.element) {\n      return info;\n    }\n\n    info.elementToFocus = !info.element.classList.contains('e-unboundcell') && !info.element.classList.contains('e-detailcell') ? this.getFocusable(info.element) : info.element;\n    info.outline = true;\n    info.uid = info.element.parentElement.getAttribute('data-uid');\n    return info;\n  };\n\n  ContentFocus.prototype.getFocusable = function (element) {\n    var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n\n    if (this.parent.isEdit) {\n      query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea';\n    }\n\n    var child = [].slice.call(element.querySelectorAll(query));\n    /* Select the first focusable child element\n     * if no child found then select the cell itself.\n     * if Grid is in editable state, check for editable control inside child.\n     */\n\n    return child.length ? child[0] : element;\n  };\n\n  ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n    var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n    return (row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate) || row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible) || !row.isDataRow && types.indexOf(cell.cellType) > -1 || cell.column && cell.column.type === 'checkbox' || cell.cellType === CellType.CommandColumn || row.isDataRow && isRowTemplate) && !(row.edit === 'delete' && row.isDirty);\n  };\n\n  ContentFocus.prototype.jump = function (action, current) {\n    var frozenSwap = this.parent.frozenColumns > 0 && (action === 'leftArrow' || action === 'shiftTab') && current[1] === 0;\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n\n    if (action === 'tab' && !this.parent.isEdit && current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n      this.matrix.current[0] = this.matrix.current[0] + 1;\n      this.matrix.current[1] = -1;\n      frozenSwap = this.parent.frozenColumns > 0;\n    }\n\n    if (action === 'shiftTab' && !this.parent.isEdit && current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n      this.matrix.current[0] = this.matrix.current[0] - 1;\n      this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n    }\n\n    var isHeaderFocus = false;\n    var row = document.activeElement.parentElement;\n\n    if (this.parent.enableVirtualization && row.classList.contains('e-row')) {\n      var rowIndex = parseInt(row.getAttribute('aria-rowindex'), 10);\n      isHeaderFocus = rowIndex > 0;\n    }\n\n    var info = {\n      swap: !isHeaderFocus ? (action === 'upArrow' || enterFrozen) && current[0] === 0 || frozenSwap : false,\n      toHeader: (action === 'upArrow' || enterFrozen) && current[0] === 0,\n      toFrozen: frozenSwap\n    };\n    return info;\n  };\n\n  ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current = [];\n\n    if (action === 'rightArrow' || action === 'tab') {\n      current[0] = previous[0];\n      current[1] = -1;\n    } else if (action === 'downArrow' || action === 'enter') {\n      current[0] = -1;\n      current[1] = previous[1];\n    }\n\n    return current;\n  };\n\n  ContentFocus.prototype.generateRows = function (rows, optionals) {\n    var _a;\n\n    var matrix = optionals.matrix,\n        handlerInstance = optionals.handlerInstance;\n    var len = handlerInstance.matrix.matrix.length;\n    var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n    handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n\n    handlerInstance.matrix.rows = defaultLen;\n\n    (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n\n    handlerInstance.matrix.rows += matrix.length;\n  };\n\n  ContentFocus.prototype.getInfo = function (e) {\n    var info = this.getFocusInfo();\n    var _a = this.matrix.current,\n        rIndex = _a[0],\n        cIndex = _a[1];\n    var isData = info.element.classList.contains('e-rowcell');\n    var isSelectable = isData || e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse') || info.element.classList.contains('e-detailrowexpand'));\n    var _b = [Math.min(parseInt(info.element.parentElement.getAttribute('aria-rowindex'), 10), rIndex), Math.min(parseInt(info.element.getAttribute('aria-colindex'), 10), cIndex)],\n        rowIndex = _b[0],\n        cellIndex = _b[1];\n    return {\n      isContent: true,\n      isDataCell: isData,\n      indexes: [rowIndex, cellIndex],\n      isSelectable: isSelectable\n    };\n  };\n\n  ContentFocus.prototype.validator = function () {\n    var table = this.getTable();\n    return function (rowIndex, cellIndex, action) {\n      var cell;\n\n      if (table.rows[rowIndex].cells[0].classList.contains('e-editcell')) {\n        cell = table.rows[rowIndex].cells[0].querySelectorAll('td')[cellIndex];\n      } else {\n        cell = table.rows[rowIndex].cells[cellIndex];\n      }\n\n      var isCellWidth = cell.getBoundingClientRect().width !== 0;\n\n      if (action === 'enter' || action === 'shiftEnter') {\n        return isCellWidth && cell.classList.contains('e-rowcell');\n      }\n\n      if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains('e-rowcell')) {\n        return isCellWidth;\n      } else if (action !== 'shiftUp' && action !== 'shiftDown') {\n        return isCellWidth;\n      }\n\n      return false;\n    };\n  };\n\n  ContentFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rIndex = _b === void 0 ? -1 : _b,\n        _c = _a[1],\n        cIndex = _c === void 0 ? -1 : _c;\n\n    if (rIndex < 0 || cIndex < 0) {\n      return true;\n    }\n\n    var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n\n    if (!cell) {\n      return true;\n    }\n\n    return e.action === 'enter' || e.action === 'shiftEnter' ? cell.classList.contains('e-rowcell') && !cell.classList.contains('e-unboundcell') && !cell.classList.contains('e-templatecell') && !cell.classList.contains('e-detailcell') : true;\n  };\n\n  return ContentFocus;\n}();\n\nexport { ContentFocus };\n/**\n * @hidden\n */\n\nvar HeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(HeaderFocus, _super);\n\n  function HeaderFocus(parent) {\n    return _super.call(this, parent) || this;\n  }\n\n  HeaderFocus.prototype.getTable = function () {\n    return this.parent.getFrozenColumns() ? this.parent.getHeaderContent().querySelector('.e-movableheader .e-table') : this.parent.getHeaderTable();\n  };\n\n  HeaderFocus.prototype.onClick = function (e) {\n    var target = e.target;\n    target = target.classList.contains('e-headercell') ? target : closest(target, 'th');\n\n    if (!target && this.parent.frozenRows !== 0) {\n      target = e.target.classList.contains('e-rowcell') ? e.target : closest(e.target, 'td');\n    }\n\n    if (e.target.classList.contains('e-columnheader') || e.target.querySelector('.e-stackedheadercell')) {\n      return false;\n    }\n\n    if (!target) {\n      return;\n    }\n\n    var _a = [target.parentElement.rowIndex, target.cellIndex],\n        rowIndex = _a[0],\n        cellIndex = _a[1];\n    var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n\n    if (this.matrix.inValid(val)) {\n      return false;\n    }\n\n    this.matrix.select(target.parentElement.rowIndex, target.cellIndex);\n  };\n\n  HeaderFocus.prototype.getFocusInfo = function () {\n    var info = {};\n    var _a = this.matrix.current,\n        _b = _a[0],\n        rowIndex = _b === void 0 ? 0 : _b,\n        _c = _a[1],\n        cellIndex = _c === void 0 ? 0 : _c;\n    info.element = this.getTable().rows[rowIndex].cells[cellIndex];\n    info.elementToFocus = this.getFocusable(info.element);\n    info.outline = !info.element.classList.contains('e-filterbarcell');\n    return info;\n  };\n\n  HeaderFocus.prototype.selector = function (row, cell) {\n    return cell.visible && (cell.column.field !== undefined || cell.isTemplate) || cell.column.type === 'checkbox' || cell.cellType === CellType.StackedHeader;\n  };\n\n  HeaderFocus.prototype.jump = function (action, current) {\n    var frozenSwap = this.parent.frozenColumns > 0 && (action === 'leftArrow' || action === 'shiftTab') && current[1] === 0;\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    var isLastCell;\n    var lastRow;\n    var headerSwap = frozenSwap;\n\n    if (this.parent.enableHeaderFocus && action === 'tab') {\n      lastRow = this.matrix.matrix.length - 1 === current[0];\n      isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n\n      if (isLastCell) {\n        if (!lastRow) {\n          this.matrix.current[0] = this.matrix.current[0] + 1;\n        } else {\n          this.matrix.current[0] = 0;\n        }\n\n        this.matrix.current[1] = -1;\n      }\n\n      if (this.parent.frozenColumns > 0 && lastRow && isLastCell) {\n        frozenSwap = true;\n        headerSwap = false;\n      }\n    }\n\n    return {\n      swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || frozenSwap || action === 'tab' && lastRow && isLastCell,\n      toHeader: headerSwap,\n      toFrozen: frozenSwap\n    };\n  };\n\n  HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current1 = [];\n\n    if (action === 'upArrow' || action === 'shiftEnter') {\n      current1[0] = this.matrix.matrix.length;\n      current1[1] = previous[1];\n    } else if (action === 'rightArrow' || action === 'tab') {\n      current1[0] = previous[0];\n      current1[1] = -1;\n    }\n\n    return current1;\n  };\n\n  HeaderFocus.prototype.generateRows = function (rows) {\n    var _this = this;\n\n    var length = this.matrix.matrix.length;\n\n    if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n      this.matrix.rows = ++this.matrix.rows;\n      rows[0].cells.forEach(function (cell, cIndex) {\n        return _this.matrix.set(length, cIndex, cell.visible && cell.column.allowFiltering !== false);\n      });\n    }\n  };\n\n  HeaderFocus.prototype.getInfo = function (e) {\n    return extend(_super.prototype.getInfo.call(this, e), {\n      isContent: false,\n      isHeader: true\n    });\n  };\n\n  HeaderFocus.prototype.validator = function () {\n    return function () {\n      return true;\n    };\n  };\n\n  HeaderFocus.prototype.shouldFocusChange = function (e) {\n    var _a = this.matrix.current,\n        rowIndex = _a[0],\n        columnIndex = _a[1];\n\n    if (rowIndex < 0 || columnIndex < 0) {\n      return true;\n    }\n\n    var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n\n    if (!cell) {\n      return true;\n    }\n\n    return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n  };\n\n  return HeaderFocus;\n}(ContentFocus);\n\nexport { HeaderFocus };\n\nvar FixedContentFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedContentFocus, _super);\n\n  function FixedContentFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedContentFocus.prototype.getTable = function () {\n    return this.parent.getContent().querySelector('.e-frozencontent .e-table');\n  };\n\n  FixedContentFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n    return {\n      swap: (action === 'upArrow' || enterFrozen) && current[0] === 0 || (action === 'tab' || action === 'rightArrow') && current[1] === this.matrix.columns,\n      toHeader: (action === 'upArrow' || enterFrozen) && current[0] === 0,\n      toFrozen: (action === 'upArrow' || enterFrozen) && current[0] === 0\n    };\n  };\n\n  FixedContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current2 = [];\n\n    if (action === 'tab' && this.parent.enableHeaderFocus) {\n      current2[0] = previous[0];\n      current2[1] = -1;\n    }\n\n    if (action === 'leftArrow' || action === 'shiftTab') {\n      current2[0] = previous[0];\n      current2[1] = active.matrix.columns + 1;\n    } else if (action === 'downArrow' || action === 'enter') {\n      current2[0] = -1;\n      current2[1] = previous[1];\n    }\n\n    return current2;\n  };\n\n  return FixedContentFocus;\n}(ContentFocus);\n\nexport { FixedContentFocus };\n\nvar FixedHeaderFocus =\n/** @class */\nfunction (_super) {\n  __extends(FixedHeaderFocus, _super);\n\n  function FixedHeaderFocus() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  FixedHeaderFocus.prototype.jump = function (action, current) {\n    var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n    return {\n      swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1 || (action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns,\n      toHeader: (action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns,\n      toFrozen: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1\n    };\n  };\n\n  FixedHeaderFocus.prototype.getTable = function () {\n    return this.parent.getHeaderContent().querySelector('.e-frozenheader .e-table');\n  };\n\n  FixedHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n    if (previous === void 0) {\n      previous = [];\n    }\n\n    var current3 = [];\n\n    if (action === 'leftArrow' || action === 'shiftTab') {\n      current3[0] = previous[0];\n      current3[1] = active.matrix.columns + 1;\n    } else if (action === 'upArrow' || action === 'shiftEnter') {\n      current3[0] = this.matrix.matrix.length;\n      current3[1] = previous[1];\n    }\n\n    return current3;\n  };\n\n  return FixedHeaderFocus;\n}(HeaderFocus);\n\nexport { FixedHeaderFocus };\n/** @hidden */\n\nvar SearchBox =\n/** @class */\nfunction () {\n  function SearchBox(searchBox) {\n    this.searchBox = searchBox;\n  }\n\n  SearchBox.prototype.searchFocus = function (args) {\n    args.target.parentElement.classList.add('e-input-focus');\n  };\n\n  SearchBox.prototype.searchBlur = function (args) {\n    args.target.parentElement.classList.remove('e-input-focus');\n  };\n\n  SearchBox.prototype.wireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n      EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n    }\n  };\n\n  SearchBox.prototype.unWireEvent = function () {\n    if (this.searchBox) {\n      EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n      EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n    }\n  };\n\n  return SearchBox;\n}();\n\nexport { SearchBox };","map":{"version":3,"sources":["C:/CN2/workspace-trunk/kain-front-end/node_modules/@syncfusion/ej2-grids/src/grid/services/focus-strategy.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","EventHandler","getValue","closest","isNullOrUndefined","addClass","removeClass","extend","Browser","CellType","event","Row","RowModelGenerator","FocusStrategy","parent","currentInfo","oneTime","swap","forget","skipFocus","focusByClick","prevIndexes","refMatrix","refreshMatrix","rowModelGen","addEventListener","focusCheck","e","target","classList","contains","onFocus","isDestroyed","isDevice","enableVirtualization","setActive","enableHeaderFocus","frozenRows","frozenColumns","getCurrentViewRecords","length","getContent","matrix","generate","generateRows","rows","isDataRow","selector","current","get","validator","select","focus","passiveFocus","skipAction","element","onBlur","isEdit","relatedTarget","removeFocus","getFocusInfo","elementToFocus","tabIndex","onClick","force","isContent","isHeader","isFrozen","clearOutline","beforeArgs","cancel","byKey","byClick","clickArgs","notify","beforeCellFocused","returnVal","onKeyPress","skipOn","keyArgs","bValue","outline","swapInfo","jump","action","toHeader","toFrozen","getNextCurrent","active","setActiveByKey","clearIndicator","preventDefault","indexOf","th","document","activeElement","filterCell","lastIndexOf","editSettings","mode","id","getFocusedElement","content","fContent","fHeader","header","setFocusedElement","_this","setTimeout","virtaulCellFocus","addFocus","addOutline","info","focusHeader","resetFocus","focusContent","isFocused","cellFocused","indexes","isJump","container","getInfo","_a","rowIndex","cellIndex","focusedColumnUid","getColumnByIndex","uid","args","FixedContentFocus","ContentFocus","FixedHeaderFocus","HeaderFocus","cFocus","slice","updateRow","isRowTemplate","rowTemplate","frozenColumnsCount","getFrozenColumns","name","newMovableRows","map","row","clone","newFrozenRows","i","cells","handlerInstance","requestType","index_1","bool","some","getColumnIndexByUid","focusElement","cellPosition","getBoundingClientRect","gridPosition","top","left","right","Math","min","window","innerWidth","documentElement","clientWidth","bottom","innerHeight","clientHeight","querySelector","add","passiveHandler","on","keyPressed","click","contentReady","partialRefresh","headerRefreshed","restoreFocus","forEach","evt","restoreFocusWithAction","batchAdd","batchCancel","batchDelete","detailDataBound","onEmpty","internalCellFocus","removeEventListener","remove","off","destroy","groupSettings","showGroupedColumn","getPrevIndexes","forgetPrevious","actions","focusEle","getFocusable","Matrix","set","columnIndex","allow","max","columns","navigator","tmp","first","val","inValid","vector","index","moveTo","v","rIndex","filter","c","isSpanned","cell","cIndex","value","undefined","keyActions","indexesByKey","opt","getTable","getContentTable","getCurrentFromAction","toString","editNextRow","gObj","allowNextRowEdit","isLastCellPrimaryKey","visibleIndex","getColumnIndexByField","getVisibleColumns","field","querySelectorAll","isPresent","shouldFocusChange","concat","rN","cN","parentElement","_b","oRowIndex","oCellIndex","_c","getAttribute","query","child","call","types","Expand","GroupCaption","CaptionSummary","GroupSummary","visible","isDataCell","isTemplate","cellType","DetailExpand","column","type","CommandColumn","edit","isDirty","frozenSwap","enterFrozen","isHeaderFocus","parseInt","previous","optionals","len","defaultLen","allowFiltering","filterSettings","push","apply","isData","isSelectable","table","isCellWidth","width","_super","getHeaderContent","getHeaderTable","StackedHeader","isLastCell","lastRow","headerSwap","current1","arguments","current2","current3","SearchBox","searchBox","searchFocus","searchBlur","wireEvent","unWireEvent"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { EventHandler, getValue, closest, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, extend, Browser } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport * as event from '../base/constant';\nimport { Row } from '../models/row';\nimport { RowModelGenerator } from './row-model-generator';\n/**\n * FocusStrategy class\n * @hidden\n */\nvar FocusStrategy = /** @class */ (function () {\n    function FocusStrategy(parent) {\n        this.currentInfo = {};\n        this.oneTime = true;\n        this.swap = {};\n        this.forget = true;\n        this.skipFocus = true;\n        this.focusByClick = false;\n        this.prevIndexes = {};\n        this.refMatrix = this.refreshMatrix(true);\n        this.parent = parent;\n        this.rowModelGen = new RowModelGenerator(this.parent);\n        this.addEventListener();\n    }\n    FocusStrategy.prototype.focusCheck = function (e) {\n        var target = e.target;\n        this.focusByClick = true;\n        this.skipFocus = target.classList.contains('e-grid');\n    };\n    FocusStrategy.prototype.onFocus = function () {\n        if (this.parent.isDestroyed || Browser.isDevice || this.parent.enableVirtualization) {\n            return;\n        }\n        this.setActive(!this.parent.enableHeaderFocus && this.parent.frozenRows === 0, this.parent.frozenColumns !== 0);\n        if (!this.parent.enableHeaderFocus && !this.parent.getCurrentViewRecords().length) {\n            this.getContent().matrix.\n                generate(this.rowModelGen.generateRows({ rows: [new Row({ isDataRow: true })] }), this.getContent().selector, false);\n        }\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        if (this.skipFocus) {\n            this.focus();\n            this.skipFocus = false;\n        }\n    };\n    FocusStrategy.prototype.passiveFocus = function (e) {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (e.target && e.target.classList.contains('e-detailcell')) {\n            this.currentInfo.skipAction = false;\n            addClass([this.currentInfo.element], ['e-focused', 'e-focus']);\n        }\n    };\n    FocusStrategy.prototype.onBlur = function (e) {\n        if ((this.parent.isEdit || e && (!e.relatedTarget || closest(e.relatedTarget, '.e-grid')))) {\n            return;\n        }\n        this.removeFocus();\n        this.skipFocus = false;\n        this.currentInfo.skipAction = false;\n        if (this.getContent().getFocusInfo().elementToFocus) {\n            this.getContent().getFocusInfo().elementToFocus.tabIndex = 0;\n        }\n    };\n    FocusStrategy.prototype.onClick = function (e, force) {\n        var isContent = !isNullOrUndefined(closest(e.target, '.e-gridcontent'));\n        var isHeader = !isNullOrUndefined(closest(e.target, '.e-gridheader'));\n        isContent = isContent && isHeader ? !isContent : isContent;\n        var isFrozen = !isNullOrUndefined(closest(e.target, '.e-frozencontent')) ||\n            !isNullOrUndefined(closest(e.target, '.e-frozenheader'));\n        if (!isContent && isNullOrUndefined(closest(e.target, '.e-gridheader')) ||\n            e.target.classList.contains('e-content') ||\n            !isNullOrUndefined(closest(e.target, '.e-unboundcell'))) {\n            return;\n        }\n        this.setActive(isContent, isFrozen);\n        if (!isContent && isNullOrUndefined(closest(e.target, '.e-gridheader')) ||\n            e.target.classList.contains('e-filtermenudiv')) {\n            this.clearOutline();\n            return;\n        }\n        var beforeArgs = { cancel: false, byKey: false, byClick: !isNullOrUndefined(e.target), clickArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel || closest(e.target, '.e-inline-edit')) {\n            return;\n        }\n        this.setActive(isContent, isFrozen);\n        if (this.getContent()) {\n            var returnVal = this.getContent().onClick(e, force);\n            if (returnVal === false) {\n                return;\n            }\n            this.focus();\n        }\n    };\n    FocusStrategy.prototype.onKeyPress = function (e) {\n        if (this.skipOn(e)) {\n            return;\n        }\n        var beforeArgs = { cancel: false, byKey: true, byClick: false, keyArgs: e };\n        this.parent.notify(event.beforeCellFocused, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        var bValue = this.getContent().matrix.current;\n        this.currentInfo.outline = true;\n        var swapInfo = this.getContent().jump(e.action, bValue);\n        this.swap = swapInfo;\n        if (swapInfo.swap) {\n            this.setActive(!swapInfo.toHeader, swapInfo.toFrozen);\n            this.getContent().matrix.current = this.getContent().getNextCurrent(bValue, swapInfo, this.active, e.action);\n            this.prevIndexes = {};\n        }\n        this.setActiveByKey(e.action, this.getContent());\n        var returnVal = this.getContent().onKeyPress(e);\n        if (returnVal === false) {\n            this.clearIndicator();\n            return;\n        }\n        e.preventDefault();\n        this.focus(e);\n    };\n    FocusStrategy.prototype.skipOn = function (e) {\n        var target = e.target;\n        if (!target) {\n            return false;\n        }\n        if (this.currentInfo.skipAction) {\n            this.clearIndicator();\n            return true;\n        }\n        if (['pageUp', 'pageDown', 'altDownArrow'].indexOf(e.action) > -1) {\n            this.clearIndicator();\n            return true;\n        }\n        var th = closest(target, 'th') && !closest(target, 'th').tabIndex;\n        if (th && closest(document.activeElement, '.e-filterbarcell') !== null) {\n            this.removeFocus();\n        }\n        var filterCell = closest(document.activeElement, '.e-filterbarcell') !== null;\n        if (this.parent.enableHeaderFocus && filterCell) {\n            var matrix = this.active.matrix;\n            var current = matrix.current;\n            filterCell = matrix.matrix[current[0]].lastIndexOf(1) !== current[1];\n        }\n        return (e.action === 'delete'\n            || (this.parent.editSettings.mode !== 'Batch' && (this.parent.isEdit || ['insert', 'f2'].indexOf(e.action) > -1))\n            || (filterCell ||\n                closest(document.activeElement, '#' + this.parent.element.id + '_searchbar') !== null\n                    && ['enter', 'leftArrow', 'rightArrow',\n                        'shiftLeft', 'shiftRight', 'ctrlPlusA'].indexOf(e.action) > -1)\n            || (closest(target, '.e-gridcontent') === null && closest(target, '.e-gridheader') === null)\n            || (e.action === 'space' && (!target.classList.contains('e-gridchkbox') && closest(target, '.e-gridchkbox') === null\n                && closest(target, '.e-headerchkcelldiv') === null))) || closest(target, '.e-filter-popup') !== null;\n    };\n    FocusStrategy.prototype.getFocusedElement = function () {\n        return this.currentInfo.elementToFocus;\n    };\n    FocusStrategy.prototype.getContent = function () {\n        return this.active || this.content;\n    };\n    FocusStrategy.prototype.setActive = function (content, isFrozen) {\n        this.active = content ? isFrozen ? this.fContent : this.content :\n            isFrozen ? this.fHeader : this.header;\n    };\n    FocusStrategy.prototype.setFocusedElement = function (element, e) {\n        var _this = this;\n        this.currentInfo.elementToFocus = element;\n        setTimeout(function () {\n            if (!isNullOrUndefined(_this.currentInfo.elementToFocus)) {\n                _this.parent.notify('virtaul-key-handler', e);\n                _this.currentInfo.elementToFocus.focus();\n            }\n        }, 0);\n    };\n    FocusStrategy.prototype.focus = function (e) {\n        this.parent.notify(event.virtaulCellFocus, e);\n        this.removeFocus();\n        this.addFocus(this.getContent().getFocusInfo(), e);\n    };\n    FocusStrategy.prototype.removeFocus = function (e) {\n        if (!this.currentInfo.element) {\n            return;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focused', 'e-focus']);\n        this.currentInfo.element.tabIndex = -1;\n    };\n    /** @hidden */\n    FocusStrategy.prototype.addOutline = function () {\n        var info = this.getContent().getFocusInfo();\n        if (info.element) {\n            addClass([info.element], ['e-focused']);\n            addClass([info.elementToFocus], ['e-focus']);\n        }\n    };\n    /** @hidden */\n    FocusStrategy.prototype.focusHeader = function () {\n        this.setActive(false, this.parent.frozenColumns !== 0);\n        this.resetFocus();\n    };\n    /** @hidden */\n    FocusStrategy.prototype.focusContent = function () {\n        this.setActive(true, this.parent.frozenColumns !== 0);\n        this.resetFocus();\n    };\n    FocusStrategy.prototype.resetFocus = function () {\n        var current = this.getContent().matrix.get(0, -1, [0, 1], null, this.getContent().validator());\n        this.getContent().matrix.select(current[0], current[1]);\n        this.focus();\n    };\n    FocusStrategy.prototype.addFocus = function (info, e) {\n        this.currentInfo = info;\n        this.currentInfo.outline = info.outline && !isNullOrUndefined(e);\n        if (!info.element) {\n            return;\n        }\n        var isFocused = info.elementToFocus.classList.contains('e-focus');\n        if (isFocused) {\n            return;\n        }\n        if (this.currentInfo.outline) {\n            addClass([info.element], ['e-focused']);\n        }\n        addClass([info.elementToFocus], ['e-focus']);\n        info.element.tabIndex = 0;\n        if (!isFocused) {\n            this.setFocusedElement(info.elementToFocus, e);\n        }\n        this.parent.notify(event.cellFocused, {\n            element: info.elementToFocus,\n            parent: info.element,\n            indexes: this.getContent().matrix.current,\n            byKey: !isNullOrUndefined(e),\n            byClick: isNullOrUndefined(e),\n            keyArgs: e,\n            isJump: this.swap.swap,\n            container: this.getContent().getInfo(e),\n            outline: !isNullOrUndefined(e),\n            swapInfo: this.swap\n        });\n        var _a = this.getContent().matrix.current, rowIndex = _a[0], cellIndex = _a[1];\n        this.prevIndexes = { rowIndex: rowIndex, cellIndex: cellIndex };\n        this.focusedColumnUid = this.parent.getColumnByIndex(cellIndex).uid;\n        this.focusByClick = false;\n    };\n    FocusStrategy.prototype.refreshMatrix = function (content) {\n        var _this = this;\n        return function (e) {\n            if (content && (e.args && e.args.isFrozen) && !_this.fContent) {\n                _this.fContent = new FixedContentFocus(_this.parent);\n            }\n            else if (content && !_this.content) {\n                _this.content = new ContentFocus(_this.parent);\n            }\n            if (!content && (e.args && e.args.isFrozen) && !_this.fHeader) {\n                _this.fHeader = new FixedHeaderFocus(_this.parent);\n            }\n            else if (!content && !_this.header) {\n                _this.header = new HeaderFocus(_this.parent);\n            }\n            var cFocus = content ? (e.args && e.args.isFrozen) ? _this.fContent : _this.content :\n                (e.args && e.args.isFrozen) ? _this.fHeader : _this.header;\n            var rows = content ? e.rows.slice(_this.parent.frozenRows) : e.rows;\n            var updateRow = content ? e.rows.slice(0, _this.parent.frozenRows) : e.rows;\n            var isRowTemplate = !isNullOrUndefined(_this.parent.rowTemplate);\n            var matrix = cFocus.matrix.generate(updateRow, cFocus.selector, isRowTemplate);\n            var frozenColumnsCount = _this.parent.getFrozenColumns();\n            if (e.name === 'batchAdd' && frozenColumnsCount) {\n                var newMovableRows = rows.map(function (row) { return row.clone(); });\n                var newFrozenRows = rows.map(function (row) { return row.clone(); });\n                for (var i = 0; i < rows.length; i++) {\n                    if (rows[i].cells.length > frozenColumnsCount) {\n                        newFrozenRows[i].cells = rows[i].cells.slice(0, frozenColumnsCount);\n                        newMovableRows[i].cells = rows[i].cells.slice(frozenColumnsCount);\n                    }\n                }\n                _this.fContent.matrix.generate(newFrozenRows, _this.fContent.selector, isRowTemplate);\n                cFocus.matrix.generate(newMovableRows, cFocus.selector, isRowTemplate);\n            }\n            else {\n                cFocus.matrix.generate(rows, cFocus.selector, isRowTemplate);\n            }\n            cFocus.generateRows(updateRow, { matrix: matrix, handlerInstance: (e.args && e.args.isFrozen) ? _this.fHeader : _this.header });\n            if (!Browser.isDevice && e && e.args) {\n                if (!_this.focusByClick && e.args.requestType === 'paging') {\n                    _this.skipFocus = false;\n                    _this.parent.element.focus();\n                }\n                if (e.args.requestType === 'grouping') {\n                    _this.skipFocus = true;\n                }\n            }\n            if (e && e.args && e.args.requestType === 'virtualscroll') {\n                if (_this.currentInfo.uid) {\n                    var index_1;\n                    var bool = e.rows.some(function (row, i) {\n                        index_1 = i;\n                        return row.uid === _this.currentInfo.uid;\n                    });\n                    if (bool) {\n                        _this.content.matrix.current[0] = index_1;\n                        _this.content.matrix.current[1] = _this.parent.getColumnIndexByUid(_this.focusedColumnUid) || 0;\n                        var focusElement = _this.getContent().getFocusInfo().elementToFocus;\n                        if (focusElement) {\n                            var cellPosition = focusElement.getBoundingClientRect();\n                            var gridPosition = _this.parent.element.getBoundingClientRect();\n                            if (cellPosition.top >= 0 && cellPosition.left >= 0 &&\n                                cellPosition.right <= Math.min(gridPosition.right, window.innerWidth ||\n                                    document.documentElement.clientWidth) &&\n                                cellPosition.bottom <= Math.min(gridPosition.bottom, window.innerHeight ||\n                                    document.documentElement.clientHeight)) {\n                                _this.focus();\n                            }\n                        }\n                    }\n                }\n                else if (e.args.focusElement && e.args.focusElement.classList.contains('e-filtertext')) {\n                    var focusElement = _this.parent.element.querySelector('#' + e.args.focusElement.id);\n                    if (focusElement) {\n                        focusElement.focus();\n                    }\n                }\n            }\n        };\n    };\n    FocusStrategy.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.add(this.parent.element, 'mousedown', this.focusCheck, this);\n        EventHandler.add(this.parent.element, 'focus', this.onFocus, this);\n        this.parent.element.addEventListener('focus', this.passiveHandler = function (e) { return _this.passiveFocus(e); }, true);\n        EventHandler.add(this.parent.element, 'focusout', this.onBlur, this);\n        this.parent.on(event.keyPressed, this.onKeyPress, this);\n        this.parent.on(event.click, this.onClick, this);\n        this.parent.on(event.contentReady, this.refMatrix, this);\n        this.parent.on(event.partialRefresh, this.refMatrix, this);\n        this.parent.on(event.headerRefreshed, this.refreshMatrix(), this);\n        this.parent.on('close-edit', this.restoreFocus, this);\n        this.parent.on('restore-Focus', this.restoreFocus, this);\n        ['start-edit', 'start-add'].forEach(function (evt) { return _this.parent.on(evt, _this.clearIndicator, _this); });\n        ['sorting', 'filtering'].forEach(function (action) { return _this.parent.on(action + \"-complete\", _this.restoreFocus, _this); });\n        ['grouping', 'ungrouping'].forEach(function (action) { return _this.parent.on(action + \"-complete\", _this.restoreFocusWithAction, _this); });\n        this.parent.on(event.batchAdd, this.refMatrix, this);\n        this.parent.on(event.batchCancel, this.refMatrix, this);\n        this.parent.on(event.batchDelete, this.refMatrix, this);\n        this.parent.on(event.detailDataBound, this.refMatrix, this);\n        this.parent.on(event.onEmpty, this.refMatrix, this);\n        this.parent.on(event.cellFocused, this.internalCellFocus, this);\n    };\n    FocusStrategy.prototype.removeEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(this.parent.element, 'mousedown', this.focusCheck);\n        EventHandler.remove(this.parent.element, 'focus', this.onFocus);\n        EventHandler.remove(this.parent.element, 'focusout', this.onBlur);\n        this.parent.element.removeEventListener('focus', this.passiveHandler, true);\n        this.parent.off(event.keyPressed, this.onKeyPress);\n        this.parent.off(event.click, this.onClick);\n        this.parent.off(event.contentReady, this.refMatrix);\n        this.parent.off(event.partialRefresh, this.refMatrix);\n        this.parent.off(event.headerRefreshed, this.refreshMatrix());\n        this.parent.off('close-edit', this.restoreFocus);\n        this.parent.off('restore-focus', this.restoreFocus);\n        ['start-edit', 'start-add'].forEach(function (evt) { return _this.parent.off(evt, _this.clearOutline); });\n        ['sorting', 'filtering'].forEach(function (action) { return _this.parent.off(action + \"-complete\", _this.restoreFocus); });\n        ['grouping', 'ungrouping'].forEach(function (action) { return _this.parent.on(action + \"-complete\", _this.restoreFocusWithAction); });\n        this.parent.off(event.batchAdd, this.refMatrix);\n        this.parent.off(event.batchDelete, this.refMatrix);\n        this.parent.off(event.batchCancel, this.refMatrix);\n        this.parent.off(event.detailDataBound, this.refMatrix);\n        this.parent.off(event.onEmpty, this.refMatrix);\n        this.parent.off(event.cellFocused, this.internalCellFocus);\n    };\n    FocusStrategy.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    FocusStrategy.prototype.restoreFocus = function () {\n        this.addFocus(this.getContent().getFocusInfo());\n    };\n    FocusStrategy.prototype.restoreFocusWithAction = function (e) {\n        var matrix = this.getContent().matrix;\n        var current = matrix.current;\n        switch (e.requestType) {\n            case 'grouping':\n            case 'ungrouping':\n                current[1] = current.length &&\n                    !this.parent.groupSettings.showGroupedColumn ?\n                    matrix.matrix[current[0]].indexOf(1) : e.requestType === 'grouping' ? current[1] + 1 : current[1] - 1;\n                break;\n        }\n        this.getContent().matrix.current = current;\n        this.addFocus(this.getContent().getFocusInfo());\n    };\n    FocusStrategy.prototype.clearOutline = function () {\n        this.getContent().matrix.current = this.getContent().matrix.get(0, -1, [0, 1], 'downArrow', this.getContent().validator());\n        this.clearIndicator();\n    };\n    FocusStrategy.prototype.clearIndicator = function () {\n        if (!this.currentInfo.element || !this.currentInfo.elementToFocus) {\n            return;\n        }\n        removeClass([this.currentInfo.element, this.currentInfo.elementToFocus], ['e-focus', 'e-focused']);\n    };\n    FocusStrategy.prototype.getPrevIndexes = function () {\n        var forget = this.forget;\n        this.forget = false;\n        return forget ? { rowIndex: null, cellIndex: null } : this.prevIndexes;\n    };\n    FocusStrategy.prototype.forgetPrevious = function () {\n        this.forget = true;\n    };\n    FocusStrategy.prototype.setActiveByKey = function (action, active) {\n        var _this = this;\n        if (this.parent.frozenColumns === 0 && this.parent.frozenRows === 0) {\n            return;\n        }\n        var info;\n        var actions = {\n            'home': function () { return ({ toHeader: !info.isContent, toFrozen: true }); },\n            'end': function () { return ({ toHeader: !info.isContent, toFrozen: false }); },\n            'ctrlHome': function () { return ({ toHeader: true, toFrozen: _this.parent.frozenColumns !== 0 }); },\n            'ctrlEnd': function () { return ({ toHeader: false, toFrozen: false }); }\n        };\n        if (!(action in actions)) {\n            return;\n        }\n        info = active.getInfo();\n        var swap = actions[action]();\n        this.setActive(!swap.toHeader, swap.toFrozen);\n        this.getContent().matrix.current = active.matrix.current;\n    };\n    FocusStrategy.prototype.internalCellFocus = function (e) {\n        if (!(e.byKey && e.container.isContent && e.keyArgs.action === 'enter'\n            && (e.parent.classList.contains('e-detailcell') ||\n                e.parent.classList.contains('e-unboundcell') || e.parent.classList.contains('e-templatecell')))) {\n            return;\n        }\n        this.clearIndicator();\n        var focusEle = this.getContent().getFocusable(this.getFocusedElement());\n        this.setFocusedElement(focusEle);\n        this.currentInfo.skipAction = true;\n    };\n    return FocusStrategy;\n}());\nexport { FocusStrategy };\n/**\n * Create matrix from row collection which act as mental model for cell navigation\n * @hidden\n */\nvar Matrix = /** @class */ (function () {\n    function Matrix() {\n        this.matrix = [];\n        this.current = [];\n    }\n    Matrix.prototype.set = function (rowIndex, columnIndex, allow) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.columns));\n        this.matrix[rowIndex] = this.matrix[rowIndex] || [];\n        this.matrix[rowIndex][columnIndex] = allow ? 1 : 0;\n    };\n    Matrix.prototype.get = function (rowIndex, columnIndex, navigator, action, validator) {\n        var tmp = columnIndex;\n        if (rowIndex + navigator[0] < 0) {\n            return [rowIndex, columnIndex];\n        }\n        rowIndex = Math.max(0, Math.min(rowIndex + navigator[0], this.rows));\n        if (isNullOrUndefined(this.matrix[rowIndex])) {\n            return null;\n        }\n        columnIndex = Math.max(0, Math.min(columnIndex + navigator[1], this.matrix[rowIndex].length - 1));\n        if (tmp + navigator[1] > this.matrix[rowIndex].length - 1 && validator(rowIndex, columnIndex, action)) {\n            return [rowIndex, tmp];\n        }\n        var first = this.first(this.matrix[rowIndex], columnIndex, navigator, true, action);\n        columnIndex = first === null ? tmp : first;\n        var val = getValue(rowIndex + \".\" + columnIndex, this.matrix);\n        if (rowIndex === this.rows && (action === 'downArrow' || action === 'enter')) {\n            navigator[0] = -1;\n        }\n        return this.inValid(val) || !validator(rowIndex, columnIndex, action) ?\n            this.get(rowIndex, tmp, navigator, action, validator) : [rowIndex, columnIndex];\n    };\n    Matrix.prototype.first = function (vector, index, navigator, moveTo, action) {\n        if (((index < 0 || index === vector.length) && this.inValid(vector[index])\n            && (action !== 'upArrow' && action !== 'downArrow')) || !vector.some(function (v) { return v === 1; })) {\n            return null;\n        }\n        return !this.inValid(vector[index]) ? index :\n            this.first(vector, (['upArrow', 'downArrow', 'shiftUp', 'shiftDown'].indexOf(action) !== -1) ? moveTo ? 0 : ++index : index + navigator[1], navigator, false, action);\n    };\n    Matrix.prototype.select = function (rowIndex, columnIndex) {\n        rowIndex = Math.max(0, Math.min(rowIndex, this.rows));\n        columnIndex = Math.max(0, Math.min(columnIndex, this.matrix[rowIndex].length - 1));\n        this.current = [rowIndex, columnIndex];\n    };\n    Matrix.prototype.generate = function (rows, selector, isRowTemplate) {\n        var _this = this;\n        this.rows = rows.length - 1;\n        this.matrix = [];\n        rows.forEach(function (row, rIndex) {\n            var cells = row.cells.filter(function (c) { return c.isSpanned !== true; });\n            _this.columns = Math.max(cells.length - 1, _this.columns | 0);\n            cells.forEach(function (cell, cIndex) {\n                _this.set(rIndex, cIndex, selector(row, cell, isRowTemplate));\n            });\n        });\n        return this.matrix;\n    };\n    Matrix.prototype.inValid = function (value) {\n        return value === 0 || value === undefined;\n    };\n    return Matrix;\n}());\nexport { Matrix };\n/**\n * @hidden\n */\nvar ContentFocus = /** @class */ (function () {\n    function ContentFocus(parent) {\n        var _this = this;\n        this.matrix = new Matrix();\n        this.parent = parent;\n        this.keyActions = {\n            'rightArrow': [0, 1],\n            'tab': [0, 1],\n            'leftArrow': [0, -1],\n            'shiftTab': [0, -1],\n            'upArrow': [-1, 0],\n            'downArrow': [1, 0],\n            'shiftUp': [-1, 0],\n            'shiftDown': [1, 0],\n            'shiftRight': [0, 1],\n            'shiftLeft': [0, -1],\n            'enter': [1, 0],\n            'shiftEnter': [-1, 0]\n        };\n        this.indexesByKey = function (action) {\n            var opt = {\n                'home': [_this.matrix.current[0], -1, 0, 1],\n                'end': [_this.matrix.current[0], _this.matrix.columns + 1, 0, -1],\n                'ctrlHome': [0, -1, 0, 1],\n                'ctrlEnd': [_this.matrix.rows, _this.matrix.columns + 1, 0, -1]\n            };\n            return opt[action] || null;\n        };\n    }\n    ContentFocus.prototype.getTable = function () {\n        return (this.parent.frozenColumns ?\n            this.parent.getContent().querySelector('.e-movablecontent .e-table') :\n            this.parent.getContentTable());\n    };\n    ContentFocus.prototype.onKeyPress = function (e) {\n        var navigator = this.keyActions[e.action];\n        var current = this.getCurrentFromAction(e.action, navigator, e.action in this.keyActions, e);\n        if (!current) {\n            return;\n        }\n        if ((['tab', 'shiftTab'].indexOf(e.action) > -1 && this.matrix.current || []).toString() === current.toString()) {\n            if (current.toString() === [this.matrix.rows, this.matrix.columns].toString() ||\n                current.toString() === [0, 0].toString() || (this.matrix.current[0] === this.matrix.rows &&\n                this.matrix.current.toString() === current.toString())) {\n                return false;\n            }\n            else {\n                current = this.editNextRow(current[0], current[1], e.action);\n            }\n        }\n        this.matrix.select(current[0], current[1]);\n    };\n    ContentFocus.prototype.editNextRow = function (rowIndex, cellIndex, action) {\n        var gObj = this.parent;\n        var editNextRow = gObj.editSettings.allowNextRowEdit && (gObj.isEdit || gObj.isLastCellPrimaryKey);\n        var visibleIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[0].field);\n        var cell = this.getTable().rows[rowIndex].cells[cellIndex];\n        if (action === 'tab' && editNextRow) {\n            rowIndex++;\n            var index = (this.getTable().rows[rowIndex].querySelectorAll('.e-indentcell').length +\n                this.getTable().rows[rowIndex].querySelectorAll('.e-detailrowcollapse').length);\n            cellIndex = visibleIndex + index;\n        }\n        if (action === 'shiftTab' && editNextRow) {\n            rowIndex--;\n            cellIndex = gObj.getColumnIndexByField(gObj.getVisibleColumns()[gObj.getVisibleColumns().length - 1].field);\n        }\n        return !cell.classList.contains('e-rowcell') && !cell.classList.contains('e-headercell') &&\n            !cell.classList.contains('e-groupcaption') ?\n            this.editNextRow(rowIndex, cellIndex, action) : [rowIndex, cellIndex];\n    };\n    ContentFocus.prototype.getCurrentFromAction = function (action, navigator, isPresent, e) {\n        if (navigator === void 0) { navigator = [0, 0]; }\n        if (!isPresent && !this.indexesByKey(action) || (this.matrix.current.length === 0)) {\n            return null;\n        }\n        if (!this.shouldFocusChange(e)) {\n            return this.matrix.current;\n        }\n        var _a = this.indexesByKey(action) || this.matrix.current.concat(navigator), rowIndex = _a[0], cellIndex = _a[1], rN = _a[2], cN = _a[3];\n        var current = this.matrix.get(rowIndex, cellIndex, [rN, cN], action, this.validator());\n        return current;\n    };\n    ContentFocus.prototype.onClick = function (e, force) {\n        var target = e.target;\n        target = (target.classList.contains('e-rowcell') ? target : closest(target, 'td'));\n        target = target ? target : closest(e.target, 'td.e-detailrowcollapse')\n            || closest(e.target, 'td.e-detailrowexpand');\n        target = closest(e.target, 'td.e-detailcell') ?\n            isNullOrUndefined(closest(closest(e.target, '.e-grid'), 'td.e-detailcell')) ? null : target : target;\n        target = target && closest(target, 'table').classList.contains('e-table') ? target : null;\n        if (!target) {\n            return false;\n        }\n        var _a = [target.parentElement.rowIndex, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var _b = this.matrix.current, oRowIndex = _b[0], oCellIndex = _b[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val) || (!force && oRowIndex === rowIndex && oCellIndex === cellIndex)) {\n            return false;\n        }\n        this.matrix.select(rowIndex, cellIndex);\n    };\n    ContentFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        this.matrix.current = [rowIndex, cellIndex];\n        info.element = !isNullOrUndefined(this.getTable().rows[rowIndex]) ? this.getTable().rows[rowIndex].cells[cellIndex] : null;\n        if (!info.element) {\n            return info;\n        }\n        info.elementToFocus = !info.element.classList.contains('e-unboundcell') && !info.element.classList.contains('e-detailcell')\n            ? this.getFocusable(info.element) : info.element;\n        info.outline = true;\n        info.uid = info.element.parentElement.getAttribute('data-uid');\n        return info;\n    };\n    ContentFocus.prototype.getFocusable = function (element) {\n        var query = 'button, [href], input:not([type=\"hidden\"]), select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n        if (this.parent.isEdit) {\n            query = 'input:not([type=\"hidden\"]), select:not([aria-hidden=\"true\"]), textarea';\n        }\n        var child = [].slice.call(element.querySelectorAll(query));\n        /* Select the first focusable child element\n         * if no child found then select the cell itself.\n         * if Grid is in editable state, check for editable control inside child.\n         */\n        return child.length ? child[0] : element;\n    };\n    ContentFocus.prototype.selector = function (row, cell, isRowTemplate) {\n        var types = [CellType.Expand, CellType.GroupCaption, CellType.CaptionSummary, CellType.GroupSummary];\n        return ((row.isDataRow && cell.visible && (cell.isDataCell || cell.isTemplate))\n            || (row.isDataRow && cell.cellType === CellType.DetailExpand && isNullOrUndefined(cell.visible))\n            || (!row.isDataRow && types.indexOf(cell.cellType) > -1)\n            || (cell.column && cell.column.type === 'checkbox')\n            || (cell.cellType === CellType.CommandColumn)\n            || (row.isDataRow && isRowTemplate))\n            && !(row.edit === 'delete' && row.isDirty);\n    };\n    ContentFocus.prototype.jump = function (action, current) {\n        var frozenSwap = this.parent.frozenColumns > 0 &&\n            ((action === 'leftArrow' || action === 'shiftTab') && current[1] === 0);\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        if (action === 'tab' && !this.parent.isEdit &&\n            current[1] === this.matrix.matrix[current[0]].lastIndexOf(1) && this.matrix.matrix.length - 1 !== current[0]) {\n            this.matrix.current[0] = this.matrix.current[0] + 1;\n            this.matrix.current[1] = -1;\n            frozenSwap = this.parent.frozenColumns > 0;\n        }\n        if (action === 'shiftTab' && !this.parent.isEdit &&\n            current[0] !== 0 && this.matrix.matrix[current[0]].indexOf(1) === current[1]) {\n            this.matrix.current[0] = this.matrix.current[0] - 1;\n            this.matrix.current[1] = this.matrix.matrix[current[0]].length;\n        }\n        var isHeaderFocus = false;\n        var row = document.activeElement.parentElement;\n        if (this.parent.enableVirtualization && row.classList.contains('e-row')) {\n            var rowIndex = parseInt(row.getAttribute('aria-rowindex'), 10);\n            isHeaderFocus = rowIndex > 0;\n        }\n        var info = {\n            swap: !isHeaderFocus ? ((action === 'upArrow' || enterFrozen) && current[0] === 0) || frozenSwap : false,\n            toHeader: (action === 'upArrow' || enterFrozen) && current[0] === 0,\n            toFrozen: frozenSwap\n        };\n        return info;\n    };\n    ContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current = [];\n        if (action === 'rightArrow' || action === 'tab') {\n            current[0] = previous[0];\n            current[1] = -1;\n        }\n        else if (action === 'downArrow' || action === 'enter') {\n            current[0] = -1;\n            current[1] = previous[1];\n        }\n        return current;\n    };\n    ContentFocus.prototype.generateRows = function (rows, optionals) {\n        var _a;\n        var matrix = optionals.matrix, handlerInstance = optionals.handlerInstance;\n        var len = handlerInstance.matrix.matrix.length;\n        var defaultLen = this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar' ? len + 1 : len;\n        handlerInstance.matrix.matrix = handlerInstance.matrix.matrix.slice(0, defaultLen); //Header matrix update.\n        handlerInstance.matrix.rows = defaultLen;\n        (_a = handlerInstance.matrix.matrix).push.apply(_a, matrix);\n        handlerInstance.matrix.rows += matrix.length;\n    };\n    ContentFocus.prototype.getInfo = function (e) {\n        var info = this.getFocusInfo();\n        var _a = this.matrix.current, rIndex = _a[0], cIndex = _a[1];\n        var isData = info.element.classList.contains('e-rowcell');\n        var isSelectable = isData || (e && e.action !== 'enter' && (info.element.classList.contains('e-detailrowcollapse')\n            || info.element.classList.contains('e-detailrowexpand')));\n        var _b = [Math.min(parseInt(info.element.parentElement.getAttribute('aria-rowindex'), 10), rIndex),\n            Math.min(parseInt(info.element.getAttribute('aria-colindex'), 10), cIndex)], rowIndex = _b[0], cellIndex = _b[1];\n        return { isContent: true, isDataCell: isData, indexes: [rowIndex, cellIndex], isSelectable: isSelectable };\n    };\n    ContentFocus.prototype.validator = function () {\n        var table = this.getTable();\n        return function (rowIndex, cellIndex, action) {\n            var cell;\n            if (table.rows[rowIndex].cells[0].classList.contains('e-editcell')) {\n                cell = table.rows[rowIndex].cells[0].querySelectorAll('td')[cellIndex];\n            }\n            else {\n                cell = table.rows[rowIndex].cells[cellIndex];\n            }\n            var isCellWidth = cell.getBoundingClientRect().width !== 0;\n            if (action === 'enter' || action === 'shiftEnter') {\n                return isCellWidth && cell.classList.contains('e-rowcell');\n            }\n            if ((action === 'shiftUp' || action === 'shiftDown') && cell.classList.contains('e-rowcell')) {\n                return isCellWidth;\n            }\n            else if (action !== 'shiftUp' && action !== 'shiftDown') {\n                return isCellWidth;\n            }\n            return false;\n        };\n    };\n    ContentFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, _b = _a[0], rIndex = _b === void 0 ? -1 : _b, _c = _a[1], cIndex = _c === void 0 ? -1 : _c;\n        if (rIndex < 0 || cIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rIndex + \".cells.\" + cIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'shiftEnter' ?\n            cell.classList.contains('e-rowcell') && !cell.classList.contains('e-unboundcell')\n                && !cell.classList.contains('e-templatecell') && !cell.classList.contains('e-detailcell') : true;\n    };\n    return ContentFocus;\n}());\nexport { ContentFocus };\n/**\n * @hidden\n */\nvar HeaderFocus = /** @class */ (function (_super) {\n    __extends(HeaderFocus, _super);\n    function HeaderFocus(parent) {\n        return _super.call(this, parent) || this;\n    }\n    HeaderFocus.prototype.getTable = function () {\n        return (this.parent.getFrozenColumns() ?\n            this.parent.getHeaderContent().querySelector('.e-movableheader .e-table') :\n            this.parent.getHeaderTable());\n    };\n    HeaderFocus.prototype.onClick = function (e) {\n        var target = e.target;\n        target = (target.classList.contains('e-headercell') ? target : closest(target, 'th'));\n        if (!target && this.parent.frozenRows !== 0) {\n            target = (e.target.classList.contains('e-rowcell') ? e.target :\n                closest(e.target, 'td'));\n        }\n        if (e.target.classList.contains('e-columnheader') ||\n            e.target.querySelector('.e-stackedheadercell')) {\n            return false;\n        }\n        if (!target) {\n            return;\n        }\n        var _a = [target.parentElement.rowIndex, target.cellIndex], rowIndex = _a[0], cellIndex = _a[1];\n        var val = getValue(rowIndex + \".\" + cellIndex, this.matrix.matrix);\n        if (this.matrix.inValid(val)) {\n            return false;\n        }\n        this.matrix.select(target.parentElement.rowIndex, target.cellIndex);\n    };\n    HeaderFocus.prototype.getFocusInfo = function () {\n        var info = {};\n        var _a = this.matrix.current, _b = _a[0], rowIndex = _b === void 0 ? 0 : _b, _c = _a[1], cellIndex = _c === void 0 ? 0 : _c;\n        info.element = this.getTable().rows[rowIndex].cells[cellIndex];\n        info.elementToFocus = this.getFocusable(info.element);\n        info.outline = !info.element.classList.contains('e-filterbarcell');\n        return info;\n    };\n    HeaderFocus.prototype.selector = function (row, cell) {\n        return (cell.visible && (cell.column.field !== undefined || cell.isTemplate)) || cell.column.type === 'checkbox' ||\n            cell.cellType === CellType.StackedHeader;\n    };\n    HeaderFocus.prototype.jump = function (action, current) {\n        var frozenSwap = this.parent.frozenColumns > 0 &&\n            (action === 'leftArrow' || action === 'shiftTab') && current[1] === 0;\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        var isLastCell;\n        var lastRow;\n        var headerSwap = frozenSwap;\n        if (this.parent.enableHeaderFocus && action === 'tab') {\n            lastRow = this.matrix.matrix.length - 1 === current[0];\n            isLastCell = current[1] === this.matrix.matrix[current[0]].lastIndexOf(1);\n            if (isLastCell) {\n                if (!lastRow) {\n                    this.matrix.current[0] = this.matrix.current[0] + 1;\n                }\n                else {\n                    this.matrix.current[0] = 0;\n                }\n                this.matrix.current[1] = -1;\n            }\n            if (this.parent.frozenColumns > 0 && lastRow && isLastCell) {\n                frozenSwap = true;\n                headerSwap = false;\n            }\n        }\n        return {\n            swap: ((action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1) ||\n                frozenSwap || (action === 'tab' && lastRow && isLastCell),\n            toHeader: headerSwap,\n            toFrozen: frozenSwap\n        };\n    };\n    HeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current1 = [];\n        if (action === 'upArrow' || action === 'shiftEnter') {\n            current1[0] = this.matrix.matrix.length;\n            current1[1] = previous[1];\n        }\n        else if (action === 'rightArrow' || action === 'tab') {\n            current1[0] = previous[0];\n            current1[1] = -1;\n        }\n        return current1;\n    };\n    HeaderFocus.prototype.generateRows = function (rows) {\n        var _this = this;\n        var length = this.matrix.matrix.length;\n        if (this.parent.allowFiltering && this.parent.filterSettings.type === 'FilterBar') {\n            this.matrix.rows = ++this.matrix.rows;\n            rows[0].cells.forEach(function (cell, cIndex) {\n                return _this.matrix.set(length, cIndex, cell.visible && cell.column.allowFiltering !== false);\n            });\n        }\n    };\n    HeaderFocus.prototype.getInfo = function (e) {\n        return extend(_super.prototype.getInfo.call(this, e), { isContent: false, isHeader: true });\n    };\n    HeaderFocus.prototype.validator = function () {\n        return function () { return true; };\n    };\n    HeaderFocus.prototype.shouldFocusChange = function (e) {\n        var _a = this.matrix.current, rowIndex = _a[0], columnIndex = _a[1];\n        if (rowIndex < 0 || columnIndex < 0) {\n            return true;\n        }\n        var cell = getValue(rowIndex + \".cells.\" + columnIndex, this.getTable().rows);\n        if (!cell) {\n            return true;\n        }\n        return e.action === 'enter' || e.action === 'altDownArrow' ? !cell.classList.contains('e-headercell') : true;\n    };\n    return HeaderFocus;\n}(ContentFocus));\nexport { HeaderFocus };\nvar FixedContentFocus = /** @class */ (function (_super) {\n    __extends(FixedContentFocus, _super);\n    function FixedContentFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedContentFocus.prototype.getTable = function () {\n        return this.parent.getContent().querySelector('.e-frozencontent .e-table');\n    };\n    FixedContentFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'shiftEnter';\n        return {\n            swap: (action === 'upArrow' || enterFrozen) && current[0] === 0\n                || ((action === 'tab' || action === 'rightArrow') && current[1] === this.matrix.columns),\n            toHeader: (action === 'upArrow' || enterFrozen) && current[0] === 0,\n            toFrozen: (action === 'upArrow' || enterFrozen) && current[0] === 0\n        };\n    };\n    FixedContentFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current2 = [];\n        if (action === 'tab' && this.parent.enableHeaderFocus) {\n            current2[0] = previous[0];\n            current2[1] = -1;\n        }\n        if (action === 'leftArrow' || action === 'shiftTab') {\n            current2[0] = previous[0];\n            current2[1] = active.matrix.columns + 1;\n        }\n        else if (action === 'downArrow' || action === 'enter') {\n            current2[0] = -1;\n            current2[1] = previous[1];\n        }\n        return current2;\n    };\n    return FixedContentFocus;\n}(ContentFocus));\nexport { FixedContentFocus };\nvar FixedHeaderFocus = /** @class */ (function (_super) {\n    __extends(FixedHeaderFocus, _super);\n    function FixedHeaderFocus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FixedHeaderFocus.prototype.jump = function (action, current) {\n        var enterFrozen = this.parent.frozenRows !== 0 && action === 'enter';\n        return {\n            swap: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1\n                || ((action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns),\n            toHeader: (action === 'rightArrow' || action === 'tab') && current[1] === this.matrix.columns,\n            toFrozen: (action === 'downArrow' || enterFrozen) && current[0] === this.matrix.matrix.length - 1\n        };\n    };\n    FixedHeaderFocus.prototype.getTable = function () {\n        return (this.parent.getHeaderContent().querySelector('.e-frozenheader .e-table'));\n    };\n    FixedHeaderFocus.prototype.getNextCurrent = function (previous, swap, active, action) {\n        if (previous === void 0) { previous = []; }\n        var current3 = [];\n        if (action === 'leftArrow' || action === 'shiftTab') {\n            current3[0] = previous[0];\n            current3[1] = active.matrix.columns + 1;\n        }\n        else if (action === 'upArrow' || action === 'shiftEnter') {\n            current3[0] = this.matrix.matrix.length;\n            current3[1] = previous[1];\n        }\n        return current3;\n    };\n    return FixedHeaderFocus;\n}(HeaderFocus));\nexport { FixedHeaderFocus };\n/** @hidden */\nvar SearchBox = /** @class */ (function () {\n    function SearchBox(searchBox) {\n        this.searchBox = searchBox;\n    }\n    SearchBox.prototype.searchFocus = function (args) {\n        args.target.parentElement.classList.add('e-input-focus');\n    };\n    SearchBox.prototype.searchBlur = function (args) {\n        args.target.parentElement.classList.remove('e-input-focus');\n    };\n    SearchBox.prototype.wireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.add(this.searchBox, 'focus', this.searchFocus, this);\n            EventHandler.add(this.searchBox, 'blur', this.searchBlur, this);\n        }\n    };\n    SearchBox.prototype.unWireEvent = function () {\n        if (this.searchBox) {\n            EventHandler.remove(this.searchBox, 'focus', this.searchFocus);\n            EventHandler.remove(this.searchBox, 'blur', this.searchBlur);\n        }\n    };\n    return SearchBox;\n}());\nexport { SearchBox };\n"]},"metadata":{},"sourceType":"module"}