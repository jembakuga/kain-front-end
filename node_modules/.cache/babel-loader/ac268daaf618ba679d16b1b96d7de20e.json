{"ast":null,"code":"import { EventHandler, isNullOrUndefined, extend, closest, getValue } from '@syncfusion/ej2-base';\nimport { getActualPropFromColl, isActionPrevent, getColumnByForeignKeyValue } from '../base/util';\nimport { remove, matches, isBlazor } from '@syncfusion/ej2-base';\nimport { DataUtil, Query, DataManager } from '@syncfusion/ej2-data';\nimport * as events from '../base/constant';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport { FilterCellRenderer } from '../renderer/filter-cell-renderer';\nimport { parentsUntil } from '../base/util';\nimport { FilterMenuRenderer } from '../renderer/filter-menu-renderer';\nimport { CheckBoxFilter } from '../actions/checkbox-filter';\nimport { ExcelFilter } from '../actions/excel-filter';\n/**\n *\n * The `Filter` module is used to handle filtering action.\n */\n\nvar Filter =\n/** @class */\nfunction () {\n  /**\n   * Constructor for Grid filtering module\n   * @hidden\n   */\n  function Filter(parent, filterSettings, serviceLocator) {\n    this.predicate = 'and';\n    this.contentRefresh = true;\n    this.refresh = true;\n    this.values = {};\n    this.cellText = {};\n    this.nextFlMenuOpen = '';\n    this.type = {\n      'Menu': FilterMenuRenderer,\n      'CheckBox': CheckBoxFilter,\n      'Excel': ExcelFilter\n    };\n    /** @hidden */\n\n    this.filterOperators = {\n      contains: 'contains',\n      endsWith: 'endswith',\n      equal: 'equal',\n      greaterThan: 'greaterthan',\n      greaterThanOrEqual: 'greaterthanorequal',\n      lessThan: 'lessthan',\n      lessThanOrEqual: 'lessthanorequal',\n      notEqual: 'notequal',\n      startsWith: 'startswith'\n    };\n    this.fltrDlgDetails = {\n      field: '',\n      isOpen: false\n    };\n    /** @hidden */\n\n    this.skipNumberInput = ['=', ' ', '!'];\n    this.skipStringInput = ['>', '<', '='];\n    this.actualPredicate = {};\n    this.parent = parent;\n    this.filterSettings = filterSettings;\n    this.serviceLocator = serviceLocator;\n    this.addEventListener();\n  }\n  /**\n   * To render filter bar when filtering enabled.\n   * @return {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.render = function (e) {\n    if (DataUtil.getObject('args.isFrozen', e)) {\n      return;\n    }\n\n    var gObj = this.parent;\n    this.l10n = this.serviceLocator.getService('localization');\n    this.getLocalizedCustomOperators();\n\n    if (this.parent.filterSettings.type === 'FilterBar') {\n      if (gObj.columns.length) {\n        var fltrElem = this.parent.element.querySelector('.e-filterbar');\n\n        if (fltrElem) {\n          remove(fltrElem);\n        }\n\n        var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Filter, gObj);\n        var row = void 0;\n        var cellrender = this.serviceLocator.getService('cellRendererFactory');\n        cellrender.addCellRenderer(CellType.Filter, new FilterCellRenderer(this.parent, this.serviceLocator));\n        this.valueFormatter = this.serviceLocator.getService('valueFormatter');\n        rowRenderer.element = this.parent.createElement('tr', {\n          className: 'e-filterbar'\n        });\n        row = this.generateRow();\n        row.data = this.values;\n        this.parent.getHeaderContent().querySelector('thead').appendChild(rowRenderer.element);\n        var rowdrag = this.parent.element.querySelector('.e-rowdragheader');\n        this.element = rowRenderer.render(row, gObj.getColumns(), null, null, rowRenderer.element);\n        var detail = this.element.querySelector('.e-detailheadercell');\n\n        if (detail) {\n          detail.className = 'e-filterbarcell e-mastercell';\n        }\n\n        if (rowdrag) {\n          rowdrag.className = 'e-dragheadercell e-mastercell';\n        }\n\n        var gCells = [].slice.call(this.element.querySelectorAll('.e-grouptopleftcell'));\n\n        if (gCells.length) {\n          gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n        }\n\n        this.wireEvents();\n        this.parent.notify(events.freezeRender, {\n          case: 'filter'\n        });\n      }\n    }\n  };\n  /**\n   * To destroy the filter bar.\n   * @return {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n\n    if (!gridElement || !gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent')) {\n      return;\n    }\n\n    if (this.filterModule) {\n      this.filterModule.destroy();\n    } // tslint:disable-next-line:no-any\n\n\n    if (!this.parent.refreshing) {\n      this.filterSettings.columns = [];\n    }\n\n    this.updateFilterMsg();\n    this.removeEventListener();\n    this.unWireEvents();\n\n    if (this.element) {\n      remove(this.element);\n      var filterBarElement = this.parent.getHeaderContent().querySelector('.e-filterbar');\n\n      if (this.parent.getFrozenColumns() && filterBarElement) {\n        remove(filterBarElement);\n      }\n    }\n  };\n\n  Filter.prototype.generateRow = function (index) {\n    var options = {};\n    var row = new Row(options);\n    row.cells = this.generateCells();\n    return row;\n  };\n\n  Filter.prototype.generateCells = function () {\n    //TODO: generate dummy column for group, detail, stacked row here for filtering;\n    var cells = [];\n\n    if (this.parent.allowGrouping) {\n      for (var c = 0, len = this.parent.groupSettings.columns.length; c < len; c++) {\n        cells.push(this.generateCell({}, CellType.HeaderIndent));\n      }\n    }\n\n    if (this.parent.detailTemplate || this.parent.childGrid) {\n      cells.push(this.generateCell({}, CellType.DetailHeader));\n    }\n\n    if (this.parent.isRowDragable()) {\n      cells.push(this.generateCell({}, CellType.RowDragHIcon));\n    }\n\n    for (var _i = 0, _a = this.parent.getColumns(); _i < _a.length; _i++) {\n      var dummy = _a[_i];\n      cells.push(this.generateCell(dummy));\n    }\n\n    return cells;\n  };\n\n  Filter.prototype.generateCell = function (column, cellType) {\n    var opt = {\n      'visible': column.visible,\n      'isDataCell': false,\n      'rowId': '',\n      'column': column,\n      'cellType': cellType ? cellType : CellType.Filter,\n      'attributes': {\n        title: this.l10n.getConstant('FilterbarTitle')\n      }\n    };\n    return new Cell(opt);\n  };\n  /**\n   * To update filterSettings when applying filter.\n   * @return {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.updateModel = function () {\n    var col = this.parent.getColumnByField(this.fieldName);\n    var field = col.isForeignColumn() ? col.foreignKeyValue : this.fieldName;\n    this.currentFilterObject = {\n      field: field,\n      uid: col.uid,\n      isForeignKey: col.isForeignColumn(),\n      operator: this.operator,\n      value: this.value,\n      predicate: this.predicate,\n      matchCase: this.matchCase,\n      ignoreAccent: this.ignoreAccent,\n      actualFilterValue: {},\n      actualOperator: {}\n    };\n    var index = this.getFilteredColsIndexByField(col);\n\n    if (index > -1) {\n      this.filterSettings.columns[index] = this.currentFilterObject;\n    } else {\n      this.filterSettings.columns.push(this.currentFilterObject);\n    }\n\n    this.filterSettings.columns = this.filterSettings.columns;\n    this.parent.dataBind();\n  };\n\n  Filter.prototype.getFilteredColsIndexByField = function (col) {\n    var cols = this.filterSettings.columns;\n\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (cols[i].uid === col.uid || col.isForeignColumn() && this.parent.getColumnByUid(col.uid).field === col.foreignKeyValue) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n  /**\n   * To trigger action complete event.\n   * @return {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.onActionComplete = function (e) {\n    if (isBlazor() && !this.parent.isJsComponent) {\n      e.rows = null;\n    }\n\n    var args = !this.isRemove ? {\n      currentFilterObject: this.currentFilterObject,\n\n      /* tslint:disable:no-string-literal */\n      currentFilteringColumn: !isNullOrUndefined(this.column) ? this.column.field : undefined,\n\n      /* tslint:enable:no-string-literal */\n      columns: this.filterSettings.columns,\n      requestType: 'filtering',\n      type: events.actionComplete\n    } : {\n      requestType: 'filtering',\n      type: events.actionComplete\n    };\n    this.parent.trigger(events.actionComplete, extend(e, args));\n    this.isRemove = false;\n  };\n\n  Filter.prototype.wireEvents = function () {\n    EventHandler.add(this.parent.getHeaderContent(), 'keyup', this.keyUpHandler, this);\n  };\n\n  Filter.prototype.unWireEvents = function () {\n    EventHandler.remove(this.parent.getHeaderContent(), 'keyup', this.keyUpHandler);\n  };\n\n  Filter.prototype.enableAfterRender = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.parent.getHeaderTable().classList.add('e-sortfilter');\n      this.render();\n    }\n  };\n\n  Filter.prototype.initialEnd = function () {\n    this.parent.off(events.contentReady, this.initialEnd);\n\n    if (this.parent.getColumns().length && this.filterSettings.columns.length) {\n      var gObj = this.parent;\n      this.contentRefresh = false;\n      this.initialLoad = true;\n\n      for (var _i = 0, _a = gObj.filterSettings.columns; _i < _a.length; _i++) {\n        var col = _a[_i];\n        this.filterByColumn(col.field, col.operator, col.value, col.predicate, col.matchCase, col.ignoreAccent, col.actualFilterValue, col.actualOperator);\n      }\n\n      this.initialLoad = false;\n      this.updateFilterMsg();\n      this.contentRefresh = true;\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  Filter.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n    this.parent.on(events.filterComplete, this.onActionComplete, this);\n    this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.keyPressed, this.keyUpHandler, this);\n    this.parent.on(events.columnPositionChanged, this.columnPositionChanged, this);\n    this.parent.on(events.headerRefreshed, this.render, this);\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.filterMenuClose, this.filterMenuClose, this);\n    EventHandler.add(document, 'click', this.clickHandler, this);\n    this.parent.on(events.filterOpen, this.columnMenuFilter, this);\n    this.parent.on(events.click, this.filterIconClickHandler, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Filter.prototype.removeEventListener = function () {\n    EventHandler.remove(document, 'click', this.clickHandler);\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.uiUpdate, this.enableAfterRender);\n    this.parent.off(events.filterComplete, this.onActionComplete);\n    this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n    this.parent.off(events.keyPressed, this.keyUpHandler);\n    this.parent.off(events.columnPositionChanged, this.columnPositionChanged);\n    this.parent.off(events.headerRefreshed, this.render);\n    this.parent.off(events.filterOpen, this.columnMenuFilter);\n    this.parent.off(events.filterMenuClose, this.filterMenuClose);\n    this.parent.off(events.click, this.filterIconClickHandler);\n  };\n\n  Filter.prototype.filterMenuClose = function (args) {\n    this.fltrDlgDetails.isOpen = false;\n  };\n  /**\n   * Filters the Grid row by fieldName, filterOperator, and filterValue.\n   * @param  {string} fieldName - Defines the field name of the filter column.\n   * @param  {string} filterOperator - Defines the operator to filter records.\n   * @param  {string | number | Date | boolean} filterValue - Defines the value which is used to filter records.\n   * @param  {string} predicate - Defines the relationship of one filter query with another by using AND or OR predicate.\n   * @param  {boolean} matchCase - If match case is set to true, then the filter records\n   * the exact match or <br> filters records that are case insensitive (uppercase and lowercase letters treated the same).\n   * @param {boolean} ignoreAccent - If ignoreAccent set to true, then filter ignores the diacritic characters or accents while filtering.\n   * @param  {string} actualFilterValue - Defines the actual filter value for the filter column.\n   * @param  {string} actualOperator - Defines the actual filter operator for the filter column.\n   * @return {void}\n   */\n\n\n  Filter.prototype.filterByColumn = function (fieldName, filterOperator, filterValue, predicate, matchCase, ignoreAccent, actualFilterValue, actualOperator) {\n    var gObj = this.parent;\n    var filterCell;\n    this.column = gObj.grabColumnByFieldFromAllCols(fieldName);\n\n    if (!this.column) {\n      return;\n    }\n\n    if (this.filterSettings.type === 'FilterBar') {\n      filterCell = gObj.getHeaderContent().querySelector('[id=\\'' + this.column.field + '_filterBarcell\\']');\n    }\n\n    if (!isNullOrUndefined(this.column.allowFiltering) && !this.column.allowFiltering) {\n      this.parent.log('action_disabled_column', {\n        moduleName: this.getModuleName(),\n        columnName: this.column.headerText\n      });\n      return;\n    }\n\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.filterByColumn,\n        arg1: fieldName,\n        arg2: filterOperator,\n        arg3: filterValue,\n        arg4: predicate,\n        arg5: matchCase,\n        arg6: ignoreAccent,\n        arg7: actualFilterValue,\n        arg8: actualOperator\n      });\n      return;\n    }\n\n    this.value = filterValue;\n    this.matchCase = matchCase || false;\n    this.ignoreAccent = this.ignoreAccent = !isNullOrUndefined(ignoreAccent) ? ignoreAccent : this.parent.filterSettings.ignoreAccent;\n    this.fieldName = fieldName;\n    this.predicate = predicate || 'and';\n    this.operator = filterOperator;\n    filterValue = !isNullOrUndefined(filterValue) && filterValue.toString();\n\n    if (this.column.type === 'number' || this.column.type === 'date') {\n      this.matchCase = true;\n    }\n\n    gObj.getColumnHeaderByField(fieldName).setAttribute('aria-filtered', 'true');\n\n    if (filterValue.length < 1 || this.checkForSkipInput(this.column, filterValue)) {\n      this.filterStatusMsg = filterValue.length < 1 ? '' : this.l10n.getConstant('InvalidFilterMessage');\n      this.updateFilterMsg();\n      return;\n    }\n\n    if (filterCell && this.filterSettings.type === 'FilterBar' && filterCell.value !== filterValue) {\n      filterCell.value = filterValue;\n    }\n\n    if (!isNullOrUndefined(this.column.format)) {\n      this.applyColumnFormat(filterValue);\n\n      if (this.initialLoad && this.filterSettings.type === 'FilterBar') {\n        filterCell.value = this.values[this.column.field];\n      }\n    } else {\n      this.values[this.column.field] = filterValue; //this line should be above updateModel\n    }\n\n    this.actualPredicate[this.fieldName] = [{\n      field: this.fieldName,\n      predicate: predicate,\n      matchCase: matchCase,\n      ignoreAccent: ignoreAccent,\n      operator: this.operator,\n      value: this.value,\n      type: this.column.type\n    }];\n    this.addFilteredClass(this.fieldName);\n\n    if (this.checkAlreadyColFiltered(this.column.field)) {\n      return;\n    }\n\n    this.updateModel();\n  };\n\n  Filter.prototype.applyColumnFormat = function (filterValue) {\n    var getFlvalue = this.column.type === 'date' || this.column.type === 'datetime' ? new Date(filterValue) : parseFloat(filterValue);\n    this.values[this.column.field] = this.setFormatForFlColumn(getFlvalue, this.column);\n  };\n\n  Filter.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n\n    for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      switch (prop) {\n        case 'columns':\n          if (this.contentRefresh) {\n            this.parent.notify(events.modelChanged, {\n              currentFilterObject: this.currentFilterObject,\n              currentFilteringColumn: this.column ? this.column.field : undefined,\n              action: 'filter',\n              columns: this.filterSettings.columns,\n              requestType: 'filtering',\n              type: events.actionBegin,\n              cancel: false\n            });\n            this.refreshFilterSettings();\n            this.updateFilterMsg();\n            this.updateFilter();\n          }\n\n          break;\n\n        case 'showFilterBarStatus':\n          if (e.properties[prop]) {\n            this.updateFilterMsg();\n          } else if (this.parent.allowPaging) {\n            this.parent.updateExternalMessage('');\n          }\n\n          break;\n\n        case 'type':\n          this.parent.refreshHeader();\n          this.refreshFilterSettings();\n          break;\n      }\n    }\n  };\n\n  Filter.prototype.refreshFilterSettings = function () {\n    if (this.filterSettings.type === 'FilterBar') {\n      for (var i = 0; i < this.filterSettings.columns.length; i++) {\n        this.column = this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[i].uid);\n        var filterValue = this.filterSettings.columns[i].value;\n        filterValue = !isNullOrUndefined(filterValue) && filterValue.toString();\n\n        if (!isNullOrUndefined(this.column.format)) {\n          this.applyColumnFormat(filterValue);\n        } else {\n          var key = this.filterSettings.columns[i].field;\n          this.values[key] = this.filterSettings.columns[i].value;\n        }\n\n        var filterElement = this.getFilterBarElement(this.column.field);\n\n        if (filterElement) {\n          if (this.cellText[this.filterSettings.columns[i].field] !== '' && !isNullOrUndefined(this.cellText[this.filterSettings.columns[i].field])) {\n            filterElement.value = this.cellText[this.column.field];\n          } else {\n            filterElement.value = this.filterSettings.columns[i].value;\n          }\n        }\n      }\n\n      if (this.filterSettings.columns.length === 0) {\n        var col = this.parent.getColumns();\n\n        for (var i = 0; i < col.length; i++) {\n          var filterElement = this.getFilterBarElement(col[i].field);\n\n          if (filterElement && filterElement.value !== '') {\n            filterElement.value = '';\n            delete this.values[col[i].field];\n          }\n        }\n      }\n    }\n  };\n\n  Filter.prototype.getFilterBarElement = function (col) {\n    var selector = '[id=\\'' + col + '_filterBarcell\\']';\n    var filterElement;\n\n    if (selector && !isNullOrUndefined(this.element)) {\n      filterElement = this.element.querySelector(selector);\n    }\n\n    return filterElement;\n  };\n  /**\n   * @private\n   */\n\n\n  Filter.prototype.refreshFilter = function () {\n    this.refreshFilterSettings();\n    this.updateFilterMsg();\n  };\n  /**\n   * Clears all the filtered rows of the Grid.\n   * @return {void}\n   */\n\n\n  Filter.prototype.clearFiltering = function () {\n    var _this = this;\n\n    var cols = getActualPropFromColl(this.filterSettings.columns);\n\n    if (isActionPrevent(this.parent)) {\n      this.parent.notify(events.preventBatch, {\n        instance: this,\n        handler: this.clearFiltering\n      });\n      return;\n    }\n\n    cols.forEach(function (col) {\n      col.uid = col.uid || _this.parent.getColumnByField(col.field).uid;\n    });\n    var colUid = cols.map(function (f) {\n      return f.uid;\n    });\n    var filteredcols = colUid.filter(function (item, pos) {\n      return colUid.indexOf(item) === pos;\n    });\n    this.refresh = false;\n\n    for (var i = 0, len = filteredcols.length; i < len; i++) {\n      this.removeFilteredColsByField(this.parent.getColumnByUid(filteredcols[i]).field, false);\n    }\n\n    if (isBlazor() && !this.parent.isJsComponent) {\n      this.filterSettings.columns = this.filterSettings.columns;\n    }\n\n    this.refresh = true;\n\n    if (filteredcols.length) {\n      this.parent.renderModule.refresh();\n    }\n\n    if (this.parent.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered')) {\n      var fltrElement = [].slice.call(this.parent.element.querySelectorAll('.e-filtered'));\n\n      for (var i = 0, len = fltrElement.length; i < len; i++) {\n        fltrElement[0].removeAttribute('aria-filtered');\n        fltrElement[0].classList.remove('e-filtered');\n      }\n    }\n\n    this.isRemove = true;\n    this.filterStatusMsg = '';\n    this.updateFilterMsg();\n  };\n\n  Filter.prototype.checkAlreadyColFiltered = function (field) {\n    var columns = this.filterSettings.columns;\n\n    for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n      var col = columns_1[_i];\n\n      if (col.field === field && col.value === this.value && col.operator === this.operator && col.predicate === this.predicate) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  Filter.prototype.columnMenuFilter = function (args) {\n    this.column = args.col;\n    var ele = closest(args.target, '#' + args.id);\n\n    if (args.isClose && !ele) {\n      this.filterModule.closeDialog();\n    } else if (ele) {\n      this.filterDialogOpen(this.column, args.target);\n    }\n  };\n\n  Filter.prototype.filterDialogOpen = function (col, target, left, top) {\n    var gObj = this.parent;\n\n    if (this.filterModule) {\n      this.filterModule.closeDialog();\n    }\n\n    this.filterModule = new this.type[col.filter.type || this.parent.filterSettings.type](this.parent, gObj.filterSettings, this.serviceLocator, this.customOperators, this);\n    var dataSource = col.filter.dataSource || gObj.getDataModule().dataManager;\n    this.filterModule.openDialog({\n      type: col.type,\n      field: col.field,\n      displayName: col.headerText,\n      dataSource: dataSource,\n      format: col.format,\n      height: 800,\n      columns: gObj.getColumns(),\n      filteredColumns: gObj.filterSettings.columns,\n      target: target,\n      dataManager: gObj.getDataModule().dataManager,\n      formatFn: col.getFormatter(),\n      ignoreAccent: gObj.filterSettings.ignoreAccent,\n      parserFn: col.getParser(),\n      query: gObj.query,\n      template: col.getFilterItemTemplate(),\n      hideSearchbox: isNullOrUndefined(col.filter.hideSearchbox) ? false : col.filter.hideSearchbox,\n      handler: this.filterHandler.bind(this),\n      localizedStrings: gObj.getLocaleConstants(),\n      position: {\n        X: left,\n        Y: top\n      },\n      column: col,\n      foreignKeyValue: col.foreignKeyValue,\n      actualPredicate: this.actualPredicate,\n      localeObj: gObj.localeObj,\n      isRemote: gObj.getDataModule().isRemote(),\n      allowCaseSensitive: this.filterSettings.enableCaseSensitivity\n    });\n  };\n  /**\n   * Removes filtered column by field name.\n   * @param  {string} field - Defines column field name to remove filter.\n   * @param  {boolean} isClearFilterBar -  Specifies whether the filter bar value needs to be cleared.\n   * @return {void}\n   * @hidden\n   */\n\n\n  Filter.prototype.removeFilteredColsByField = function (field, isClearFilterBar) {\n    var fCell;\n    var cols = this.filterSettings.columns;\n\n    if (isActionPrevent(this.parent)) {\n      var args = {\n        instance: this,\n        handler: this.removeFilteredColsByField,\n        arg1: field,\n        arg2: isClearFilterBar\n      };\n      this.parent.notify(events.preventBatch, args);\n      return;\n    }\n\n    var colUid = cols.map(function (f) {\n      return f.uid;\n    });\n    var filteredColsUid = colUid.filter(function (item, pos) {\n      return colUid.indexOf(item) === pos;\n    });\n\n    for (var i = 0, len = filteredColsUid.length; i < len; i++) {\n      cols[i].uid = cols[i].uid || this.parent.getColumnByField(cols[i].field).uid;\n      var len_1 = cols.length;\n      var column = this.parent.grabColumnByUidFromAllCols(filteredColsUid[i]);\n\n      if (column.field === field || column.field === column.foreignKeyValue && column.isForeignColumn()) {\n        if (this.filterSettings.type === 'FilterBar' && !isClearFilterBar) {\n          var selector = '[id=\\'' + column.field + '_filterBarcell\\']';\n          fCell = this.parent.getHeaderContent().querySelector(selector);\n\n          if (fCell) {\n            fCell.value = '';\n            delete this.values[field];\n          }\n        }\n\n        while (len_1--) {\n          if (cols[len_1].uid === column.uid) {\n            cols.splice(len_1, 1);\n          }\n        }\n\n        var fltrElement = this.parent.getColumnHeaderByField(column.field);\n        fltrElement.removeAttribute('aria-filtered');\n\n        if (this.filterSettings.type !== 'FilterBar') {\n          var iconClass = this.parent.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n          fltrElement.querySelector(iconClass).classList.remove('e-filtered');\n        }\n\n        var cloneActualPredicate = void 0;\n        column.isForeignColumn() ? cloneActualPredicate = extend({}, this.actualPredicate[column.foreignKeyValue][0]) : cloneActualPredicate = extend({}, this.actualPredicate[field][0]);\n        this.isRemove = true;\n\n        if (this.actualPredicate[field]) {\n          delete this.actualPredicate[field];\n        }\n\n        if (this.values[field]) {\n          delete this.values[field];\n        }\n\n        if (this.refresh) {\n          this.parent.notify(events.modelChanged, {\n            requestType: 'filtering',\n            type: events.actionBegin,\n            currentFilterObject: cloneActualPredicate,\n            currentFilterColumn: column,\n            action: 'clearFilter'\n          });\n        }\n\n        break;\n      }\n    }\n\n    this.updateFilterMsg();\n  };\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  Filter.prototype.getModuleName = function () {\n    return 'filter';\n  };\n\n  Filter.prototype.keyUpHandler = function (e) {\n    var gObj = this.parent;\n    var target = e.target;\n\n    if (target && matches(target, '.e-filterbar input')) {\n      var closeHeaderEle = closest(target, 'th.e-filterbarcell');\n      this.column = gObj.getColumnByUid(closeHeaderEle.getAttribute('e-mappinguid'));\n\n      if (!this.column) {\n        return;\n      }\n\n      if ((this.filterSettings.mode === 'Immediate' || e.keyCode === 13) && e.keyCode !== 9) {\n        this.value = target.value.trim();\n        this.processFilter(e);\n      }\n    }\n\n    if (e.action === 'altDownArrow' && this.filterSettings.type !== 'FilterBar') {\n      var element = gObj.focusModule.currentInfo.element;\n\n      if (element && element.classList.contains('e-headercell')) {\n        var column = gObj.getColumnByUid(element.firstElementChild.getAttribute('e-mappinguid'));\n        this.openMenuByField(column.field);\n        this.parent.focusModule.clearIndicator();\n      }\n    }\n\n    if (e.action === 'escape' && this.filterSettings.type === 'Menu') {\n      this.filterModule.closeDialog();\n      gObj.notify(events.restoreFocus, {});\n    }\n  };\n\n  Filter.prototype.updateCrossIcon = function (element) {\n    if (element.value.length) {\n      element.nextElementSibling.classList.remove('e-hide');\n    }\n  };\n\n  Filter.prototype.updateFilterMsg = function () {\n    if (this.filterSettings.type === 'FilterBar') {\n      var gObj = this.parent;\n      var getFormatFlValue = void 0;\n      var columns = this.filterSettings.columns;\n      var formater = this.serviceLocator.getService('valueFormatter');\n      var column = void 0;\n      var value = void 0;\n\n      if (!this.filterSettings.showFilterBarStatus) {\n        return;\n      }\n\n      if (columns.length > 0 && this.filterStatusMsg !== this.l10n.getConstant('InvalidFilterMessage')) {\n        this.filterStatusMsg = '';\n\n        for (var index = 0; index < columns.length; index++) {\n          column = gObj.grabColumnByUidFromAllCols(columns[index].uid) || gObj.grabColumnByFieldFromAllCols(columns[index].field);\n\n          if (index) {\n            this.filterStatusMsg += ' && ';\n          }\n\n          if (!isNullOrUndefined(column.format)) {\n            var flValue = column.type === 'date' || column.type === 'datetime' ? this.valueFormatter.fromView(this.values[column.field], column.getParser(), column.type) : this.values[column.field];\n\n            if (!(column.type === 'date' || column.type === 'datetime')) {\n              var formater_1 = this.serviceLocator.getService('valueFormatter');\n              getFormatFlValue = formater_1.toView(flValue, column.getParser()).toString();\n            } else {\n              getFormatFlValue = this.setFormatForFlColumn(flValue, column);\n            }\n\n            this.filterStatusMsg += column.headerText + ': ' + getFormatFlValue;\n          } else {\n            this.filterStatusMsg += column.headerText + ': ' + this.values[column.field];\n          }\n        }\n      }\n\n      if (gObj.allowPaging) {\n        gObj.updateExternalMessage(this.filterStatusMsg);\n      } //TODO: virtual paging       \n\n\n      this.filterStatusMsg = '';\n    }\n  };\n\n  Filter.prototype.setFormatForFlColumn = function (value, column) {\n    var formater = this.serviceLocator.getService('valueFormatter');\n    return formater.toView(value, column.getFormatter()).toString();\n  };\n\n  Filter.prototype.checkForSkipInput = function (column, value) {\n    var isSkip;\n\n    if (column.type === 'number') {\n      if (DataUtil.operatorSymbols[value] || this.skipNumberInput.indexOf(value) > -1) {\n        isSkip = true;\n      }\n    } else if (column.type === 'string') {\n      for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\n        var val = value_1[_i];\n\n        if (this.skipStringInput.indexOf(val) > -1) {\n          isSkip = true;\n        }\n      }\n    }\n\n    return isSkip;\n  };\n\n  Filter.prototype.processFilter = function (e) {\n    this.stopTimer();\n    this.startTimer(e);\n  };\n\n  Filter.prototype.startTimer = function (e) {\n    var _this = this;\n\n    this.timer = window.setInterval(function () {\n      _this.onTimerTick();\n    }, e.keyCode === 13 ? 0 : this.filterSettings.immediateModeDelay);\n  };\n\n  Filter.prototype.stopTimer = function () {\n    window.clearInterval(this.timer);\n  };\n\n  Filter.prototype.onTimerTick = function () {\n    var selector = '[id=\\'' + this.column.field + '_filterBarcell\\']';\n    var filterElement = this.element.querySelector(selector);\n\n    if (!filterElement && this.parent.getFrozenColumns()) {\n      filterElement = this.parent.getHeaderContent().querySelector(selector);\n    }\n\n    var filterValue;\n    this.cellText[this.column.field] = filterElement.value;\n    this.stopTimer();\n\n    if (!isNullOrUndefined(this.column.filterBarTemplate)) {\n      var templateRead = this.column.filterBarTemplate.read;\n\n      if (typeof templateRead === 'string') {\n        templateRead = getValue(templateRead, window);\n      }\n\n      if (!isNullOrUndefined(templateRead)) {\n        this.value = templateRead.call(this, filterElement);\n      }\n    } else {\n      filterValue = JSON.parse(JSON.stringify(filterElement.value));\n    }\n\n    if (isNullOrUndefined(this.value) || this.value === '') {\n      this.removeFilteredColsByField(this.column.field);\n\n      if (isBlazor() && !this.parent.isJsComponent) {\n        this.filterSettings.columns = this.filterSettings.columns;\n      }\n\n      return;\n    }\n\n    this.validateFilterValue(this.value);\n    this.filterByColumn(this.column.field, this.operator, this.value, this.predicate, this.filterSettings.enableCaseSensitivity, this.ignoreAccent);\n    filterElement.value = filterValue;\n    this.updateFilterMsg();\n  };\n\n  Filter.prototype.validateFilterValue = function (value) {\n    var gObj = this.parent;\n    var skipInput;\n    var index;\n    this.matchCase = this.filterSettings.enableCaseSensitivity;\n\n    switch (this.column.type) {\n      case 'number':\n        if (this.column.filter.operator) {\n          this.operator = this.column.filter.operator;\n        } else {\n          this.operator = this.filterOperators.equal;\n        }\n\n        skipInput = ['>', '<', '=', '!'];\n\n        for (var i = 0; i < value.length; i++) {\n          if (skipInput.indexOf(value[i]) > -1) {\n            index = i;\n            break;\n          }\n        }\n\n        this.getOperator(value.substring(index));\n\n        if (index !== 0) {\n          this.value = value.substring(0, index);\n        }\n\n        if (this.value !== '' && value.length >= 1) {\n          this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n        }\n\n        if (isNaN(this.value)) {\n          this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n        }\n\n        break;\n\n      case 'date':\n      case 'datetime':\n        this.operator = this.filterOperators.equal;\n\n        if (this.value !== '' && !(this.value instanceof Date)) {\n          this.getOperator(value);\n          this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n\n          if (isNullOrUndefined(this.value)) {\n            this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n          }\n        }\n\n        break;\n\n      case 'string':\n        this.matchCase = false;\n\n        if (value.charAt(0) === '*') {\n          this.value = this.value.slice(1);\n          this.operator = this.filterOperators.startsWith;\n        } else if (value.charAt(value.length - 1) === '%') {\n          this.value = this.value.slice(0, -1);\n          this.operator = this.filterOperators.startsWith;\n        } else if (value.charAt(0) === '%') {\n          this.value = this.value.slice(1);\n          this.operator = this.filterOperators.endsWith;\n        } else {\n          if (this.column.filter.operator) {\n            this.operator = this.column.filter.operator;\n          } else {\n            this.operator = this.filterOperators.startsWith;\n          }\n        }\n\n        break;\n\n      case 'boolean':\n        if (value.toLowerCase() === 'true' || value === '1') {\n          this.value = true;\n        } else if (value.toLowerCase() === 'false' || value === '0') {\n          this.value = false;\n        } else if (value.length) {\n          this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n        }\n\n        this.operator = this.filterOperators.equal;\n        break;\n\n      default:\n        if (this.column.filter.operator) {\n          this.operator = this.column.filter.operator;\n        } else {\n          this.operator = this.filterOperators.equal;\n        }\n\n    }\n  };\n\n  Filter.prototype.getOperator = function (value) {\n    var singleOp = value.charAt(0);\n    var multipleOp = value.slice(0, 2);\n    var operators = extend({\n      '=': this.filterOperators.equal,\n      '!': this.filterOperators.notEqual\n    }, DataUtil.operatorSymbols);\n\n    if (operators.hasOwnProperty(singleOp) || operators.hasOwnProperty(multipleOp)) {\n      this.operator = operators[singleOp];\n      this.value = value.substring(1);\n\n      if (!this.operator) {\n        this.operator = operators[multipleOp];\n        this.value = value.substring(2);\n      }\n    }\n\n    if (this.operator === this.filterOperators.lessThan || this.operator === this.filterOperators.greaterThan) {\n      if (this.value.charAt(0) === '=') {\n        this.operator = this.operator + 'orequal';\n        this.value = this.value.substring(1);\n      }\n    }\n  };\n\n  Filter.prototype.columnPositionChanged = function (e) {\n    if (this.parent.filterSettings.type !== 'FilterBar') {\n      return;\n    }\n  };\n\n  Filter.prototype.getLocalizedCustomOperators = function () {\n    var numOptr = [{\n      value: 'equal',\n      text: this.l10n.getConstant('Equal')\n    }, {\n      value: 'greaterthan',\n      text: this.l10n.getConstant('GreaterThan')\n    }, {\n      value: 'greaterthanorequal',\n      text: this.l10n.getConstant('GreaterThanOrEqual')\n    }, {\n      value: 'lessthan',\n      text: this.l10n.getConstant('LessThan')\n    }, {\n      value: 'lessthanorequal',\n      text: this.l10n.getConstant('LessThanOrEqual')\n    }, {\n      value: 'notequal',\n      text: this.l10n.getConstant('NotEqual')\n    }];\n    this.customOperators = {\n      stringOperator: [{\n        value: 'startswith',\n        text: this.l10n.getConstant('StartsWith')\n      }, {\n        value: 'endswith',\n        text: this.l10n.getConstant('EndsWith')\n      }, {\n        value: 'contains',\n        text: this.l10n.getConstant('Contains')\n      }, {\n        value: 'equal',\n        text: this.l10n.getConstant('Equal')\n      }, {\n        value: 'notequal',\n        text: this.l10n.getConstant('NotEqual')\n      }],\n      numberOperator: numOptr,\n      dateOperator: numOptr,\n      datetimeOperator: numOptr,\n      booleanOperator: [{\n        value: 'equal',\n        text: this.l10n.getConstant('Equal')\n      }, {\n        value: 'notequal',\n        text: this.l10n.getConstant('NotEqual')\n      }]\n    };\n  };\n\n  ;\n  /** @hidden */\n\n  Filter.prototype.openMenuByField = function (field) {\n    var gObj = this.parent;\n    var column = gObj.getColumnByField(field);\n    var header = gObj.getColumnHeaderByField(field);\n    var target = header.querySelector('.e-filtermenudiv');\n\n    if (!target) {\n      return;\n    }\n\n    var gClient = gObj.element.getBoundingClientRect();\n    var fClient = target.getBoundingClientRect();\n    this.filterDialogOpen(column, target, fClient.right - gClient.left, fClient.bottom - gClient.top);\n  };\n\n  Filter.prototype.filterIconClickHandler = function (e) {\n    var target = e.target;\n\n    if (target.classList.contains('e-filtermenudiv') && (this.parent.filterSettings.type === 'Menu' || this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel')) {\n      var gObj = this.parent;\n      var col = gObj.getColumnByUid(parentsUntil(target, 'e-headercell').firstElementChild.getAttribute('e-mappinguid'));\n      this.column = col;\n\n      if (this.fltrDlgDetails.field === col.field && this.fltrDlgDetails.isOpen) {\n        return;\n      }\n\n      if (this.filterModule) {\n        this.filterModule.closeDialog();\n      }\n\n      this.fltrDlgDetails = {\n        field: col.field,\n        isOpen: true\n      };\n      this.openMenuByField(col.field);\n    }\n  };\n\n  Filter.prototype.clickHandler = function (e) {\n    if (this.filterSettings.mode === 'Immediate' || this.parent.filterSettings.type === 'Menu' || this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel') {\n      var gObj = this.parent;\n      var target = e.target;\n      var datepickerEle = target.classList.contains('e-day'); // due to datepicker popup cause\n\n      var dialog = parentsUntil(this.parent.element, 'e-dialog');\n      var hasDialog = false;\n      var popupEle = parentsUntil(target, 'e-popup');\n\n      if (dialog && popupEle) {\n        hasDialog = dialog.id === popupEle.id;\n      }\n\n      if (parentsUntil(target, 'e-filter-popup') || target.classList.contains('e-filtermenudiv')) {\n        return;\n      } else if (this.filterModule && !parentsUntil(target, 'e-popup-wrapper') && !closest(target, '.e-filter-item.e-menu-item') && !datepickerEle) {\n        if (hasDialog && !parentsUntil(target, 'e-filter-popup') && !parentsUntil(target, 'e-popup-flmenu') || !popupEle) {\n          this.filterModule.isresetFocus = parentsUntil(target, 'e-grid') && parentsUntil(target, 'e-grid').id === this.parent.element.id;\n          this.filterModule.closeDialog(target);\n        }\n      }\n\n      if (this.filterSettings.mode === 'Immediate' && target.classList.contains('e-clear-icon')) {\n        var targetText = target.previousElementSibling;\n        this.removeFilteredColsByField(targetText.id.slice(0, -14)); //Length of _filterBarcell = 14\n      }\n    }\n  };\n\n  Filter.prototype.filterHandler = function (args) {\n    var filterIconElement;\n    this.actualPredicate[args.field] = args.actualPredicate;\n    var dataManager = new DataManager(this.filterSettings.columns);\n    var query = new Query().where('field', this.filterOperators.equal, args.field);\n    var result = dataManager.executeLocal(query);\n\n    for (var i = 0; i < result.length; i++) {\n      var index = -1;\n\n      for (var j = 0; j < this.filterSettings.columns.length; j++) {\n        if (result[i].field === this.filterSettings.columns[j].field) {\n          index = j;\n          break;\n        }\n      }\n\n      if (index !== -1) {\n        this.filterSettings.columns.splice(index, 1);\n      }\n    }\n\n    if (args.action === 'clear-filter' && isBlazor() && !this.parent.isJsComponent) {\n      this.filterSettings.columns = this.filterSettings.columns;\n    }\n\n    if (this.values[args.field]) {\n      delete this.values[args.field];\n    }\n\n    var iconClass = this.parent.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n    filterIconElement = this.parent.getColumnHeaderByField(args.field).querySelector(iconClass);\n\n    if (args.action === 'filtering') {\n      this.filterSettings.columns = this.filterSettings.columns.concat(args.filterCollection);\n\n      if (this.filterSettings.columns.length && filterIconElement) {\n        filterIconElement.classList.add('e-filtered');\n      }\n    } else {\n      if (filterIconElement) {\n        filterIconElement.classList.remove('e-filtered');\n      }\n\n      this.parent.renderModule.refresh(); //hot-fix onpropertychanged not working for object { array }           \n    }\n\n    this.parent.dataBind();\n  };\n\n  Filter.prototype.updateFilter = function () {\n    var cols = this.filterSettings.columns;\n    this.actualPredicate = {};\n\n    for (var i = 0; i < cols.length; i++) {\n      this.column = this.parent.getColumnByField(cols[i].field) || getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns());\n      var fieldName = cols[i].field;\n\n      if (!this.parent.getColumnByField(cols[i].field)) {\n        fieldName = getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns()).field;\n      }\n      /* tslint:disable-next-line:max-line-length */\n\n\n      this.refreshFilterIcon(fieldName, cols[i].operator, cols[i].value, cols[i].type, cols[i].predicate, cols[i].matchCase, cols[i].ignoreAccent, cols[i].uid);\n    }\n  };\n  /* tslint:disable-next-line:max-line-length */\n\n\n  Filter.prototype.refreshFilterIcon = function (fieldName, operator, value, type, predicate, matchCase, ignoreAccent, uid) {\n    var obj;\n    obj = {\n      field: fieldName,\n      predicate: predicate,\n      matchCase: matchCase,\n      ignoreAccent: ignoreAccent,\n      operator: operator,\n      value: value,\n      type: type\n    };\n    this.actualPredicate[fieldName] ? this.actualPredicate[fieldName].push(obj) : this.actualPredicate[fieldName] = [obj];\n    var field = uid ? this.parent.grabColumnByUidFromAllCols(uid).field : fieldName;\n    this.addFilteredClass(field);\n  };\n\n  Filter.prototype.addFilteredClass = function (fieldName) {\n    var filterIconElement;\n\n    if (this.parent.showColumnMenu) {\n      filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-columnmenu');\n    } else if (this.parent.getColumnByField(fieldName)) {\n      filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-icon-filter');\n    }\n\n    if (filterIconElement) {\n      filterIconElement.classList.add('e-filtered');\n    }\n  };\n\n  return Filter;\n}();\n\nexport { Filter };","map":{"version":3,"sources":["C:/CN2/workspace-trunk/kain-front-end/node_modules/@syncfusion/ej2-grids/src/grid/actions/filter.js"],"names":["EventHandler","isNullOrUndefined","extend","closest","getValue","getActualPropFromColl","isActionPrevent","getColumnByForeignKeyValue","remove","matches","isBlazor","DataUtil","Query","DataManager","events","CellType","RowRenderer","Cell","Row","FilterCellRenderer","parentsUntil","FilterMenuRenderer","CheckBoxFilter","ExcelFilter","Filter","parent","filterSettings","serviceLocator","predicate","contentRefresh","refresh","values","cellText","nextFlMenuOpen","type","filterOperators","contains","endsWith","equal","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","notEqual","startsWith","fltrDlgDetails","field","isOpen","skipNumberInput","skipStringInput","actualPredicate","addEventListener","prototype","render","e","getObject","gObj","l10n","getService","getLocalizedCustomOperators","columns","length","fltrElem","element","querySelector","rowRenderer","row","cellrender","addCellRenderer","valueFormatter","createElement","className","generateRow","data","getHeaderContent","appendChild","rowdrag","getColumns","detail","gCells","slice","call","querySelectorAll","classList","add","wireEvents","notify","freezeRender","case","destroy","gridElement","filterModule","refreshing","updateFilterMsg","removeEventListener","unWireEvents","filterBarElement","getFrozenColumns","index","options","cells","generateCells","allowGrouping","c","len","groupSettings","push","generateCell","HeaderIndent","detailTemplate","childGrid","DetailHeader","isRowDragable","RowDragHIcon","_i","_a","dummy","column","cellType","opt","visible","title","getConstant","updateModel","col","getColumnByField","fieldName","isForeignColumn","foreignKeyValue","currentFilterObject","uid","isForeignKey","operator","value","matchCase","ignoreAccent","actualFilterValue","actualOperator","getFilteredColsIndexByField","dataBind","cols","i","getColumnByUid","onActionComplete","isJsComponent","rows","args","isRemove","currentFilteringColumn","undefined","requestType","actionComplete","trigger","keyUpHandler","enableAfterRender","module","getModuleName","enable","getHeaderTable","initialEnd","off","contentReady","initialLoad","filterByColumn","isDestroyed","on","uiUpdate","filterComplete","inBoundModelChanged","onPropertyChanged","keyPressed","columnPositionChanged","headerRefreshed","filterMenuClose","document","clickHandler","filterOpen","columnMenuFilter","click","filterIconClickHandler","filterOperator","filterValue","filterCell","grabColumnByFieldFromAllCols","allowFiltering","log","moduleName","columnName","headerText","preventBatch","instance","handler","arg1","arg2","arg3","arg4","arg5","arg6","arg7","arg8","toString","getColumnHeaderByField","setAttribute","checkForSkipInput","filterStatusMsg","format","applyColumnFormat","addFilteredClass","checkAlreadyColFiltered","getFlvalue","Date","parseFloat","setFormatForFlColumn","Object","keys","properties","prop","modelChanged","action","actionBegin","cancel","refreshFilterSettings","updateFilter","allowPaging","updateExternalMessage","refreshHeader","grabColumnByUidFromAllCols","key","filterElement","getFilterBarElement","selector","refreshFilter","clearFiltering","_this","forEach","colUid","map","f","filteredcols","filter","item","pos","indexOf","removeFilteredColsByField","renderModule","fltrElement","removeAttribute","columns_1","ele","target","id","isClose","closeDialog","filterDialogOpen","left","top","customOperators","dataSource","getDataModule","dataManager","openDialog","displayName","height","filteredColumns","formatFn","getFormatter","parserFn","getParser","query","template","getFilterItemTemplate","hideSearchbox","filterHandler","bind","localizedStrings","getLocaleConstants","position","X","Y","localeObj","isRemote","allowCaseSensitive","enableCaseSensitivity","isClearFilterBar","fCell","filteredColsUid","len_1","splice","iconClass","showColumnMenu","cloneActualPredicate","currentFilterColumn","closeHeaderEle","getAttribute","mode","keyCode","trim","processFilter","focusModule","currentInfo","firstElementChild","openMenuByField","clearIndicator","restoreFocus","updateCrossIcon","nextElementSibling","getFormatFlValue","formater","showFilterBarStatus","flValue","fromView","formater_1","toView","isSkip","operatorSymbols","value_1","val","stopTimer","startTimer","timer","window","setInterval","onTimerTick","immediateModeDelay","clearInterval","filterBarTemplate","templateRead","read","JSON","parse","stringify","validateFilterValue","skipInput","getOperator","substring","isNaN","charAt","toLowerCase","singleOp","multipleOp","operators","hasOwnProperty","numOptr","text","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","header","gClient","getBoundingClientRect","fClient","right","bottom","datepickerEle","dialog","hasDialog","popupEle","isresetFocus","targetText","previousElementSibling","filterIconElement","where","result","executeLocal","j","concat","filterCollection","getForeignKeyColumns","refreshFilterIcon","obj"],"mappings":"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","sourcesContent":["import { EventHandler, isNullOrUndefined, extend, closest, getValue } from '@syncfusion/ej2-base';\nimport { getActualPropFromColl, isActionPrevent, getColumnByForeignKeyValue } from '../base/util';\nimport { remove, matches, isBlazor } from '@syncfusion/ej2-base';\nimport { DataUtil, Query, DataManager } from '@syncfusion/ej2-data';\nimport * as events from '../base/constant';\nimport { CellType } from '../base/enum';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { Cell } from '../models/cell';\nimport { Row } from '../models/row';\nimport { FilterCellRenderer } from '../renderer/filter-cell-renderer';\nimport { parentsUntil } from '../base/util';\nimport { FilterMenuRenderer } from '../renderer/filter-menu-renderer';\nimport { CheckBoxFilter } from '../actions/checkbox-filter';\nimport { ExcelFilter } from '../actions/excel-filter';\n/**\n *\n * The `Filter` module is used to handle filtering action.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for Grid filtering module\n     * @hidden\n     */\n    function Filter(parent, filterSettings, serviceLocator) {\n        this.predicate = 'and';\n        this.contentRefresh = true;\n        this.refresh = true;\n        this.values = {};\n        this.cellText = {};\n        this.nextFlMenuOpen = '';\n        this.type = { 'Menu': FilterMenuRenderer, 'CheckBox': CheckBoxFilter, 'Excel': ExcelFilter };\n        /** @hidden */\n        this.filterOperators = {\n            contains: 'contains', endsWith: 'endswith', equal: 'equal', greaterThan: 'greaterthan', greaterThanOrEqual: 'greaterthanorequal',\n            lessThan: 'lessthan', lessThanOrEqual: 'lessthanorequal', notEqual: 'notequal', startsWith: 'startswith'\n        };\n        this.fltrDlgDetails = { field: '', isOpen: false };\n        /** @hidden */\n        this.skipNumberInput = ['=', ' ', '!'];\n        this.skipStringInput = ['>', '<', '='];\n        this.actualPredicate = {};\n        this.parent = parent;\n        this.filterSettings = filterSettings;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n    }\n    /**\n     * To render filter bar when filtering enabled.\n     * @return {void}\n     * @hidden\n     */\n    Filter.prototype.render = function (e) {\n        if (DataUtil.getObject('args.isFrozen', e)) {\n            return;\n        }\n        var gObj = this.parent;\n        this.l10n = this.serviceLocator.getService('localization');\n        this.getLocalizedCustomOperators();\n        if (this.parent.filterSettings.type === 'FilterBar') {\n            if (gObj.columns.length) {\n                var fltrElem = this.parent.element.querySelector('.e-filterbar');\n                if (fltrElem) {\n                    remove(fltrElem);\n                }\n                var rowRenderer = new RowRenderer(this.serviceLocator, CellType.Filter, gObj);\n                var row = void 0;\n                var cellrender = this.serviceLocator.getService('cellRendererFactory');\n                cellrender.addCellRenderer(CellType.Filter, new FilterCellRenderer(this.parent, this.serviceLocator));\n                this.valueFormatter = this.serviceLocator.getService('valueFormatter');\n                rowRenderer.element = this.parent.createElement('tr', { className: 'e-filterbar' });\n                row = this.generateRow();\n                row.data = this.values;\n                this.parent.getHeaderContent().querySelector('thead').appendChild(rowRenderer.element);\n                var rowdrag = this.parent.element.querySelector('.e-rowdragheader');\n                this.element = rowRenderer.render(row, gObj.getColumns(), null, null, rowRenderer.element);\n                var detail = this.element.querySelector('.e-detailheadercell');\n                if (detail) {\n                    detail.className = 'e-filterbarcell e-mastercell';\n                }\n                if (rowdrag) {\n                    rowdrag.className = 'e-dragheadercell e-mastercell';\n                }\n                var gCells = [].slice.call(this.element.querySelectorAll('.e-grouptopleftcell'));\n                if (gCells.length) {\n                    gCells[gCells.length - 1].classList.add('e-lastgrouptopleftcell');\n                }\n                this.wireEvents();\n                this.parent.notify(events.freezeRender, { case: 'filter' });\n            }\n        }\n    };\n    /**\n     * To destroy the filter bar.\n     * @return {void}\n     * @hidden\n     */\n    Filter.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent'))) {\n            return;\n        }\n        if (this.filterModule) {\n            this.filterModule.destroy();\n        }\n        // tslint:disable-next-line:no-any\n        if (!this.parent.refreshing) {\n            this.filterSettings.columns = [];\n        }\n        this.updateFilterMsg();\n        this.removeEventListener();\n        this.unWireEvents();\n        if (this.element) {\n            remove(this.element);\n            var filterBarElement = this.parent.getHeaderContent().querySelector('.e-filterbar');\n            if (this.parent.getFrozenColumns() && filterBarElement) {\n                remove(filterBarElement);\n            }\n        }\n    };\n    Filter.prototype.generateRow = function (index) {\n        var options = {};\n        var row = new Row(options);\n        row.cells = this.generateCells();\n        return row;\n    };\n    Filter.prototype.generateCells = function () {\n        //TODO: generate dummy column for group, detail, stacked row here for filtering;\n        var cells = [];\n        if (this.parent.allowGrouping) {\n            for (var c = 0, len = this.parent.groupSettings.columns.length; c < len; c++) {\n                cells.push(this.generateCell({}, CellType.HeaderIndent));\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            cells.push(this.generateCell({}, CellType.DetailHeader));\n        }\n        if (this.parent.isRowDragable()) {\n            cells.push(this.generateCell({}, CellType.RowDragHIcon));\n        }\n        for (var _i = 0, _a = this.parent.getColumns(); _i < _a.length; _i++) {\n            var dummy = _a[_i];\n            cells.push(this.generateCell(dummy));\n        }\n        return cells;\n    };\n    Filter.prototype.generateCell = function (column, cellType) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': false,\n            'rowId': '',\n            'column': column,\n            'cellType': cellType ? cellType : CellType.Filter,\n            'attributes': { title: this.l10n.getConstant('FilterbarTitle') }\n        };\n        return new Cell(opt);\n    };\n    /**\n     * To update filterSettings when applying filter.\n     * @return {void}\n     * @hidden\n     */\n    Filter.prototype.updateModel = function () {\n        var col = this.parent.getColumnByField(this.fieldName);\n        var field = col.isForeignColumn() ? col.foreignKeyValue : this.fieldName;\n        this.currentFilterObject = {\n            field: field, uid: col.uid, isForeignKey: col.isForeignColumn(), operator: this.operator,\n            value: this.value, predicate: this.predicate,\n            matchCase: this.matchCase, ignoreAccent: this.ignoreAccent, actualFilterValue: {}, actualOperator: {}\n        };\n        var index = this.getFilteredColsIndexByField(col);\n        if (index > -1) {\n            this.filterSettings.columns[index] = this.currentFilterObject;\n        }\n        else {\n            this.filterSettings.columns.push(this.currentFilterObject);\n        }\n        this.filterSettings.columns = this.filterSettings.columns;\n        this.parent.dataBind();\n    };\n    Filter.prototype.getFilteredColsIndexByField = function (col) {\n        var cols = this.filterSettings.columns;\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (cols[i].uid === col.uid || (col.isForeignColumn() && this.parent.getColumnByUid(col.uid).field === col.foreignKeyValue)) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /**\n     * To trigger action complete event.\n     * @return {void}\n     * @hidden\n     */\n    Filter.prototype.onActionComplete = function (e) {\n        if (isBlazor() && !this.parent.isJsComponent) {\n            e.rows = null;\n        }\n        var args = !this.isRemove ? {\n            currentFilterObject: this.currentFilterObject,\n            /* tslint:disable:no-string-literal */\n            currentFilteringColumn: !isNullOrUndefined(this.column) ? this.column.field : undefined,\n            /* tslint:enable:no-string-literal */\n            columns: this.filterSettings.columns, requestType: 'filtering', type: events.actionComplete\n        } : {\n            requestType: 'filtering', type: events.actionComplete\n        };\n        this.parent.trigger(events.actionComplete, extend(e, args));\n        this.isRemove = false;\n    };\n    Filter.prototype.wireEvents = function () {\n        EventHandler.add(this.parent.getHeaderContent(), 'keyup', this.keyUpHandler, this);\n    };\n    Filter.prototype.unWireEvents = function () {\n        EventHandler.remove(this.parent.getHeaderContent(), 'keyup', this.keyUpHandler);\n    };\n    Filter.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.parent.getHeaderTable().classList.add('e-sortfilter');\n            this.render();\n        }\n    };\n    Filter.prototype.initialEnd = function () {\n        this.parent.off(events.contentReady, this.initialEnd);\n        if (this.parent.getColumns().length && this.filterSettings.columns.length) {\n            var gObj = this.parent;\n            this.contentRefresh = false;\n            this.initialLoad = true;\n            for (var _i = 0, _a = gObj.filterSettings.columns; _i < _a.length; _i++) {\n                var col = _a[_i];\n                this.filterByColumn(col.field, col.operator, col.value, col.predicate, col.matchCase, col.ignoreAccent, col.actualFilterValue, col.actualOperator);\n            }\n            this.initialLoad = false;\n            this.updateFilterMsg();\n            this.contentRefresh = true;\n        }\n    };\n    /**\n     * @hidden\n     */\n    Filter.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n        this.parent.on(events.filterComplete, this.onActionComplete, this);\n        this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n        this.parent.on(events.keyPressed, this.keyUpHandler, this);\n        this.parent.on(events.columnPositionChanged, this.columnPositionChanged, this);\n        this.parent.on(events.headerRefreshed, this.render, this);\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.filterMenuClose, this.filterMenuClose, this);\n        EventHandler.add(document, 'click', this.clickHandler, this);\n        this.parent.on(events.filterOpen, this.columnMenuFilter, this);\n        this.parent.on(events.click, this.filterIconClickHandler, this);\n    };\n    /**\n     * @hidden\n     */\n    Filter.prototype.removeEventListener = function () {\n        EventHandler.remove(document, 'click', this.clickHandler);\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.uiUpdate, this.enableAfterRender);\n        this.parent.off(events.filterComplete, this.onActionComplete);\n        this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n        this.parent.off(events.keyPressed, this.keyUpHandler);\n        this.parent.off(events.columnPositionChanged, this.columnPositionChanged);\n        this.parent.off(events.headerRefreshed, this.render);\n        this.parent.off(events.filterOpen, this.columnMenuFilter);\n        this.parent.off(events.filterMenuClose, this.filterMenuClose);\n        this.parent.off(events.click, this.filterIconClickHandler);\n    };\n    Filter.prototype.filterMenuClose = function (args) {\n        this.fltrDlgDetails.isOpen = false;\n    };\n    /**\n     * Filters the Grid row by fieldName, filterOperator, and filterValue.\n     * @param  {string} fieldName - Defines the field name of the filter column.\n     * @param  {string} filterOperator - Defines the operator to filter records.\n     * @param  {string | number | Date | boolean} filterValue - Defines the value which is used to filter records.\n     * @param  {string} predicate - Defines the relationship of one filter query with another by using AND or OR predicate.\n     * @param  {boolean} matchCase - If match case is set to true, then the filter records\n     * the exact match or <br> filters records that are case insensitive (uppercase and lowercase letters treated the same).\n     * @param {boolean} ignoreAccent - If ignoreAccent set to true, then filter ignores the diacritic characters or accents while filtering.\n     * @param  {string} actualFilterValue - Defines the actual filter value for the filter column.\n     * @param  {string} actualOperator - Defines the actual filter operator for the filter column.\n     * @return {void}\n     */\n    Filter.prototype.filterByColumn = function (fieldName, filterOperator, filterValue, predicate, matchCase, ignoreAccent, actualFilterValue, actualOperator) {\n        var gObj = this.parent;\n        var filterCell;\n        this.column = gObj.grabColumnByFieldFromAllCols(fieldName);\n        if (!this.column) {\n            return;\n        }\n        if (this.filterSettings.type === 'FilterBar') {\n            filterCell = gObj.getHeaderContent().querySelector('[id=\\'' + this.column.field + '_filterBarcell\\']');\n        }\n        if (!isNullOrUndefined(this.column.allowFiltering) && !this.column.allowFiltering) {\n            this.parent.log('action_disabled_column', { moduleName: this.getModuleName(), columnName: this.column.headerText });\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, {\n                instance: this, handler: this.filterByColumn, arg1: fieldName, arg2: filterOperator, arg3: filterValue, arg4: predicate,\n                arg5: matchCase, arg6: ignoreAccent, arg7: actualFilterValue, arg8: actualOperator\n            });\n            return;\n        }\n        this.value = filterValue;\n        this.matchCase = matchCase || false;\n        this.ignoreAccent = this.ignoreAccent = !isNullOrUndefined(ignoreAccent) ? ignoreAccent : this.parent.filterSettings.ignoreAccent;\n        this.fieldName = fieldName;\n        this.predicate = predicate || 'and';\n        this.operator = filterOperator;\n        filterValue = !isNullOrUndefined(filterValue) && filterValue.toString();\n        if (this.column.type === 'number' || this.column.type === 'date') {\n            this.matchCase = true;\n        }\n        gObj.getColumnHeaderByField(fieldName).setAttribute('aria-filtered', 'true');\n        if (filterValue.length < 1 || this.checkForSkipInput(this.column, filterValue)) {\n            this.filterStatusMsg = filterValue.length < 1 ? '' : this.l10n.getConstant('InvalidFilterMessage');\n            this.updateFilterMsg();\n            return;\n        }\n        if (filterCell && this.filterSettings.type === 'FilterBar' && filterCell.value !== filterValue) {\n            filterCell.value = filterValue;\n        }\n        if (!isNullOrUndefined(this.column.format)) {\n            this.applyColumnFormat(filterValue);\n            if (this.initialLoad && this.filterSettings.type === 'FilterBar') {\n                filterCell.value = this.values[this.column.field];\n            }\n        }\n        else {\n            this.values[this.column.field] = filterValue; //this line should be above updateModel\n        }\n        this.actualPredicate[this.fieldName] = [{\n                field: this.fieldName,\n                predicate: predicate,\n                matchCase: matchCase,\n                ignoreAccent: ignoreAccent,\n                operator: this.operator,\n                value: this.value,\n                type: this.column.type\n            }];\n        this.addFilteredClass(this.fieldName);\n        if (this.checkAlreadyColFiltered(this.column.field)) {\n            return;\n        }\n        this.updateModel();\n    };\n    Filter.prototype.applyColumnFormat = function (filterValue) {\n        var getFlvalue = (this.column.type === 'date' || this.column.type === 'datetime') ?\n            new Date(filterValue) : parseFloat(filterValue);\n        this.values[this.column.field] = this.setFormatForFlColumn(getFlvalue, this.column);\n    };\n    Filter.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'columns':\n                    if (this.contentRefresh) {\n                        this.parent.notify(events.modelChanged, {\n                            currentFilterObject: this.currentFilterObject, currentFilteringColumn: this.column ?\n                                this.column.field : undefined, action: 'filter',\n                            columns: this.filterSettings.columns, requestType: 'filtering', type: events.actionBegin, cancel: false\n                        });\n                        this.refreshFilterSettings();\n                        this.updateFilterMsg();\n                        this.updateFilter();\n                    }\n                    break;\n                case 'showFilterBarStatus':\n                    if (e.properties[prop]) {\n                        this.updateFilterMsg();\n                    }\n                    else if (this.parent.allowPaging) {\n                        this.parent.updateExternalMessage('');\n                    }\n                    break;\n                case 'type':\n                    this.parent.refreshHeader();\n                    this.refreshFilterSettings();\n                    break;\n            }\n        }\n    };\n    Filter.prototype.refreshFilterSettings = function () {\n        if (this.filterSettings.type === 'FilterBar') {\n            for (var i = 0; i < this.filterSettings.columns.length; i++) {\n                this.column = this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[i].uid);\n                var filterValue = this.filterSettings.columns[i].value;\n                filterValue = !isNullOrUndefined(filterValue) && filterValue.toString();\n                if (!isNullOrUndefined(this.column.format)) {\n                    this.applyColumnFormat(filterValue);\n                }\n                else {\n                    var key = this.filterSettings.columns[i].field;\n                    this.values[key] = this.filterSettings.columns[i].value;\n                }\n                var filterElement = this.getFilterBarElement(this.column.field);\n                if (filterElement) {\n                    if (this.cellText[this.filterSettings.columns[i].field] !== ''\n                        && !isNullOrUndefined(this.cellText[this.filterSettings.columns[i].field])) {\n                        filterElement.value = this.cellText[this.column.field];\n                    }\n                    else {\n                        filterElement.value = this.filterSettings.columns[i].value;\n                    }\n                }\n            }\n            if (this.filterSettings.columns.length === 0) {\n                var col = this.parent.getColumns();\n                for (var i = 0; i < col.length; i++) {\n                    var filterElement = this.getFilterBarElement(col[i].field);\n                    if (filterElement && filterElement.value !== '') {\n                        filterElement.value = '';\n                        delete this.values[col[i].field];\n                    }\n                }\n            }\n        }\n    };\n    Filter.prototype.getFilterBarElement = function (col) {\n        var selector = '[id=\\'' + col + '_filterBarcell\\']';\n        var filterElement;\n        if (selector && !isNullOrUndefined(this.element)) {\n            filterElement = this.element.querySelector(selector);\n        }\n        return filterElement;\n    };\n    /**\n     * @private\n     */\n    Filter.prototype.refreshFilter = function () {\n        this.refreshFilterSettings();\n        this.updateFilterMsg();\n    };\n    /**\n     * Clears all the filtered rows of the Grid.\n     * @return {void}\n     */\n    Filter.prototype.clearFiltering = function () {\n        var _this = this;\n        var cols = getActualPropFromColl(this.filterSettings.columns);\n        if (isActionPrevent(this.parent)) {\n            this.parent.notify(events.preventBatch, { instance: this, handler: this.clearFiltering });\n            return;\n        }\n        cols.forEach(function (col) {\n            col.uid = col.uid || _this.parent.getColumnByField(col.field).uid;\n        });\n        var colUid = cols.map(function (f) { return f.uid; });\n        var filteredcols = colUid.filter(function (item, pos) { return colUid.indexOf(item) === pos; });\n        this.refresh = false;\n        for (var i = 0, len = filteredcols.length; i < len; i++) {\n            this.removeFilteredColsByField(this.parent.getColumnByUid(filteredcols[i]).field, false);\n        }\n        if (isBlazor() && !this.parent.isJsComponent) {\n            this.filterSettings.columns = this.filterSettings.columns;\n        }\n        this.refresh = true;\n        if (filteredcols.length) {\n            this.parent.renderModule.refresh();\n        }\n        if (this.parent.filterSettings.columns.length === 0 && this.parent.element.querySelector('.e-filtered')) {\n            var fltrElement = [].slice.call(this.parent.element.querySelectorAll('.e-filtered'));\n            for (var i = 0, len = fltrElement.length; i < len; i++) {\n                fltrElement[0].removeAttribute('aria-filtered');\n                fltrElement[0].classList.remove('e-filtered');\n            }\n        }\n        this.isRemove = true;\n        this.filterStatusMsg = '';\n        this.updateFilterMsg();\n    };\n    Filter.prototype.checkAlreadyColFiltered = function (field) {\n        var columns = this.filterSettings.columns;\n        for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n            var col = columns_1[_i];\n            if (col.field === field && col.value === this.value &&\n                col.operator === this.operator && col.predicate === this.predicate) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Filter.prototype.columnMenuFilter = function (args) {\n        this.column = args.col;\n        var ele = closest(args.target, '#' + args.id);\n        if (args.isClose && !ele) {\n            this.filterModule.closeDialog();\n        }\n        else if (ele) {\n            this.filterDialogOpen(this.column, args.target);\n        }\n    };\n    Filter.prototype.filterDialogOpen = function (col, target, left, top) {\n        var gObj = this.parent;\n        if (this.filterModule) {\n            this.filterModule.closeDialog();\n        }\n        this.filterModule = new this.type[col.filter.type || this.parent.filterSettings.type](this.parent, gObj.filterSettings, this.serviceLocator, this.customOperators, this);\n        var dataSource = col.filter.dataSource || gObj.getDataModule().dataManager;\n        this.filterModule.openDialog({\n            type: col.type, field: col.field, displayName: col.headerText,\n            dataSource: dataSource, format: col.format, height: 800, columns: gObj.getColumns(),\n            filteredColumns: gObj.filterSettings.columns, target: target, dataManager: gObj.getDataModule().dataManager,\n            formatFn: col.getFormatter(), ignoreAccent: gObj.filterSettings.ignoreAccent,\n            parserFn: col.getParser(), query: gObj.query, template: col.getFilterItemTemplate(),\n            hideSearchbox: isNullOrUndefined(col.filter.hideSearchbox) ? false : col.filter.hideSearchbox,\n            handler: this.filterHandler.bind(this), localizedStrings: gObj.getLocaleConstants(),\n            position: { X: left, Y: top }, column: col, foreignKeyValue: col.foreignKeyValue,\n            actualPredicate: this.actualPredicate, localeObj: gObj.localeObj,\n            isRemote: gObj.getDataModule().isRemote(), allowCaseSensitive: this.filterSettings.enableCaseSensitivity\n        });\n    };\n    /**\n     * Removes filtered column by field name.\n     * @param  {string} field - Defines column field name to remove filter.\n     * @param  {boolean} isClearFilterBar -  Specifies whether the filter bar value needs to be cleared.\n     * @return {void}\n     * @hidden\n     */\n    Filter.prototype.removeFilteredColsByField = function (field, isClearFilterBar) {\n        var fCell;\n        var cols = this.filterSettings.columns;\n        if (isActionPrevent(this.parent)) {\n            var args = { instance: this, handler: this.removeFilteredColsByField, arg1: field, arg2: isClearFilterBar };\n            this.parent.notify(events.preventBatch, args);\n            return;\n        }\n        var colUid = cols.map(function (f) { return f.uid; });\n        var filteredColsUid = colUid.filter(function (item, pos) { return colUid.indexOf(item) === pos; });\n        for (var i = 0, len = filteredColsUid.length; i < len; i++) {\n            cols[i].uid = cols[i].uid || this.parent.getColumnByField(cols[i].field).uid;\n            var len_1 = cols.length;\n            var column = this.parent.grabColumnByUidFromAllCols(filteredColsUid[i]);\n            if (column.field === field || (column.field === column.foreignKeyValue && column.isForeignColumn())) {\n                if (this.filterSettings.type === 'FilterBar' && !isClearFilterBar) {\n                    var selector = '[id=\\'' + column.field + '_filterBarcell\\']';\n                    fCell = this.parent.getHeaderContent().querySelector(selector);\n                    if (fCell) {\n                        fCell.value = '';\n                        delete this.values[field];\n                    }\n                }\n                while (len_1--) {\n                    if (cols[len_1].uid === column.uid) {\n                        cols.splice(len_1, 1);\n                    }\n                }\n                var fltrElement = this.parent.getColumnHeaderByField(column.field);\n                fltrElement.removeAttribute('aria-filtered');\n                if (this.filterSettings.type !== 'FilterBar') {\n                    var iconClass = this.parent.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n                    fltrElement.querySelector(iconClass).classList.remove('e-filtered');\n                }\n                var cloneActualPredicate = void 0;\n                column.isForeignColumn() ? cloneActualPredicate = extend({}, this.actualPredicate[column.foreignKeyValue][0]) :\n                    cloneActualPredicate = extend({}, this.actualPredicate[field][0]);\n                this.isRemove = true;\n                if (this.actualPredicate[field]) {\n                    delete this.actualPredicate[field];\n                }\n                if (this.values[field]) {\n                    delete this.values[field];\n                }\n                if (this.refresh) {\n                    this.parent.notify(events.modelChanged, {\n                        requestType: 'filtering', type: events.actionBegin, currentFilterObject: cloneActualPredicate,\n                        currentFilterColumn: column, action: 'clearFilter'\n                    });\n                }\n                break;\n            }\n        }\n        this.updateFilterMsg();\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    Filter.prototype.keyUpHandler = function (e) {\n        var gObj = this.parent;\n        var target = e.target;\n        if (target && matches(target, '.e-filterbar input')) {\n            var closeHeaderEle = closest(target, 'th.e-filterbarcell');\n            this.column = gObj.getColumnByUid(closeHeaderEle.getAttribute('e-mappinguid'));\n            if (!this.column) {\n                return;\n            }\n            if ((this.filterSettings.mode === 'Immediate' || e.keyCode === 13) && e.keyCode !== 9) {\n                this.value = target.value.trim();\n                this.processFilter(e);\n            }\n        }\n        if (e.action === 'altDownArrow' && this.filterSettings.type !== 'FilterBar') {\n            var element = gObj.focusModule.currentInfo.element;\n            if (element && element.classList.contains('e-headercell')) {\n                var column = gObj.getColumnByUid(element.firstElementChild.getAttribute('e-mappinguid'));\n                this.openMenuByField(column.field);\n                this.parent.focusModule.clearIndicator();\n            }\n        }\n        if (e.action === 'escape' && this.filterSettings.type === 'Menu') {\n            this.filterModule.closeDialog();\n            gObj.notify(events.restoreFocus, {});\n        }\n    };\n    Filter.prototype.updateCrossIcon = function (element) {\n        if (element.value.length) {\n            element.nextElementSibling.classList.remove('e-hide');\n        }\n    };\n    Filter.prototype.updateFilterMsg = function () {\n        if (this.filterSettings.type === 'FilterBar') {\n            var gObj = this.parent;\n            var getFormatFlValue = void 0;\n            var columns = this.filterSettings.columns;\n            var formater = this.serviceLocator.getService('valueFormatter');\n            var column = void 0;\n            var value = void 0;\n            if (!this.filterSettings.showFilterBarStatus) {\n                return;\n            }\n            if (columns.length > 0 && this.filterStatusMsg !== this.l10n.getConstant('InvalidFilterMessage')) {\n                this.filterStatusMsg = '';\n                for (var index = 0; index < columns.length; index++) {\n                    column = gObj.grabColumnByUidFromAllCols(columns[index].uid) || gObj.grabColumnByFieldFromAllCols(columns[index].field);\n                    if (index) {\n                        this.filterStatusMsg += ' && ';\n                    }\n                    if (!isNullOrUndefined(column.format)) {\n                        var flValue = (column.type === 'date' || column.type === 'datetime') ?\n                            this.valueFormatter.fromView(this.values[column.field], column.getParser(), column.type) :\n                            this.values[column.field];\n                        if (!(column.type === 'date' || column.type === 'datetime')) {\n                            var formater_1 = this.serviceLocator.getService('valueFormatter');\n                            getFormatFlValue = formater_1.toView(flValue, column.getParser()).toString();\n                        }\n                        else {\n                            getFormatFlValue = this.setFormatForFlColumn(flValue, column);\n                        }\n                        this.filterStatusMsg += column.headerText + ': ' + getFormatFlValue;\n                    }\n                    else {\n                        this.filterStatusMsg += column.headerText + ': ' + this.values[column.field];\n                    }\n                }\n            }\n            if (gObj.allowPaging) {\n                gObj.updateExternalMessage(this.filterStatusMsg);\n            }\n            //TODO: virtual paging       \n            this.filterStatusMsg = '';\n        }\n    };\n    Filter.prototype.setFormatForFlColumn = function (value, column) {\n        var formater = this.serviceLocator.getService('valueFormatter');\n        return formater.toView(value, column.getFormatter()).toString();\n    };\n    Filter.prototype.checkForSkipInput = function (column, value) {\n        var isSkip;\n        if (column.type === 'number') {\n            if (DataUtil.operatorSymbols[value] || this.skipNumberInput.indexOf(value) > -1) {\n                isSkip = true;\n            }\n        }\n        else if (column.type === 'string') {\n            for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\n                var val = value_1[_i];\n                if (this.skipStringInput.indexOf(val) > -1) {\n                    isSkip = true;\n                }\n            }\n        }\n        return isSkip;\n    };\n    Filter.prototype.processFilter = function (e) {\n        this.stopTimer();\n        this.startTimer(e);\n    };\n    Filter.prototype.startTimer = function (e) {\n        var _this = this;\n        this.timer = window.setInterval(function () { _this.onTimerTick(); }, e.keyCode === 13 ? 0 : this.filterSettings.immediateModeDelay);\n    };\n    Filter.prototype.stopTimer = function () {\n        window.clearInterval(this.timer);\n    };\n    Filter.prototype.onTimerTick = function () {\n        var selector = '[id=\\'' + this.column.field + '_filterBarcell\\']';\n        var filterElement = this.element.querySelector(selector);\n        if (!filterElement && this.parent.getFrozenColumns()) {\n            filterElement = this.parent.getHeaderContent().querySelector(selector);\n        }\n        var filterValue;\n        this.cellText[this.column.field] = filterElement.value;\n        this.stopTimer();\n        if (!isNullOrUndefined(this.column.filterBarTemplate)) {\n            var templateRead = this.column.filterBarTemplate.read;\n            if (typeof templateRead === 'string') {\n                templateRead = getValue(templateRead, window);\n            }\n            if (!isNullOrUndefined(templateRead)) {\n                this.value = templateRead.call(this, filterElement);\n            }\n        }\n        else {\n            filterValue = JSON.parse(JSON.stringify(filterElement.value));\n        }\n        if (isNullOrUndefined(this.value) || this.value === '') {\n            this.removeFilteredColsByField(this.column.field);\n            if (isBlazor() && !this.parent.isJsComponent) {\n                this.filterSettings.columns = this.filterSettings.columns;\n            }\n            return;\n        }\n        this.validateFilterValue(this.value);\n        this.filterByColumn(this.column.field, this.operator, this.value, this.predicate, this.filterSettings.enableCaseSensitivity, this.ignoreAccent);\n        filterElement.value = filterValue;\n        this.updateFilterMsg();\n    };\n    Filter.prototype.validateFilterValue = function (value) {\n        var gObj = this.parent;\n        var skipInput;\n        var index;\n        this.matchCase = this.filterSettings.enableCaseSensitivity;\n        switch (this.column.type) {\n            case 'number':\n                if (this.column.filter.operator) {\n                    this.operator = this.column.filter.operator;\n                }\n                else {\n                    this.operator = this.filterOperators.equal;\n                }\n                skipInput = ['>', '<', '=', '!'];\n                for (var i = 0; i < value.length; i++) {\n                    if (skipInput.indexOf(value[i]) > -1) {\n                        index = i;\n                        break;\n                    }\n                }\n                this.getOperator(value.substring(index));\n                if (index !== 0) {\n                    this.value = value.substring(0, index);\n                }\n                if (this.value !== '' && value.length >= 1) {\n                    this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n                }\n                if (isNaN(this.value)) {\n                    this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n                }\n                break;\n            case 'date':\n            case 'datetime':\n                this.operator = this.filterOperators.equal;\n                if (this.value !== '' && !(this.value instanceof Date)) {\n                    this.getOperator(value);\n                    this.value = this.valueFormatter.fromView(this.value, this.column.getParser(), this.column.type);\n                    if (isNullOrUndefined(this.value)) {\n                        this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n                    }\n                }\n                break;\n            case 'string':\n                this.matchCase = false;\n                if (value.charAt(0) === '*') {\n                    this.value = this.value.slice(1);\n                    this.operator = this.filterOperators.startsWith;\n                }\n                else if (value.charAt(value.length - 1) === '%') {\n                    this.value = this.value.slice(0, -1);\n                    this.operator = this.filterOperators.startsWith;\n                }\n                else if (value.charAt(0) === '%') {\n                    this.value = this.value.slice(1);\n                    this.operator = this.filterOperators.endsWith;\n                }\n                else {\n                    if (this.column.filter.operator) {\n                        this.operator = this.column.filter.operator;\n                    }\n                    else {\n                        this.operator = this.filterOperators.startsWith;\n                    }\n                }\n                break;\n            case 'boolean':\n                if (value.toLowerCase() === 'true' || value === '1') {\n                    this.value = true;\n                }\n                else if (value.toLowerCase() === 'false' || value === '0') {\n                    this.value = false;\n                }\n                else if (value.length) {\n                    this.filterStatusMsg = this.l10n.getConstant('InvalidFilterMessage');\n                }\n                this.operator = this.filterOperators.equal;\n                break;\n            default:\n                if (this.column.filter.operator) {\n                    this.operator = this.column.filter.operator;\n                }\n                else {\n                    this.operator = this.filterOperators.equal;\n                }\n        }\n    };\n    Filter.prototype.getOperator = function (value) {\n        var singleOp = value.charAt(0);\n        var multipleOp = value.slice(0, 2);\n        var operators = extend({ '=': this.filterOperators.equal, '!': this.filterOperators.notEqual }, DataUtil.operatorSymbols);\n        if (operators.hasOwnProperty(singleOp) || operators.hasOwnProperty(multipleOp)) {\n            this.operator = operators[singleOp];\n            this.value = value.substring(1);\n            if (!this.operator) {\n                this.operator = operators[multipleOp];\n                this.value = value.substring(2);\n            }\n        }\n        if (this.operator === this.filterOperators.lessThan || this.operator === this.filterOperators.greaterThan) {\n            if (this.value.charAt(0) === '=') {\n                this.operator = this.operator + 'orequal';\n                this.value = this.value.substring(1);\n            }\n        }\n    };\n    Filter.prototype.columnPositionChanged = function (e) {\n        if (this.parent.filterSettings.type !== 'FilterBar') {\n            return;\n        }\n    };\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var numOptr = [\n            { value: 'equal', text: this.l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: this.l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: this.l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: this.l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: this.l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: this.l10n.getConstant('NotEqual') }\n        ];\n        this.customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: this.l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: this.l10n.getConstant('EndsWith') },\n                { value: 'contains', text: this.l10n.getConstant('Contains') },\n                { value: 'equal', text: this.l10n.getConstant('Equal') },\n                { value: 'notequal', text: this.l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: this.l10n.getConstant('Equal') },\n                { value: 'notequal', text: this.l10n.getConstant('NotEqual') }\n            ]\n        };\n    };\n    ;\n    /** @hidden */\n    Filter.prototype.openMenuByField = function (field) {\n        var gObj = this.parent;\n        var column = gObj.getColumnByField(field);\n        var header = gObj.getColumnHeaderByField(field);\n        var target = header.querySelector('.e-filtermenudiv');\n        if (!target) {\n            return;\n        }\n        var gClient = gObj.element.getBoundingClientRect();\n        var fClient = target.getBoundingClientRect();\n        this.filterDialogOpen(column, target, fClient.right - gClient.left, fClient.bottom - gClient.top);\n    };\n    Filter.prototype.filterIconClickHandler = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-filtermenudiv') && (this.parent.filterSettings.type === 'Menu' ||\n            this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel')) {\n            var gObj = this.parent;\n            var col = gObj.getColumnByUid(parentsUntil(target, 'e-headercell').firstElementChild.getAttribute('e-mappinguid'));\n            this.column = col;\n            if (this.fltrDlgDetails.field === col.field && this.fltrDlgDetails.isOpen) {\n                return;\n            }\n            if (this.filterModule) {\n                this.filterModule.closeDialog();\n            }\n            this.fltrDlgDetails = { field: col.field, isOpen: true };\n            this.openMenuByField(col.field);\n        }\n    };\n    Filter.prototype.clickHandler = function (e) {\n        if (this.filterSettings.mode === 'Immediate' || this.parent.filterSettings.type === 'Menu' ||\n            this.parent.filterSettings.type === 'CheckBox' || this.parent.filterSettings.type === 'Excel') {\n            var gObj = this.parent;\n            var target = e.target;\n            var datepickerEle = target.classList.contains('e-day'); // due to datepicker popup cause\n            var dialog = parentsUntil(this.parent.element, 'e-dialog');\n            var hasDialog = false;\n            var popupEle = parentsUntil(target, 'e-popup');\n            if (dialog && popupEle) {\n                hasDialog = dialog.id === popupEle.id;\n            }\n            if (parentsUntil(target, 'e-filter-popup') || target.classList.contains('e-filtermenudiv')) {\n                return;\n            }\n            else if (this.filterModule && (!parentsUntil(target, 'e-popup-wrapper')\n                && (!closest(target, '.e-filter-item.e-menu-item'))) && !datepickerEle) {\n                if ((hasDialog && (!parentsUntil(target, 'e-filter-popup'))\n                    && (!parentsUntil(target, 'e-popup-flmenu'))) || (!popupEle)) {\n                    this.filterModule.isresetFocus = parentsUntil(target, 'e-grid') &&\n                        parentsUntil(target, 'e-grid').id === this.parent.element.id;\n                    this.filterModule.closeDialog(target);\n                }\n            }\n            if (this.filterSettings.mode === 'Immediate' && target.classList.contains('e-clear-icon')) {\n                var targetText = target.previousElementSibling;\n                this.removeFilteredColsByField(targetText.id.slice(0, -14)); //Length of _filterBarcell = 14\n            }\n        }\n    };\n    Filter.prototype.filterHandler = function (args) {\n        var filterIconElement;\n        this.actualPredicate[args.field] = args.actualPredicate;\n        var dataManager = new DataManager(this.filterSettings.columns);\n        var query = new Query().where('field', this.filterOperators.equal, args.field);\n        var result = dataManager.executeLocal(query);\n        for (var i = 0; i < result.length; i++) {\n            var index = -1;\n            for (var j = 0; j < this.filterSettings.columns.length; j++) {\n                if (result[i].field === this.filterSettings.columns[j].field) {\n                    index = j;\n                    break;\n                }\n            }\n            if (index !== -1) {\n                this.filterSettings.columns.splice(index, 1);\n            }\n        }\n        if (args.action === 'clear-filter' && isBlazor() && !this.parent.isJsComponent) {\n            this.filterSettings.columns = this.filterSettings.columns;\n        }\n        if (this.values[args.field]) {\n            delete this.values[args.field];\n        }\n        var iconClass = this.parent.showColumnMenu ? '.e-columnmenu' : '.e-icon-filter';\n        filterIconElement = this.parent.getColumnHeaderByField(args.field).querySelector(iconClass);\n        if (args.action === 'filtering') {\n            this.filterSettings.columns = this.filterSettings.columns.concat(args.filterCollection);\n            if (this.filterSettings.columns.length && filterIconElement) {\n                filterIconElement.classList.add('e-filtered');\n            }\n        }\n        else {\n            if (filterIconElement) {\n                filterIconElement.classList.remove('e-filtered');\n            }\n            this.parent.renderModule.refresh(); //hot-fix onpropertychanged not working for object { array }           \n        }\n        this.parent.dataBind();\n    };\n    Filter.prototype.updateFilter = function () {\n        var cols = this.filterSettings.columns;\n        this.actualPredicate = {};\n        for (var i = 0; i < cols.length; i++) {\n            this.column = this.parent.getColumnByField(cols[i].field) ||\n                getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns());\n            var fieldName = cols[i].field;\n            if (!this.parent.getColumnByField(cols[i].field)) {\n                fieldName = getColumnByForeignKeyValue(cols[i].field, this.parent.getForeignKeyColumns()).field;\n            }\n            /* tslint:disable-next-line:max-line-length */\n            this.refreshFilterIcon(fieldName, cols[i].operator, cols[i].value, cols[i].type, cols[i].predicate, cols[i].matchCase, cols[i].ignoreAccent, cols[i].uid);\n        }\n    };\n    /* tslint:disable-next-line:max-line-length */\n    Filter.prototype.refreshFilterIcon = function (fieldName, operator, value, type, predicate, matchCase, ignoreAccent, uid) {\n        var obj;\n        obj = {\n            field: fieldName,\n            predicate: predicate,\n            matchCase: matchCase,\n            ignoreAccent: ignoreAccent,\n            operator: operator,\n            value: value,\n            type: type\n        };\n        this.actualPredicate[fieldName] ? this.actualPredicate[fieldName].push(obj) : this.actualPredicate[fieldName] = [obj];\n        var field = uid ? this.parent.grabColumnByUidFromAllCols(uid).field : fieldName;\n        this.addFilteredClass(field);\n    };\n    Filter.prototype.addFilteredClass = function (fieldName) {\n        var filterIconElement;\n        if (this.parent.showColumnMenu) {\n            filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-columnmenu');\n        }\n        else if (this.parent.getColumnByField(fieldName)) {\n            filterIconElement = this.parent.getColumnHeaderByField(fieldName).querySelector('.e-icon-filter');\n        }\n        if (filterIconElement) {\n            filterIconElement.classList.add('e-filtered');\n        }\n    };\n    return Filter;\n}());\nexport { Filter };\n"]},"metadata":{},"sourceType":"module"}