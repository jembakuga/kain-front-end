{"ast":null,"code":"import { EventHandler, detach, formatUnit, Browser, closest, isBlazor } from '@syncfusion/ej2-base';\nimport { Column } from '../models/column';\nimport { ColumnWidthService } from '../services/width-controller';\nimport * as events from '../base/constant';\nimport { getScrollBarWidth, parentsUntil } from '../base/util';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nexport var resizeClassList = {\n  root: 'e-rhandler',\n  suppress: 'e-rsuppress',\n  icon: 'e-ricon',\n  helper: 'e-rhelper',\n  header: 'th.e-headercell',\n  cursor: 'e-rcursor'\n};\n/**\n * `Resize` module is used to handle Resize to fit for columns.\n * @hidden\n * @private\n */\n\nvar Resize =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid resize module\n   * @hidden\n   */\n  function Resize(parent) {\n    this.tapped = false;\n    this.isDblClk = true;\n    this.parent = parent;\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.widthService = new ColumnWidthService(parent);\n    this.addEventListener();\n  }\n  /**\n   * Resize by field names.\n   * @param  {string|string[]} fName - Defines the field name.\n   * @return {void}\n   */\n\n\n  Resize.prototype.autoFitColumns = function (fName) {\n    var columnName = fName === undefined || fName === null || fName.length <= 0 ? this.parent.getColumns().map(function (x) {\n      return x.field;\n    }) : typeof fName === 'string' ? [fName] : fName;\n    this.findColumn(columnName);\n  };\n\n  Resize.prototype.autoFit = function () {\n    var newarray = this.parent.getColumns().filter(function (c) {\n      return c.autoFit === true;\n    }).map(function (c) {\n      return c.field || c.headerText;\n    });\n\n    if (newarray.length > 0) {\n      this.autoFitColumns(newarray);\n    }\n  };\n  /* tslint:disable-next-line:max-func-body-length */\n\n\n  Resize.prototype.resizeColumn = function (fName, index, id) {\n    var gObj = this.parent;\n    var tWidth = 0;\n    var headerTable;\n    var contentTable;\n    var footerTable;\n    var headerDivTag = 'e-gridheader';\n    var contentDivTag = 'e-gridcontent';\n    var footerDivTag = 'e-gridfooter';\n    var indentWidth = 0;\n    var uid = id ? id : this.parent.getUidByColumnField(fName);\n    var columnIndex = this.parent.getNormalizedColumnIndex(uid);\n    var headerTextClone;\n    var contentTextClone;\n    var footerTextClone;\n    var frzCols = gObj.getFrozenColumns();\n\n    if (!isNullOrUndefined(gObj.getFooterContent())) {\n      footerTable = gObj.getFooterContentTable();\n    }\n\n    if (frzCols) {\n      if (index < frzCols) {\n        headerTable = gObj.getHeaderTable();\n        contentTable = gObj.getContentTable();\n        headerTextClone = headerTable.querySelector('[e-mappinguid=\"' + uid + '\"]').parentElement.cloneNode(true);\n        contentTextClone = contentTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \")\");\n\n        if (footerTable) {\n          footerTextClone = footerTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \")\");\n        }\n      } else {\n        headerTable = gObj.getHeaderContent().querySelector('.e-movableheader').children[0];\n        contentTable = gObj.getContent().querySelector('.e-movablecontent').children[0];\n        headerTextClone = headerTable.querySelector('[e-mappinguid=\"' + uid + '\"]').parentElement.cloneNode(true);\n        contentTextClone = contentTable.querySelectorAll(\"td:nth-child(\" + (columnIndex - frzCols + 1) + \")\");\n\n        if (footerTable) {\n          footerTable = gObj.getFooterContent().querySelector('.e-movablefootercontent').children[0];\n          footerTextClone = footerTable.querySelectorAll(\"td:nth-child(\" + (columnIndex - frzCols + 1) + \")\");\n        }\n      }\n    } else {\n      headerTable = gObj.getHeaderTable();\n      contentTable = gObj.getContentTable();\n      headerTextClone = headerTable.querySelector('[e-mappinguid=\"' + uid + '\"]').parentElement.cloneNode(true);\n      contentTextClone = contentTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \"):not(.e-groupcaption)\");\n\n      if (footerTable) {\n        footerTextClone = footerTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \"):not(.e-groupcaption)\");\n      }\n    }\n\n    var indentWidthClone = headerTable.querySelector('tr').querySelectorAll('.e-grouptopleftcell');\n\n    if (indentWidthClone.length > 0) {\n      for (var i = 0; i < indentWidthClone.length; i++) {\n        indentWidth += indentWidthClone[i].offsetWidth;\n      }\n    }\n\n    var detailsElement = contentTable.querySelector('.e-detailrowcollapse') || contentTable.querySelector('.e-detailrowexpand');\n\n    if ((this.parent.detailTemplate || this.parent.childGrid) && detailsElement) {\n      indentWidth += detailsElement.offsetWidth;\n    }\n\n    var headerText = [headerTextClone];\n    var contentText = [];\n    var footerText = [];\n\n    if (footerTable) {\n      for (var i = 0; i < footerTextClone.length; i++) {\n        footerText[i] = footerTextClone[i].cloneNode(true);\n      }\n    }\n\n    for (var i = 0; i < contentTextClone.length; i++) {\n      contentText[i] = contentTextClone[i].cloneNode(true);\n    }\n\n    var wHeader = this.createTable(headerTable, headerText, headerDivTag);\n    var wContent = this.createTable(contentTable, contentText, contentDivTag);\n    var wFooter = null;\n\n    if (footerText.length) {\n      wFooter = this.createTable(footerTable, footerText, footerDivTag);\n    }\n\n    var columnbyindex = gObj.getColumns()[index];\n    var result;\n    var width = columnbyindex.width = formatUnit(Math.max(wHeader, wContent, wFooter));\n    this.widthService.setColumnWidth(gObj.getColumns()[index]);\n    result = gObj.getColumns().some(function (x) {\n      return x.width === null || x.width === undefined || x.width.length <= 0;\n    });\n\n    if (result === false) {\n      gObj.getColumns().forEach(function (element) {\n        if (element.visible) {\n          tWidth = tWidth + parseFloat(element.width);\n        }\n      });\n    }\n\n    var calcTableWidth = tWidth + indentWidth;\n\n    if (tWidth > 0 && !gObj.getFrozenColumns()) {\n      if (this.parent.detailTemplate || this.parent.childGrid) {\n        this.widthService.setColumnWidth(new Column({\n          width: '30px'\n        }));\n      }\n\n      headerTable.style.width = formatUnit(calcTableWidth);\n      contentTable.style.width = formatUnit(calcTableWidth);\n\n      if (!isNullOrUndefined(footerTable)) {\n        footerTable.style.width = formatUnit(calcTableWidth);\n      }\n    }\n\n    var tableWidth = headerTable.offsetWidth;\n    var contentwidth = gObj.getContent().scrollWidth;\n\n    if (contentwidth > tableWidth) {\n      headerTable.classList.add('e-tableborder');\n      contentTable.classList.add('e-tableborder');\n    } else {\n      headerTable.classList.remove('e-tableborder');\n      contentTable.classList.remove('e-tableborder');\n    }\n\n    if (!isNullOrUndefined(footerTable)) {\n      footerTable.classList.add('e-tableborder');\n    }\n  };\n  /**\n   * To destroy the resize\n   * @return {void}\n   * @hidden\n   */\n\n\n  Resize.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n\n    if (!gridElement || !gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent')) {\n      return;\n    }\n\n    this.widthService = null;\n    this.unwireEvents();\n    this.removeEventListener();\n  };\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  Resize.prototype.getModuleName = function () {\n    return 'resize';\n  };\n\n  Resize.prototype.findColumn = function (fName) {\n    var _this = this;\n\n    fName.forEach(function (element) {\n      var fieldName = element;\n\n      var columnIndex = _this.parent.getColumnIndexByField(fieldName);\n\n      if (_this.parent.getColumns()[columnIndex].visible === true) {\n        _this.resizeColumn(fieldName, columnIndex);\n      }\n    });\n  };\n  /**\n   * To create table for autofit\n   * @hidden\n   */\n\n\n  Resize.prototype.createTable = function (table, text, tag) {\n    var myTableDiv = this.parent.createElement('div');\n    myTableDiv.className = this.parent.element.className;\n    myTableDiv.style.cssText = 'display: inline-block;visibility:hidden;position:absolute';\n    var mySubDiv = this.parent.createElement('div');\n    mySubDiv.className = tag;\n    var myTable = this.parent.createElement('table');\n    myTable.className = table.className;\n    myTable.classList.add('e-resizetable');\n    myTable.style.cssText = 'table-layout: auto;width: auto';\n    var myTr = this.parent.createElement('tr');\n    text.forEach(function (element) {\n      var tr = myTr.cloneNode();\n      tr.className = table.querySelector('tr').className;\n      tr.appendChild(element);\n      myTable.appendChild(tr);\n    });\n    mySubDiv.appendChild(myTable);\n    myTableDiv.appendChild(mySubDiv);\n    document.body.appendChild(myTableDiv);\n    var offsetWidthValue = myTable.getBoundingClientRect().width;\n    document.body.removeChild(myTableDiv);\n    return Math.ceil(offsetWidthValue);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Resize.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.headerRefreshed, this.refreshHeight, this);\n    this.parent.on(events.initialEnd, this.wireEvents, this);\n    this.parent.on(events.contentReady, this.autoFit, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Resize.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.headerRefreshed, this.refreshHeight);\n    this.parent.off(events.initialEnd, this.wireEvents);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Resize.prototype.render = function () {\n    this.unwireEvents();\n    this.wireEvents();\n    this.setHandlerHeight();\n  };\n\n  Resize.prototype.refreshHeight = function () {\n    this.getResizeHandlers().forEach(function (ele) {\n      if (ele.parentElement.offsetHeight > 0) {\n        ele.style.height = ele.parentElement.offsetHeight + 'px';\n      }\n    });\n    this.setHandlerHeight();\n  };\n\n  Resize.prototype.wireEvents = function () {\n    EventHandler.add(this.parent.getHeaderContent(), Browser.touchStartEvent, this.resizeStart, this);\n    EventHandler.add(this.parent.getHeaderContent(), events.dblclick, this.callAutoFit, this);\n  };\n\n  Resize.prototype.unwireEvents = function () {\n    EventHandler.remove(this.parent.getHeaderContent(), Browser.touchStartEvent, this.resizeStart);\n    EventHandler.remove(this.parent.getHeaderContent(), events.dblclick, this.callAutoFit);\n  };\n\n  Resize.prototype.getResizeHandlers = function () {\n    return this.parent.getFrozenColumns() ? [].slice.call(this.parent.getHeaderContent().querySelectorAll('.' + resizeClassList.root)) : [].slice.call(this.parent.getHeaderTable().querySelectorAll('.' + resizeClassList.root));\n  };\n\n  Resize.prototype.setHandlerHeight = function () {\n    [].slice.call(this.parent.getHeaderTable().querySelectorAll('.' + resizeClassList.suppress)).forEach(function (ele) {\n      ele.style.height = ele.parentElement.offsetHeight + 'px';\n    });\n  };\n\n  Resize.prototype.callAutoFit = function (e) {\n    if (e.target.classList.contains('e-rhandler')) {\n      var col = this.getTargetColumn(e);\n\n      if (col.columns) {\n        return;\n      }\n\n      this.resizeColumn(col.field, this.parent.getNormalizedColumnIndex(col.uid), col.uid);\n      var header = closest(e.target, resizeClassList.header);\n      header.classList.add('e-resized');\n    }\n  };\n\n  Resize.prototype.resizeStart = function (e) {\n    var _this = this;\n\n    if (e.target.classList.contains('e-rhandler')) {\n      if (!this.helper) {\n        if (this.getScrollBarWidth() === 0) {\n          for (var _i = 0, _a = this.refreshColumnWidth(); _i < _a.length; _i++) {\n            var col = _a[_i];\n            this.widthService.setColumnWidth(col);\n          }\n\n          this.widthService.setWidthToTable();\n        }\n\n        this.refreshStackedColumnWidth();\n        this.element = e.target;\n\n        if (this.parent.getVisibleFrozenColumns()) {\n          var mtbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n          var ftbody = this.parent.getContent().querySelector('.e-frozencontent').querySelector('tbody');\n          var mtr = mtbody.querySelectorAll('tr');\n          var ftr = ftbody.querySelectorAll('tr');\n\n          for (var i = 0; i < mtr.length; i++) {\n            if (this.parent.rowHeight) {\n              mtr[i].style.height = this.parent.rowHeight + 'px';\n              ftr[i].style.height = this.parent.rowHeight + 'px';\n            } else {\n              mtr[i].style.removeProperty('height');\n              ftr[i].style.removeProperty('height');\n            }\n          }\n        }\n\n        this.parentElementWidth = this.parent.element.getBoundingClientRect().width;\n        this.appendHelper();\n        this.column = this.getTargetColumn(e);\n        this.pageX = this.getPointX(e);\n\n        if (this.parent.enableRtl) {\n          this.minMove = parseFloat(this.column.width.toString()) - (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0);\n        } else {\n          this.minMove = (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0) - parseFloat(isNullOrUndefined(this.column.width) ? '' : this.column.width.toString());\n        }\n\n        this.minMove += this.pageX;\n      }\n\n      if (Browser.isDevice && !this.helper.classList.contains(resizeClassList.icon)) {\n        this.helper.classList.add(resizeClassList.icon);\n        EventHandler.add(document, Browser.touchStartEvent, this.removeHelper, this);\n        EventHandler.add(this.helper, Browser.touchStartEvent, this.resizeStart, this);\n      } else {\n        var args = {\n          e: isBlazor() && !this.parent.isJsComponent ? null : e,\n          column: this.column\n        };\n        this.parent.trigger(events.resizeStart, args, function (args) {\n          if (args.cancel || _this.parent.isEdit) {\n            _this.cancelResizeAction();\n\n            return;\n          }\n\n          EventHandler.add(document, Browser.touchEndEvent, _this.resizeEnd, _this);\n          EventHandler.add(_this.parent.element, Browser.touchMoveEvent, _this.resizing, _this);\n\n          _this.updateCursor('add');\n        });\n      }\n    }\n  };\n\n  Resize.prototype.cancelResizeAction = function (removeEvents) {\n    if (removeEvents) {\n      EventHandler.remove(this.parent.element, Browser.touchMoveEvent, this.resizing);\n      EventHandler.remove(document, Browser.touchEndEvent, this.resizeEnd);\n      this.updateCursor('remove');\n    }\n\n    if (Browser.isDevice) {\n      EventHandler.remove(document, Browser.touchStartEvent, this.removeHelper);\n      EventHandler.remove(this.helper, Browser.touchStartEvent, this.resizeStart);\n    }\n\n    detach(this.helper);\n    this.refresh();\n  };\n\n  Resize.prototype.getWidth = function (width, minWidth, maxWidth) {\n    if (minWidth && width < minWidth) {\n      return minWidth;\n    } else if (maxWidth && width > maxWidth) {\n      return maxWidth;\n    } else {\n      return width;\n    }\n  };\n\n  Resize.prototype.updateResizeEleHeight = function () {\n    var _this = this;\n\n    this.parent.getHeaderContent().querySelectorAll('.e-rhandler').forEach(function (element) {\n      element.style.height = _this.element.parentElement.offsetHeight + 'px';\n    });\n  };\n\n  Resize.prototype.getColData = function (column, mousemove) {\n    return {\n      width: parseFloat(isNullOrUndefined(this.widthService.getWidth(column)) || this.widthService.getWidth(column) === 'auto' ? '0' : this.widthService.getWidth(column).toString()) + mousemove,\n      minWidth: column.minWidth ? parseFloat(column.minWidth.toString()) : null,\n      maxWidth: column.maxWidth ? parseFloat(column.maxWidth.toString()) : null\n    };\n  };\n\n  Resize.prototype.resizing = function (e) {\n    if (isNullOrUndefined(this.column)) {\n      return;\n    }\n\n    var offsetWidth = 0;\n\n    if (isNullOrUndefined(this.column)) {\n      offsetWidth = parentsUntil(this.element, 'th').offsetWidth;\n    }\n\n    if (this.parent.allowTextWrap) {\n      this.updateResizeEleHeight();\n      this.setHelperHeight();\n    }\n\n    var pageX = this.getPointX(e);\n    var mousemove = this.parent.enableRtl ? -(pageX - this.pageX) : pageX - this.pageX;\n    var colData = this.getColData(this.column, mousemove);\n\n    if (!colData.width) {\n      colData.width = closest(this.element, 'th').offsetWidth;\n    }\n\n    var width = this.getWidth(colData.width, colData.minWidth, colData.maxWidth);\n    this.parent.log('resize_min_max', {\n      column: this.column,\n      width: width\n    });\n\n    if (!this.parent.enableRtl && this.minMove >= pageX || this.parent.enableRtl && this.minMove <= pageX) {\n      width = this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0;\n      this.pageX = pageX = this.minMove;\n    }\n\n    if (width !== parseFloat(isNullOrUndefined(this.column.width) || this.column.width === 'auto' ? offsetWidth.toString() : this.column.width.toString())) {\n      this.pageX = pageX;\n      this.column.width = formatUnit(width);\n      var args = {\n        e: e,\n        column: this.column\n      };\n      this.parent.trigger(events.onResize, args);\n\n      if (args.cancel) {\n        this.cancelResizeAction(true);\n        return;\n      }\n\n      var columns = [this.column];\n      var finalColumns = [this.column];\n\n      if (this.column.columns) {\n        columns = this.getSubColumns(this.column, []);\n        columns = this.calulateColumnsWidth(columns, false, mousemove);\n        finalColumns = this.calulateColumnsWidth(columns, true, mousemove);\n      }\n\n      for (var _i = 0, finalColumns_1 = finalColumns; _i < finalColumns_1.length; _i++) {\n        var col = finalColumns_1[_i];\n        this.widthService.setColumnWidth(col, null, 'resize');\n      }\n\n      this.updateHelper();\n    }\n\n    this.isDblClk = false;\n  };\n\n  Resize.prototype.calulateColumnsWidth = function (columns, isUpdate, mousemove) {\n    var finalColumns = [];\n\n    var _loop_1 = function (col) {\n      var totalWidth = 0;\n      columns.forEach(function (col) {\n        totalWidth += parseFloat(col.width.toString());\n      });\n      var colData = this_1.getColData(col, parseFloat(col.width) * mousemove / totalWidth);\n      var colWidth = this_1.getWidth(colData.width, colData.minWidth, colData.maxWidth);\n\n      if (colWidth !== parseFloat(col.width.toString())) {\n        if (isUpdate) {\n          col.width = formatUnit(colWidth < 1 ? 1 : colWidth);\n        }\n\n        finalColumns.push(col);\n      }\n    };\n\n    var this_1 = this;\n\n    for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n      var col = columns_1[_i];\n\n      _loop_1(col);\n    }\n\n    return finalColumns;\n  };\n\n  Resize.prototype.getSubColumns = function (column, subColumns) {\n    for (var _i = 0, _a = column.columns; _i < _a.length; _i++) {\n      var col = _a[_i];\n\n      if (col.visible !== false && col.allowResizing) {\n        if (col.columns) {\n          this.getSubColumns(col, subColumns);\n        } else {\n          subColumns.push(col);\n        }\n      }\n    }\n\n    return subColumns;\n  };\n\n  Resize.prototype.resizeEnd = function (e) {\n    if (!this.helper || this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.remove(this.parent.element, Browser.touchMoveEvent, this.resizing);\n    EventHandler.remove(document, Browser.touchEndEvent, this.resizeEnd);\n    this.updateCursor('remove');\n    detach(this.helper);\n    var args = {\n      e: isBlazor() && !this.parent.isJsComponent ? null : e,\n      column: this.column\n    };\n    var content = this.parent.getContent().querySelector('.e-content');\n    var cTable = content.querySelector('.e-movablecontent') ? content.querySelector('.e-movablecontent') : content;\n\n    if (cTable.scrollHeight >= cTable.clientHeight) {\n      this.parent.scrollModule.setPadding();\n      cTable.style.overflowY = 'scroll';\n    }\n\n    this.parent.trigger(events.resizeStop, args);\n    closest(this.element, '.e-headercell').classList.add('e-resized');\n\n    if (parentsUntil(this.element, 'e-frozenheader')) {\n      this.isFrozenColResized = true;\n    } else {\n      this.isFrozenColResized = false;\n    }\n\n    if (this.parent.getFrozenColumns()) {\n      this.parent.notify(events.freezeRender, {\n        case: 'textwrap'\n      });\n    }\n\n    if (this.parent.allowTextWrap) {\n      this.updateResizeEleHeight();\n      this.parent.notify(events.textWrapRefresh, {\n        case: 'textwrap'\n      });\n    }\n\n    this.refresh();\n    this.doubleTapEvent(e);\n    this.isDblClk = true;\n  };\n\n  Resize.prototype.getPointX = function (e) {\n    if (e.touches && e.touches.length) {\n      return e.touches[0].pageX;\n    } else {\n      return e.pageX;\n    }\n  };\n\n  Resize.prototype.refreshColumnWidth = function () {\n    var columns = this.parent.getColumns();\n\n    for (var _i = 0, _a = [].slice.apply(this.parent.getHeaderTable().querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n      var ele = _a[_i];\n\n      for (var _b = 0, columns_2 = columns; _b < columns_2.length; _b++) {\n        var column = columns_2[_b];\n\n        if (ele.querySelector('[e-mappinguid]') && ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === column.uid && column.visible) {\n          column.width = ele.getBoundingClientRect().width;\n          break;\n        }\n      }\n    }\n\n    return columns;\n  };\n\n  Resize.prototype.refreshStackedColumnWidth = function () {\n    for (var _i = 0, _a = this.parent.getStackedColumns(this.parent.columns); _i < _a.length; _i++) {\n      var stackedColumn = _a[_i];\n      stackedColumn.width = this.getStackedWidth(stackedColumn, 0);\n    }\n  };\n\n  Resize.prototype.getStackedWidth = function (column, width) {\n    for (var _i = 0, _a = column.columns; _i < _a.length; _i++) {\n      var col = _a[_i];\n\n      if (col.visible !== false) {\n        if (col.columns) {\n          this.getStackedWidth(col, width);\n        } else {\n          width += col.width;\n        }\n      }\n    }\n\n    return width;\n  };\n\n  Resize.prototype.getTargetColumn = function (e) {\n    var cell = closest(e.target, resizeClassList.header);\n    cell = cell.querySelector('.e-headercelldiv') || cell.querySelector('.e-stackedheadercelldiv');\n    var uid = cell.getAttribute('e-mappinguid');\n    return this.parent.getColumnByUid(uid);\n  };\n\n  Resize.prototype.updateCursor = function (action) {\n    var headerRows = [].slice.call(this.parent.getHeaderContent().querySelectorAll('th'));\n    headerRows.push(this.parent.element);\n\n    for (var _i = 0, headerRows_1 = headerRows; _i < headerRows_1.length; _i++) {\n      var row = headerRows_1[_i];\n      row.classList[action](resizeClassList.cursor);\n    }\n  };\n\n  Resize.prototype.refresh = function () {\n    this.column = null;\n    this.pageX = null;\n    this.element = null;\n    this.helper = null;\n  };\n\n  Resize.prototype.appendHelper = function () {\n    this.helper = this.parent.createElement('div', {\n      className: resizeClassList.helper\n    });\n    this.parent.element.appendChild(this.helper);\n    this.setHelperHeight();\n  };\n\n  Resize.prototype.setHelperHeight = function () {\n    var height = this.parent.getContent().offsetHeight - this.getScrollBarWidth();\n    var rect = closest(this.element, resizeClassList.header);\n    var tr = [].slice.call(this.parent.getHeaderContent().querySelectorAll('tr'));\n    var frzCols = this.parent.getFrozenColumns();\n\n    if (frzCols) {\n      if (rect.parentElement.children.length !== frzCols) {\n        tr.splice(0, tr.length / 2);\n      } else {\n        tr.splice(tr.length / 2, tr.length / 2);\n      }\n    }\n\n    for (var i = tr.indexOf(rect.parentElement); i < tr.length; i++) {\n      height += tr[i].offsetHeight;\n    }\n\n    var pos = this.calcPos(rect);\n    pos.left += this.parent.enableRtl ? 0 - 1 : rect.offsetWidth - 2;\n    this.helper.style.cssText = 'height: ' + height + 'px; top: ' + pos.top + 'px; left:' + Math.floor(pos.left) + 'px;';\n  };\n\n  Resize.prototype.getScrollBarWidth = function (height) {\n    var ele = this.parent.getFrozenColumns() ? this.parent.getContent().querySelector('.e-movablecontent') : this.parent.getContent().firstChild;\n    return ele.scrollHeight > ele.clientHeight && height || ele.scrollWidth > ele.clientWidth ? getScrollBarWidth() : 0;\n  };\n\n  Resize.prototype.removeHelper = function (e) {\n    var cls = e.target.classList;\n\n    if (!(cls.contains(resizeClassList.root) || cls.contains(resizeClassList.icon)) && this.helper) {\n      EventHandler.remove(document, Browser.touchStartEvent, this.removeHelper);\n      EventHandler.remove(this.helper, Browser.touchStartEvent, this.resizeStart);\n      detach(this.helper);\n      this.refresh();\n    }\n  };\n\n  Resize.prototype.updateHelper = function () {\n    var rect = closest(this.element, resizeClassList.header);\n    var left = Math.floor(this.calcPos(rect).left + (this.parent.enableRtl ? 0 - 1 : rect.offsetWidth - 2));\n    var borderWidth = 2; // to maintain the helper inside of grid element.\n\n    if (left > this.parentElementWidth) {\n      left = this.parentElementWidth - borderWidth;\n    }\n\n    if (this.parent.getFrozenColumns()) {\n      var table = closest(rect, '.e-table');\n      var fLeft = table.offsetLeft;\n\n      if (left < fLeft) {\n        left = fLeft;\n      }\n    }\n\n    this.helper.style.left = left + 'px';\n  };\n\n  Resize.prototype.calcPos = function (elem) {\n    var parentOffset = {\n      top: 0,\n      left: 0\n    };\n    var offset = elem.getBoundingClientRect();\n    var doc = elem.ownerDocument;\n    var offsetParent = elem.offsetParent || doc.documentElement;\n\n    while (offsetParent && (offsetParent === doc.body || offsetParent === doc.documentElement) && offsetParent.style.position === 'static') {\n      offsetParent = offsetParent.parentNode;\n    }\n\n    if (offsetParent && offsetParent !== elem && offsetParent.nodeType === 1) {\n      parentOffset = offsetParent.getBoundingClientRect();\n    }\n\n    return {\n      top: offset.top - parentOffset.top,\n      left: offset.left - parentOffset.left\n    };\n  };\n\n  Resize.prototype.doubleTapEvent = function (e) {\n    if (this.getUserAgent() && this.isDblClk) {\n      if (!this.tapped) {\n        this.tapped = setTimeout(this.timeoutHandler(), 300);\n      } else {\n        clearTimeout(this.tapped);\n        this.callAutoFit(e);\n        this.tapped = null;\n      }\n    }\n  };\n\n  Resize.prototype.getUserAgent = function () {\n    var userAgent = Browser.userAgent.toLowerCase();\n    return /iphone|ipod|ipad/.test(userAgent);\n  };\n\n  Resize.prototype.timeoutHandler = function () {\n    this.tapped = null;\n  };\n\n  return Resize;\n}();\n\nexport { Resize };","map":{"version":3,"sources":["C:/CN2/workspace-trunk/kain-front-end/node_modules/@syncfusion/ej2-grids/src/grid/actions/resize.js"],"names":["EventHandler","detach","formatUnit","Browser","closest","isBlazor","Column","ColumnWidthService","events","getScrollBarWidth","parentsUntil","isNullOrUndefined","resizeClassList","root","suppress","icon","helper","header","cursor","Resize","parent","tapped","isDblClk","isDestroyed","widthService","addEventListener","prototype","autoFitColumns","fName","columnName","undefined","length","getColumns","map","x","field","findColumn","autoFit","newarray","filter","c","headerText","resizeColumn","index","id","gObj","tWidth","headerTable","contentTable","footerTable","headerDivTag","contentDivTag","footerDivTag","indentWidth","uid","getUidByColumnField","columnIndex","getNormalizedColumnIndex","headerTextClone","contentTextClone","footerTextClone","frzCols","getFrozenColumns","getFooterContent","getFooterContentTable","getHeaderTable","getContentTable","querySelector","parentElement","cloneNode","querySelectorAll","getHeaderContent","children","getContent","indentWidthClone","i","offsetWidth","detailsElement","detailTemplate","childGrid","contentText","footerText","wHeader","createTable","wContent","wFooter","columnbyindex","result","width","Math","max","setColumnWidth","some","forEach","element","visible","parseFloat","calcTableWidth","style","tableWidth","contentwidth","scrollWidth","classList","add","remove","destroy","gridElement","unwireEvents","removeEventListener","getModuleName","_this","fieldName","getColumnIndexByField","table","text","tag","myTableDiv","createElement","className","cssText","mySubDiv","myTable","myTr","tr","appendChild","document","body","offsetWidthValue","getBoundingClientRect","removeChild","ceil","on","headerRefreshed","refreshHeight","initialEnd","wireEvents","contentReady","off","render","setHandlerHeight","getResizeHandlers","ele","offsetHeight","height","touchStartEvent","resizeStart","dblclick","callAutoFit","slice","call","e","target","contains","col","getTargetColumn","columns","_i","_a","refreshColumnWidth","setWidthToTable","refreshStackedColumnWidth","getVisibleFrozenColumns","mtbody","ftbody","mtr","ftr","rowHeight","removeProperty","parentElementWidth","appendHelper","column","pageX","getPointX","enableRtl","minMove","toString","minWidth","isDevice","removeHelper","args","isJsComponent","trigger","cancel","isEdit","cancelResizeAction","touchEndEvent","resizeEnd","touchMoveEvent","resizing","updateCursor","removeEvents","refresh","getWidth","maxWidth","updateResizeEleHeight","getColData","mousemove","allowTextWrap","setHelperHeight","colData","log","onResize","finalColumns","getSubColumns","calulateColumnsWidth","finalColumns_1","updateHelper","isUpdate","_loop_1","totalWidth","this_1","colWidth","push","columns_1","subColumns","allowResizing","content","cTable","scrollHeight","clientHeight","scrollModule","setPadding","overflowY","resizeStop","isFrozenColResized","notify","freezeRender","case","textWrapRefresh","doubleTapEvent","touches","apply","_b","columns_2","getAttribute","getStackedColumns","stackedColumn","getStackedWidth","cell","getColumnByUid","action","headerRows","headerRows_1","row","rect","splice","indexOf","pos","calcPos","left","top","floor","firstChild","clientWidth","cls","borderWidth","fLeft","offsetLeft","elem","parentOffset","offset","doc","ownerDocument","offsetParent","documentElement","position","parentNode","nodeType","getUserAgent","setTimeout","timeoutHandler","clearTimeout","userAgent","toLowerCase","test"],"mappings":"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","sourcesContent":["import { EventHandler, detach, formatUnit, Browser, closest, isBlazor } from '@syncfusion/ej2-base';\nimport { Column } from '../models/column';\nimport { ColumnWidthService } from '../services/width-controller';\nimport * as events from '../base/constant';\nimport { getScrollBarWidth, parentsUntil } from '../base/util';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nexport var resizeClassList = {\n    root: 'e-rhandler',\n    suppress: 'e-rsuppress',\n    icon: 'e-ricon',\n    helper: 'e-rhelper',\n    header: 'th.e-headercell',\n    cursor: 'e-rcursor'\n};\n/**\n * `Resize` module is used to handle Resize to fit for columns.\n * @hidden\n * @private\n */\nvar Resize = /** @class */ (function () {\n    /**\n     * Constructor for the Grid resize module\n     * @hidden\n     */\n    function Resize(parent) {\n        this.tapped = false;\n        this.isDblClk = true;\n        this.parent = parent;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.widthService = new ColumnWidthService(parent);\n        this.addEventListener();\n    }\n    /**\n     * Resize by field names.\n     * @param  {string|string[]} fName - Defines the field name.\n     * @return {void}\n     */\n    Resize.prototype.autoFitColumns = function (fName) {\n        var columnName = (fName === undefined || fName === null || fName.length <= 0) ?\n            this.parent.getColumns().map(function (x) { return x.field; }) : (typeof fName === 'string') ? [fName] : fName;\n        this.findColumn(columnName);\n    };\n    Resize.prototype.autoFit = function () {\n        var newarray = this.parent.getColumns().filter(function (c) { return c.autoFit === true; })\n            .map(function (c) { return c.field || c.headerText; });\n        if (newarray.length > 0) {\n            this.autoFitColumns(newarray);\n        }\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    Resize.prototype.resizeColumn = function (fName, index, id) {\n        var gObj = this.parent;\n        var tWidth = 0;\n        var headerTable;\n        var contentTable;\n        var footerTable;\n        var headerDivTag = 'e-gridheader';\n        var contentDivTag = 'e-gridcontent';\n        var footerDivTag = 'e-gridfooter';\n        var indentWidth = 0;\n        var uid = id ? id : this.parent.getUidByColumnField(fName);\n        var columnIndex = this.parent.getNormalizedColumnIndex(uid);\n        var headerTextClone;\n        var contentTextClone;\n        var footerTextClone;\n        var frzCols = gObj.getFrozenColumns();\n        if (!isNullOrUndefined(gObj.getFooterContent())) {\n            footerTable = gObj.getFooterContentTable();\n        }\n        if (frzCols) {\n            if (index < frzCols) {\n                headerTable = gObj.getHeaderTable();\n                contentTable = gObj.getContentTable();\n                headerTextClone = headerTable.querySelector('[e-mappinguid=\"' + uid + '\"]').parentElement.cloneNode(true);\n                contentTextClone = contentTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \")\");\n                if (footerTable) {\n                    footerTextClone = footerTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \")\");\n                }\n            }\n            else {\n                headerTable = gObj.getHeaderContent().querySelector('.e-movableheader').children[0];\n                contentTable = gObj.getContent().querySelector('.e-movablecontent').children[0];\n                headerTextClone = headerTable.querySelector('[e-mappinguid=\"' + uid + '\"]').parentElement.cloneNode(true);\n                contentTextClone = contentTable.querySelectorAll(\"td:nth-child(\" + ((columnIndex - frzCols) + 1) + \")\");\n                if (footerTable) {\n                    footerTable = gObj.getFooterContent().querySelector('.e-movablefootercontent').children[0];\n                    footerTextClone = footerTable.querySelectorAll(\"td:nth-child(\" + ((columnIndex - frzCols) + 1) + \")\");\n                }\n            }\n        }\n        else {\n            headerTable = gObj.getHeaderTable();\n            contentTable = gObj.getContentTable();\n            headerTextClone = headerTable.querySelector('[e-mappinguid=\"' + uid + '\"]').parentElement.cloneNode(true);\n            contentTextClone = contentTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \"):not(.e-groupcaption)\");\n            if (footerTable) {\n                footerTextClone = footerTable.querySelectorAll(\"td:nth-child(\" + (columnIndex + 1) + \"):not(.e-groupcaption)\");\n            }\n        }\n        var indentWidthClone = headerTable.querySelector('tr').querySelectorAll('.e-grouptopleftcell');\n        if (indentWidthClone.length > 0) {\n            for (var i = 0; i < indentWidthClone.length; i++) {\n                indentWidth += indentWidthClone[i].offsetWidth;\n            }\n        }\n        var detailsElement = contentTable.querySelector('.e-detailrowcollapse') ||\n            contentTable.querySelector('.e-detailrowexpand');\n        if ((this.parent.detailTemplate || this.parent.childGrid) && detailsElement) {\n            indentWidth += detailsElement.offsetWidth;\n        }\n        var headerText = [headerTextClone];\n        var contentText = [];\n        var footerText = [];\n        if (footerTable) {\n            for (var i = 0; i < footerTextClone.length; i++) {\n                footerText[i] = footerTextClone[i].cloneNode(true);\n            }\n        }\n        for (var i = 0; i < contentTextClone.length; i++) {\n            contentText[i] = contentTextClone[i].cloneNode(true);\n        }\n        var wHeader = this.createTable(headerTable, headerText, headerDivTag);\n        var wContent = this.createTable(contentTable, contentText, contentDivTag);\n        var wFooter = null;\n        if (footerText.length) {\n            wFooter = this.createTable(footerTable, footerText, footerDivTag);\n        }\n        var columnbyindex = gObj.getColumns()[index];\n        var result;\n        var width = columnbyindex.width = formatUnit(Math.max(wHeader, wContent, wFooter));\n        this.widthService.setColumnWidth(gObj.getColumns()[index]);\n        result = gObj.getColumns().some(function (x) { return x.width === null || x.width === undefined || x.width.length <= 0; });\n        if (result === false) {\n            gObj.getColumns().forEach(function (element) {\n                if (element.visible) {\n                    tWidth = tWidth + parseFloat(element.width);\n                }\n            });\n        }\n        var calcTableWidth = tWidth + indentWidth;\n        if (tWidth > 0 && !gObj.getFrozenColumns()) {\n            if (this.parent.detailTemplate || this.parent.childGrid) {\n                this.widthService.setColumnWidth(new Column({ width: '30px' }));\n            }\n            headerTable.style.width = formatUnit(calcTableWidth);\n            contentTable.style.width = formatUnit(calcTableWidth);\n            if (!isNullOrUndefined(footerTable)) {\n                footerTable.style.width = formatUnit(calcTableWidth);\n            }\n        }\n        var tableWidth = headerTable.offsetWidth;\n        var contentwidth = (gObj.getContent().scrollWidth);\n        if (contentwidth > tableWidth) {\n            headerTable.classList.add('e-tableborder');\n            contentTable.classList.add('e-tableborder');\n        }\n        else {\n            headerTable.classList.remove('e-tableborder');\n            contentTable.classList.remove('e-tableborder');\n        }\n        if (!isNullOrUndefined(footerTable)) {\n            footerTable.classList.add('e-tableborder');\n        }\n    };\n    /**\n     * To destroy the resize\n     * @return {void}\n     * @hidden\n     */\n    Resize.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent'))) {\n            return;\n        }\n        this.widthService = null;\n        this.unwireEvents();\n        this.removeEventListener();\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Resize.prototype.getModuleName = function () {\n        return 'resize';\n    };\n    Resize.prototype.findColumn = function (fName) {\n        var _this = this;\n        fName.forEach(function (element) {\n            var fieldName = element;\n            var columnIndex = _this.parent.getColumnIndexByField(fieldName);\n            if (_this.parent.getColumns()[columnIndex].visible === true) {\n                _this.resizeColumn(fieldName, columnIndex);\n            }\n        });\n    };\n    /**\n     * To create table for autofit\n     * @hidden\n     */\n    Resize.prototype.createTable = function (table, text, tag) {\n        var myTableDiv = this.parent.createElement('div');\n        myTableDiv.className = this.parent.element.className;\n        myTableDiv.style.cssText = 'display: inline-block;visibility:hidden;position:absolute';\n        var mySubDiv = this.parent.createElement('div');\n        mySubDiv.className = tag;\n        var myTable = this.parent.createElement('table');\n        myTable.className = table.className;\n        myTable.classList.add('e-resizetable');\n        myTable.style.cssText = 'table-layout: auto;width: auto';\n        var myTr = this.parent.createElement('tr');\n        text.forEach(function (element) {\n            var tr = myTr.cloneNode();\n            tr.className = table.querySelector('tr').className;\n            tr.appendChild(element);\n            myTable.appendChild(tr);\n        });\n        mySubDiv.appendChild(myTable);\n        myTableDiv.appendChild(mySubDiv);\n        document.body.appendChild(myTableDiv);\n        var offsetWidthValue = myTable.getBoundingClientRect().width;\n        document.body.removeChild(myTableDiv);\n        return Math.ceil(offsetWidthValue);\n    };\n    /**\n     * @hidden\n     */\n    Resize.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.headerRefreshed, this.refreshHeight, this);\n        this.parent.on(events.initialEnd, this.wireEvents, this);\n        this.parent.on(events.contentReady, this.autoFit, this);\n    };\n    /**\n     * @hidden\n     */\n    Resize.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.headerRefreshed, this.refreshHeight);\n        this.parent.off(events.initialEnd, this.wireEvents);\n    };\n    /**\n     * @hidden\n     */\n    Resize.prototype.render = function () {\n        this.unwireEvents();\n        this.wireEvents();\n        this.setHandlerHeight();\n    };\n    Resize.prototype.refreshHeight = function () {\n        this.getResizeHandlers().forEach(function (ele) {\n            if (ele.parentElement.offsetHeight > 0) {\n                ele.style.height = ele.parentElement.offsetHeight + 'px';\n            }\n        });\n        this.setHandlerHeight();\n    };\n    Resize.prototype.wireEvents = function () {\n        EventHandler.add(this.parent.getHeaderContent(), Browser.touchStartEvent, this.resizeStart, this);\n        EventHandler.add(this.parent.getHeaderContent(), events.dblclick, this.callAutoFit, this);\n    };\n    Resize.prototype.unwireEvents = function () {\n        EventHandler.remove(this.parent.getHeaderContent(), Browser.touchStartEvent, this.resizeStart);\n        EventHandler.remove(this.parent.getHeaderContent(), events.dblclick, this.callAutoFit);\n    };\n    Resize.prototype.getResizeHandlers = function () {\n        return this.parent.getFrozenColumns() ?\n            [].slice.call(this.parent.getHeaderContent().querySelectorAll('.' + resizeClassList.root))\n            : [].slice.call(this.parent.getHeaderTable().querySelectorAll('.' + resizeClassList.root));\n    };\n    Resize.prototype.setHandlerHeight = function () {\n        [].slice.call(this.parent.getHeaderTable().querySelectorAll('.' + resizeClassList.suppress)).forEach(function (ele) {\n            ele.style.height = ele.parentElement.offsetHeight + 'px';\n        });\n    };\n    Resize.prototype.callAutoFit = function (e) {\n        if (e.target.classList.contains('e-rhandler')) {\n            var col = this.getTargetColumn(e);\n            if (col.columns) {\n                return;\n            }\n            this.resizeColumn(col.field, this.parent.getNormalizedColumnIndex(col.uid), col.uid);\n            var header = closest(e.target, resizeClassList.header);\n            header.classList.add('e-resized');\n        }\n    };\n    Resize.prototype.resizeStart = function (e) {\n        var _this = this;\n        if (e.target.classList.contains('e-rhandler')) {\n            if (!this.helper) {\n                if (this.getScrollBarWidth() === 0) {\n                    for (var _i = 0, _a = this.refreshColumnWidth(); _i < _a.length; _i++) {\n                        var col = _a[_i];\n                        this.widthService.setColumnWidth(col);\n                    }\n                    this.widthService.setWidthToTable();\n                }\n                this.refreshStackedColumnWidth();\n                this.element = e.target;\n                if (this.parent.getVisibleFrozenColumns()) {\n                    var mtbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n                    var ftbody = this.parent.getContent().querySelector('.e-frozencontent').querySelector('tbody');\n                    var mtr = mtbody.querySelectorAll('tr');\n                    var ftr = ftbody.querySelectorAll('tr');\n                    for (var i = 0; i < mtr.length; i++) {\n                        if (this.parent.rowHeight) {\n                            mtr[i].style.height = this.parent.rowHeight + 'px';\n                            ftr[i].style.height = this.parent.rowHeight + 'px';\n                        }\n                        else {\n                            mtr[i].style.removeProperty('height');\n                            ftr[i].style.removeProperty('height');\n                        }\n                    }\n                }\n                this.parentElementWidth = this.parent.element.getBoundingClientRect().width;\n                this.appendHelper();\n                this.column = this.getTargetColumn(e);\n                this.pageX = this.getPointX(e);\n                if (this.parent.enableRtl) {\n                    this.minMove = parseFloat(this.column.width.toString())\n                        - (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0);\n                }\n                else {\n                    this.minMove = (this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0)\n                        - parseFloat(isNullOrUndefined(this.column.width) ? '' : this.column.width.toString());\n                }\n                this.minMove += this.pageX;\n            }\n            if (Browser.isDevice && !this.helper.classList.contains(resizeClassList.icon)) {\n                this.helper.classList.add(resizeClassList.icon);\n                EventHandler.add(document, Browser.touchStartEvent, this.removeHelper, this);\n                EventHandler.add(this.helper, Browser.touchStartEvent, this.resizeStart, this);\n            }\n            else {\n                var args = {\n                    e: isBlazor() && !this.parent.isJsComponent ? null : e,\n                    column: this.column\n                };\n                this.parent.trigger(events.resizeStart, args, function (args) {\n                    if (args.cancel || _this.parent.isEdit) {\n                        _this.cancelResizeAction();\n                        return;\n                    }\n                    EventHandler.add(document, Browser.touchEndEvent, _this.resizeEnd, _this);\n                    EventHandler.add(_this.parent.element, Browser.touchMoveEvent, _this.resizing, _this);\n                    _this.updateCursor('add');\n                });\n            }\n        }\n    };\n    Resize.prototype.cancelResizeAction = function (removeEvents) {\n        if (removeEvents) {\n            EventHandler.remove(this.parent.element, Browser.touchMoveEvent, this.resizing);\n            EventHandler.remove(document, Browser.touchEndEvent, this.resizeEnd);\n            this.updateCursor('remove');\n        }\n        if (Browser.isDevice) {\n            EventHandler.remove(document, Browser.touchStartEvent, this.removeHelper);\n            EventHandler.remove(this.helper, Browser.touchStartEvent, this.resizeStart);\n        }\n        detach(this.helper);\n        this.refresh();\n    };\n    Resize.prototype.getWidth = function (width, minWidth, maxWidth) {\n        if (minWidth && width < minWidth) {\n            return minWidth;\n        }\n        else if ((maxWidth && width > maxWidth)) {\n            return maxWidth;\n        }\n        else {\n            return width;\n        }\n    };\n    Resize.prototype.updateResizeEleHeight = function () {\n        var _this = this;\n        this.parent.getHeaderContent().querySelectorAll('.e-rhandler').forEach(function (element) {\n            element.style.height = _this.element.parentElement.offsetHeight + 'px';\n        });\n    };\n    Resize.prototype.getColData = function (column, mousemove) {\n        return {\n            width: parseFloat(isNullOrUndefined(this.widthService.getWidth(column)) || this.widthService.getWidth(column) === 'auto' ? '0'\n                : this.widthService.getWidth(column).toString()) + mousemove,\n            minWidth: column.minWidth ? parseFloat(column.minWidth.toString()) : null,\n            maxWidth: column.maxWidth ? parseFloat(column.maxWidth.toString()) : null\n        };\n    };\n    Resize.prototype.resizing = function (e) {\n        if (isNullOrUndefined(this.column)) {\n            return;\n        }\n        var offsetWidth = 0;\n        if (isNullOrUndefined(this.column)) {\n            offsetWidth = parentsUntil(this.element, 'th').offsetWidth;\n        }\n        if (this.parent.allowTextWrap) {\n            this.updateResizeEleHeight();\n            this.setHelperHeight();\n        }\n        var pageX = this.getPointX(e);\n        var mousemove = this.parent.enableRtl ? -(pageX - this.pageX) : (pageX - this.pageX);\n        var colData = this.getColData(this.column, mousemove);\n        if (!colData.width) {\n            colData.width = closest(this.element, 'th').offsetWidth;\n        }\n        var width = this.getWidth(colData.width, colData.minWidth, colData.maxWidth);\n        this.parent.log('resize_min_max', { column: this.column, width: width });\n        if ((!this.parent.enableRtl && this.minMove >= pageX) || (this.parent.enableRtl && this.minMove <= pageX)) {\n            width = this.column.minWidth ? parseFloat(this.column.minWidth.toString()) : 0;\n            this.pageX = pageX = this.minMove;\n        }\n        if (width !== parseFloat(isNullOrUndefined(this.column.width) || this.column.width === 'auto' ?\n            offsetWidth.toString() : this.column.width.toString())) {\n            this.pageX = pageX;\n            this.column.width = formatUnit(width);\n            var args = {\n                e: e,\n                column: this.column\n            };\n            this.parent.trigger(events.onResize, args);\n            if (args.cancel) {\n                this.cancelResizeAction(true);\n                return;\n            }\n            var columns = [this.column];\n            var finalColumns = [this.column];\n            if (this.column.columns) {\n                columns = this.getSubColumns(this.column, []);\n                columns = this.calulateColumnsWidth(columns, false, mousemove);\n                finalColumns = this.calulateColumnsWidth(columns, true, mousemove);\n            }\n            for (var _i = 0, finalColumns_1 = finalColumns; _i < finalColumns_1.length; _i++) {\n                var col = finalColumns_1[_i];\n                this.widthService.setColumnWidth(col, null, 'resize');\n            }\n            this.updateHelper();\n        }\n        this.isDblClk = false;\n    };\n    Resize.prototype.calulateColumnsWidth = function (columns, isUpdate, mousemove) {\n        var finalColumns = [];\n        var _loop_1 = function (col) {\n            var totalWidth = 0;\n            columns.forEach(function (col) {\n                totalWidth += parseFloat(col.width.toString());\n            });\n            var colData = this_1.getColData(col, (parseFloat(col.width)) * mousemove / totalWidth);\n            var colWidth = this_1.getWidth(colData.width, colData.minWidth, colData.maxWidth);\n            if ((colWidth !== parseFloat(col.width.toString()))) {\n                if (isUpdate) {\n                    col.width = formatUnit(colWidth < 1 ? 1 : colWidth);\n                }\n                finalColumns.push(col);\n            }\n        };\n        var this_1 = this;\n        for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n            var col = columns_1[_i];\n            _loop_1(col);\n        }\n        return finalColumns;\n    };\n    Resize.prototype.getSubColumns = function (column, subColumns) {\n        for (var _i = 0, _a = column.columns; _i < _a.length; _i++) {\n            var col = _a[_i];\n            if (col.visible !== false && col.allowResizing) {\n                if (col.columns) {\n                    this.getSubColumns(col, subColumns);\n                }\n                else {\n                    subColumns.push(col);\n                }\n            }\n        }\n        return subColumns;\n    };\n    Resize.prototype.resizeEnd = function (e) {\n        if (!this.helper || this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(this.parent.element, Browser.touchMoveEvent, this.resizing);\n        EventHandler.remove(document, Browser.touchEndEvent, this.resizeEnd);\n        this.updateCursor('remove');\n        detach(this.helper);\n        var args = {\n            e: isBlazor() && !this.parent.isJsComponent ? null : e,\n            column: this.column\n        };\n        var content = this.parent.getContent().querySelector('.e-content');\n        var cTable = content.querySelector('.e-movablecontent') ? content.querySelector('.e-movablecontent') : content;\n        if (cTable.scrollHeight >= cTable.clientHeight) {\n            this.parent.scrollModule.setPadding();\n            cTable.style.overflowY = 'scroll';\n        }\n        this.parent.trigger(events.resizeStop, args);\n        closest(this.element, '.e-headercell').classList.add('e-resized');\n        if (parentsUntil(this.element, 'e-frozenheader')) {\n            this.isFrozenColResized = true;\n        }\n        else {\n            this.isFrozenColResized = false;\n        }\n        if (this.parent.getFrozenColumns()) {\n            this.parent.notify(events.freezeRender, { case: 'textwrap' });\n        }\n        if (this.parent.allowTextWrap) {\n            this.updateResizeEleHeight();\n            this.parent.notify(events.textWrapRefresh, { case: 'textwrap' });\n        }\n        this.refresh();\n        this.doubleTapEvent(e);\n        this.isDblClk = true;\n    };\n    Resize.prototype.getPointX = function (e) {\n        if (e.touches && e.touches.length) {\n            return e.touches[0].pageX;\n        }\n        else {\n            return e.pageX;\n        }\n    };\n    Resize.prototype.refreshColumnWidth = function () {\n        var columns = this.parent.getColumns();\n        for (var _i = 0, _a = [].slice.apply(this.parent.getHeaderTable().querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n            var ele = _a[_i];\n            for (var _b = 0, columns_2 = columns; _b < columns_2.length; _b++) {\n                var column = columns_2[_b];\n                if (ele.querySelector('[e-mappinguid]') &&\n                    ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === column.uid && column.visible) {\n                    column.width = ele.getBoundingClientRect().width;\n                    break;\n                }\n            }\n        }\n        return columns;\n    };\n    Resize.prototype.refreshStackedColumnWidth = function () {\n        for (var _i = 0, _a = this.parent.getStackedColumns(this.parent.columns); _i < _a.length; _i++) {\n            var stackedColumn = _a[_i];\n            stackedColumn.width = this.getStackedWidth(stackedColumn, 0);\n        }\n    };\n    Resize.prototype.getStackedWidth = function (column, width) {\n        for (var _i = 0, _a = column.columns; _i < _a.length; _i++) {\n            var col = _a[_i];\n            if (col.visible !== false) {\n                if (col.columns) {\n                    this.getStackedWidth(col, width);\n                }\n                else {\n                    width += col.width;\n                }\n            }\n        }\n        return width;\n    };\n    Resize.prototype.getTargetColumn = function (e) {\n        var cell = closest(e.target, resizeClassList.header);\n        cell = cell.querySelector('.e-headercelldiv') || cell.querySelector('.e-stackedheadercelldiv');\n        var uid = cell.getAttribute('e-mappinguid');\n        return this.parent.getColumnByUid(uid);\n    };\n    Resize.prototype.updateCursor = function (action) {\n        var headerRows = [].slice.call(this.parent.getHeaderContent().querySelectorAll('th'));\n        headerRows.push(this.parent.element);\n        for (var _i = 0, headerRows_1 = headerRows; _i < headerRows_1.length; _i++) {\n            var row = headerRows_1[_i];\n            row.classList[action](resizeClassList.cursor);\n        }\n    };\n    Resize.prototype.refresh = function () {\n        this.column = null;\n        this.pageX = null;\n        this.element = null;\n        this.helper = null;\n    };\n    Resize.prototype.appendHelper = function () {\n        this.helper = this.parent.createElement('div', {\n            className: resizeClassList.helper\n        });\n        this.parent.element.appendChild(this.helper);\n        this.setHelperHeight();\n    };\n    Resize.prototype.setHelperHeight = function () {\n        var height = this.parent.getContent().offsetHeight - this.getScrollBarWidth();\n        var rect = closest(this.element, resizeClassList.header);\n        var tr = [].slice.call(this.parent.getHeaderContent().querySelectorAll('tr'));\n        var frzCols = this.parent.getFrozenColumns();\n        if (frzCols) {\n            if (rect.parentElement.children.length !== frzCols) {\n                tr.splice(0, tr.length / 2);\n            }\n            else {\n                tr.splice(tr.length / 2, tr.length / 2);\n            }\n        }\n        for (var i = tr.indexOf(rect.parentElement); i < tr.length; i++) {\n            height += tr[i].offsetHeight;\n        }\n        var pos = this.calcPos(rect);\n        pos.left += (this.parent.enableRtl ? 0 - 1 : rect.offsetWidth - 2);\n        this.helper.style.cssText = 'height: ' + height + 'px; top: ' + pos.top + 'px; left:' + Math.floor(pos.left) + 'px;';\n    };\n    Resize.prototype.getScrollBarWidth = function (height) {\n        var ele = this.parent.getFrozenColumns() ? this.parent.getContent().querySelector('.e-movablecontent')\n            : this.parent.getContent().firstChild;\n        return (ele.scrollHeight > ele.clientHeight && height) ||\n            ele.scrollWidth > ele.clientWidth ? getScrollBarWidth() : 0;\n    };\n    Resize.prototype.removeHelper = function (e) {\n        var cls = e.target.classList;\n        if (!(cls.contains(resizeClassList.root) || cls.contains(resizeClassList.icon)) && this.helper) {\n            EventHandler.remove(document, Browser.touchStartEvent, this.removeHelper);\n            EventHandler.remove(this.helper, Browser.touchStartEvent, this.resizeStart);\n            detach(this.helper);\n            this.refresh();\n        }\n    };\n    Resize.prototype.updateHelper = function () {\n        var rect = closest(this.element, resizeClassList.header);\n        var left = Math.floor(this.calcPos(rect).left + (this.parent.enableRtl ? 0 - 1 : rect.offsetWidth - 2));\n        var borderWidth = 2; // to maintain the helper inside of grid element.\n        if (left > this.parentElementWidth) {\n            left = this.parentElementWidth - borderWidth;\n        }\n        if (this.parent.getFrozenColumns()) {\n            var table = closest(rect, '.e-table');\n            var fLeft = table.offsetLeft;\n            if (left < fLeft) {\n                left = fLeft;\n            }\n        }\n        this.helper.style.left = left + 'px';\n    };\n    Resize.prototype.calcPos = function (elem) {\n        var parentOffset = {\n            top: 0,\n            left: 0\n        };\n        var offset = elem.getBoundingClientRect();\n        var doc = elem.ownerDocument;\n        var offsetParent = elem.offsetParent || doc.documentElement;\n        while (offsetParent &&\n            (offsetParent === doc.body || offsetParent === doc.documentElement) &&\n            offsetParent.style.position === 'static') {\n            offsetParent = offsetParent.parentNode;\n        }\n        if (offsetParent && offsetParent !== elem && offsetParent.nodeType === 1) {\n            parentOffset = offsetParent.getBoundingClientRect();\n        }\n        return {\n            top: offset.top - parentOffset.top,\n            left: offset.left - parentOffset.left\n        };\n    };\n    Resize.prototype.doubleTapEvent = function (e) {\n        if (this.getUserAgent() && this.isDblClk) {\n            if (!this.tapped) {\n                this.tapped = setTimeout(this.timeoutHandler(), 300);\n            }\n            else {\n                clearTimeout(this.tapped);\n                this.callAutoFit(e);\n                this.tapped = null;\n            }\n        }\n    };\n    Resize.prototype.getUserAgent = function () {\n        var userAgent = Browser.userAgent.toLowerCase();\n        return /iphone|ipod|ipad/.test(userAgent);\n    };\n    Resize.prototype.timeoutHandler = function () {\n        this.tapped = null;\n    };\n    return Resize;\n}());\nexport { Resize };\n"]},"metadata":{},"sourceType":"module"}