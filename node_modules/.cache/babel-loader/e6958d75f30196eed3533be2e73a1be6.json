{"ast":null,"code":"import { Browser, remove, EventHandler, isUndefined, closest, classList } from '@syncfusion/ej2-base';\nimport { parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * The `Clipboard` module is used to handle clipboard copy action.\n */\n\nvar Clipboard =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid clipboard module\n   * @hidden\n   */\n  function Clipboard(parent) {\n    this.copyContent = '';\n    this.isSelect = false;\n    this.parent = parent;\n    this.addEventListener();\n  }\n  /**\n   * @hidden\n   */\n\n\n  Clipboard.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.keyPressed, this.keyDownHandler, this);\n    this.parent.on(events.click, this.clickHandler, this);\n    EventHandler.add(this.parent.element, 'keydown', this.pasteHandler, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Clipboard.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.keyPressed, this.keyDownHandler);\n    this.parent.off(events.click, this.clickHandler);\n    EventHandler.remove(this.parent.element, 'keydown', this.pasteHandler);\n  };\n\n  Clipboard.prototype.clickHandler = function (e) {\n    var target = e.target;\n    target = parentsUntil(target, 'e-rowcell');\n  };\n\n  Clipboard.prototype.pasteHandler = function (e) {\n    var _this = this;\n\n    if (e.keyCode === 86 && e.ctrlKey && !this.parent.isEdit) {\n      var target_1 = closest(document.activeElement, '.e-rowcell');\n\n      if (!target_1) {\n        return;\n      }\n\n      this.activeElement = document.activeElement;\n      this.clipBoardTextArea.value = '';\n      var x_1 = window.scrollX;\n      var y_1 = window.scrollY;\n      this.clipBoardTextArea.focus();\n      setTimeout(function () {\n        _this.activeElement.focus();\n\n        window.scrollTo(x_1, y_1);\n\n        _this.paste(_this.clipBoardTextArea.value, parseInt(target_1.parentElement.getAttribute('aria-rowindex'), 10), parseInt(target_1.getAttribute('aria-colindex'), 10));\n      }, 10);\n    }\n  };\n  /**\n   * Paste data from clipboard to selected cells.\n   * @param {boolean} data - Specifies the date for paste.\n   * @param {boolean} rowIndex - Specifies the row index.\n   * @param {boolean} colIndex - Specifies the column index.\n   */\n\n\n  Clipboard.prototype.paste = function (data, rowIndex, colIndex) {\n    var grid = this.parent;\n    var cIdx = colIndex;\n    var rIdx = rowIndex;\n    var col;\n    var value;\n    var isAvail;\n\n    if (!grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' || grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n      return;\n    }\n\n    var rows = data.split('\\n');\n    var cols;\n    var dataRows = grid.getDataRows();\n    var mRows;\n    var isFrozen = this.parent.getFrozenColumns();\n\n    if (isFrozen) {\n      mRows = grid.getMovableDataRows();\n    }\n\n    for (var r = 0; r < rows.length; r++) {\n      cols = rows[r].split('\\t');\n      cIdx = colIndex;\n\n      if (r === rows.length - 1 && rows[r] === '' || isUndefined(grid.getRowByIndex(rIdx))) {\n        cIdx++;\n        break;\n      }\n\n      for (var c = 0; c < cols.length; c++) {\n        isAvail = grid.getCellFromIndex(rIdx, cIdx);\n\n        if (isFrozen) {\n          var fTr = dataRows[rIdx];\n          var mTr = mRows[rIdx];\n          isAvail = !fTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') ? mTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') : true;\n        }\n\n        if (!isAvail) {\n          cIdx++;\n          break;\n        }\n\n        col = grid.getColumnByIndex(cIdx);\n        value = col.getParser() ? col.getParser()(cols[c]) : cols[c];\n\n        if (col.allowEditing && !col.isPrimaryKey && !col.template) {\n          var args = {\n            column: col,\n            data: value\n          };\n          this.parent.trigger(events.beforePaste, args);\n\n          if (!args.cancel) {\n            if (grid.editModule) {\n              if (col.type === 'number') {\n                this.parent.editModule.updateCell(rIdx, col.field, parseInt(args.data, 10));\n              } else {\n                grid.editModule.updateCell(rIdx, col.field, args.data);\n              }\n            }\n          }\n        }\n\n        cIdx++;\n      }\n\n      rIdx++;\n    }\n\n    grid.selectionModule.selectCellsByRange({\n      rowIndex: rowIndex,\n      cellIndex: colIndex\n    }, {\n      rowIndex: rIdx - 1,\n      cellIndex: cIdx - 1\n    });\n    var cell = this.parent.getCellFromIndex(rIdx - 1, cIdx - 1);\n\n    if (cell) {\n      classList(cell, ['e-focus', 'e-focused'], []);\n    }\n  };\n\n  Clipboard.prototype.initialEnd = function () {\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.clipBoardTextArea = this.parent.createElement('textarea', {\n      className: 'e-clipboard',\n      styles: 'opacity: 0',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'clipboard'\n      }\n    });\n    this.parent.element.appendChild(this.clipBoardTextArea);\n  };\n\n  Clipboard.prototype.keyDownHandler = function (e) {\n    if (e.action === 'ctrlPlusC') {\n      this.copy();\n    } else if (e.action === 'ctrlShiftPlusH') {\n      this.copy(true);\n    }\n  };\n\n  Clipboard.prototype.setCopyData = function (withHeader) {\n    if (window.getSelection().toString() === '') {\n      var isFrozen = this.parent.getFrozenColumns();\n      this.clipBoardTextArea.value = this.copyContent = '';\n      var mRows = void 0;\n      var rows = this.parent.getRows();\n\n      if (isFrozen) {\n        mRows = this.parent.getMovableDataRows();\n      }\n\n      if (this.parent.selectionSettings.mode !== 'Cell') {\n        var selectedIndexes = this.parent.getSelectedRowIndexes().sort(function (a, b) {\n          return a - b;\n        });\n\n        if (withHeader) {\n          var headerTextArray = [];\n\n          for (var i = 0; i < this.parent.getVisibleColumns().length; i++) {\n            headerTextArray[i] = this.parent.getVisibleColumns()[i].headerText;\n          }\n\n          this.getCopyData(headerTextArray, false, '\\t', withHeader);\n          this.copyContent += '\\n';\n        }\n\n        for (var i = 0; i < selectedIndexes.length; i++) {\n          if (i > 0) {\n            this.copyContent += '\\n';\n          }\n\n          var cells = [].slice.call(rows[selectedIndexes[i]].querySelectorAll('.e-rowcell'));\n\n          if (isFrozen) {\n            cells.push.apply(cells, [].slice.call(mRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n          }\n\n          this.getCopyData(cells, false, '\\t', withHeader);\n        }\n      } else {\n        var obj = this.checkBoxSelection();\n\n        if (obj.status) {\n          if (withHeader) {\n            var headers = [];\n\n            for (var i = 0; i < obj.colIndexes.length; i++) {\n              headers.push(this.parent.getColumnHeaderByIndex(obj.colIndexes[i]));\n            }\n\n            this.getCopyData(headers, false, '\\t', withHeader);\n            this.copyContent += '\\n';\n          }\n\n          for (var i = 0; i < obj.rowIndexes.length; i++) {\n            if (i > 0) {\n              this.copyContent += '\\n';\n            }\n\n            var cells = [].slice.call(rows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground'));\n\n            if (isFrozen) {\n              cells.push.apply(cells, [].slice.call(mRows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground')));\n            }\n\n            this.getCopyData(cells, false, '\\t', withHeader);\n          }\n        } else {\n          this.getCopyData([].slice.call(this.parent.element.querySelectorAll('.e-cellselectionbackground')), true, '\\n', withHeader);\n        }\n      }\n\n      var args = {\n        data: this.copyContent,\n        cancel: false\n      };\n      this.parent.trigger(events.beforeCopy, args);\n\n      if (args.cancel) {\n        return;\n      }\n\n      this.clipBoardTextArea.value = this.copyContent = args.data;\n\n      if (!Browser.userAgent.match(/ipad|ipod|iphone/i)) {\n        this.clipBoardTextArea.select();\n      } else {\n        this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n      }\n\n      this.isSelect = true;\n    }\n  };\n\n  Clipboard.prototype.getCopyData = function (cells, isCell, splitKey, withHeader) {\n    var isElement = typeof cells[0] !== 'string';\n\n    for (var j = 0; j < cells.length; j++) {\n      if (withHeader && isCell) {\n        this.copyContent += this.parent.getColumns()[parseInt(cells[j].getAttribute('aria-colindex'), 10)].headerText + '\\n';\n      }\n\n      if (isElement) {\n        if (!cells[j].classList.contains('e-hide')) {\n          this.copyContent += cells[j].innerText;\n        }\n      } else {\n        this.copyContent += cells[j];\n      }\n\n      if (j < cells.length - 1) {\n        this.copyContent += splitKey;\n      }\n    }\n  };\n  /**\n   * Copy selected rows or cells data into clipboard.\n   * @param {boolean} withHeader - Specifies whether the column header data need to be copied or not.\n   */\n\n\n  Clipboard.prototype.copy = function (withHeader) {\n    if (document.queryCommandSupported('copy')) {\n      this.setCopyData(withHeader);\n      document.execCommand('copy');\n      this.clipBoardTextArea.blur();\n    }\n\n    if (this.isSelect) {\n      window.getSelection().removeAllRanges();\n      this.isSelect = false;\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  Clipboard.prototype.getModuleName = function () {\n    return 'clipboard';\n  };\n  /**\n   * To destroy the clipboard\n   * @return {void}\n   * @hidden\n   */\n\n\n  Clipboard.prototype.destroy = function () {\n    this.removeEventListener();\n\n    if (this.clipBoardTextArea) {\n      remove(this.clipBoardTextArea);\n    }\n  };\n\n  Clipboard.prototype.checkBoxSelection = function () {\n    var gridObj = this.parent;\n    var obj = {\n      status: false\n    };\n\n    if (gridObj.selectionSettings.mode === 'Cell') {\n      var rowCellIndxes = gridObj.getSelectedRowCellIndexes();\n      var str = void 0;\n      var isBox = void 0;\n      var rowIndexes = [];\n      var i = void 0;\n\n      for (i = 0; i < rowCellIndxes.length; i++) {\n        if (rowCellIndxes[i].cellIndexes.length) {\n          rowIndexes.push(rowCellIndxes[i].rowIndex);\n        }\n\n        if (rowCellIndxes[i].cellIndexes.length) {\n          if (!str) {\n            str = JSON.stringify(rowCellIndxes[i].cellIndexes.sort());\n          }\n\n          if (str !== JSON.stringify(rowCellIndxes[i].cellIndexes.sort())) {\n            break;\n          }\n        }\n      }\n\n      rowIndexes.sort(function (a, b) {\n        return a - b;\n      });\n\n      if (i === rowCellIndxes.length && rowIndexes[rowIndexes.length - 1] - rowIndexes[0] === rowIndexes.length - 1) {\n        obj = {\n          status: true,\n          rowIndexes: rowIndexes,\n          colIndexes: rowCellIndxes[0].cellIndexes\n        };\n      }\n    }\n\n    return obj;\n  };\n\n  return Clipboard;\n}();\n\nexport { Clipboard };","map":{"version":3,"sources":["C:/CN2/workspace-trunk/kain-front-end/node_modules/@syncfusion/ej2-grids/src/grid/actions/clipboard.js"],"names":["Browser","remove","EventHandler","isUndefined","closest","classList","parentsUntil","events","Clipboard","parent","copyContent","isSelect","addEventListener","prototype","isDestroyed","on","contentReady","initialEnd","keyPressed","keyDownHandler","click","clickHandler","add","element","pasteHandler","removeEventListener","off","e","target","_this","keyCode","ctrlKey","isEdit","target_1","document","activeElement","clipBoardTextArea","value","x_1","window","scrollX","y_1","scrollY","focus","setTimeout","scrollTo","paste","parseInt","parentElement","getAttribute","data","rowIndex","colIndex","grid","cIdx","rIdx","col","isAvail","editSettings","allowEditing","mode","selectionSettings","cellSelectionMode","rows","split","cols","dataRows","getDataRows","mRows","isFrozen","getFrozenColumns","getMovableDataRows","r","length","getRowByIndex","c","getCellFromIndex","fTr","mTr","querySelector","getColumnByIndex","getParser","isPrimaryKey","template","args","column","trigger","beforePaste","cancel","editModule","type","updateCell","field","selectionModule","selectCellsByRange","cellIndex","cell","createElement","className","styles","attrs","tabindex","appendChild","action","copy","setCopyData","withHeader","getSelection","toString","getRows","selectedIndexes","getSelectedRowIndexes","sort","a","b","headerTextArray","i","getVisibleColumns","headerText","getCopyData","cells","slice","call","querySelectorAll","push","apply","obj","checkBoxSelection","status","headers","colIndexes","getColumnHeaderByIndex","rowIndexes","beforeCopy","userAgent","match","select","setSelectionRange","isCell","splitKey","isElement","j","getColumns","contains","innerText","queryCommandSupported","execCommand","blur","removeAllRanges","getModuleName","destroy","gridObj","rowCellIndxes","getSelectedRowCellIndexes","str","isBox","cellIndexes","JSON","stringify"],"mappings":"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","sourcesContent":["import { Browser, remove, EventHandler, isUndefined, closest, classList } from '@syncfusion/ej2-base';\nimport { parentsUntil } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * The `Clipboard` module is used to handle clipboard copy action.\n */\nvar Clipboard = /** @class */ (function () {\n    /**\n     * Constructor for the Grid clipboard module\n     * @hidden\n     */\n    function Clipboard(parent) {\n        this.copyContent = '';\n        this.isSelect = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * @hidden\n     */\n    Clipboard.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.keyPressed, this.keyDownHandler, this);\n        this.parent.on(events.click, this.clickHandler, this);\n        EventHandler.add(this.parent.element, 'keydown', this.pasteHandler, this);\n    };\n    /**\n     * @hidden\n     */\n    Clipboard.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.keyPressed, this.keyDownHandler);\n        this.parent.off(events.click, this.clickHandler);\n        EventHandler.remove(this.parent.element, 'keydown', this.pasteHandler);\n    };\n    Clipboard.prototype.clickHandler = function (e) {\n        var target = e.target;\n        target = parentsUntil(target, 'e-rowcell');\n    };\n    Clipboard.prototype.pasteHandler = function (e) {\n        var _this = this;\n        if (e.keyCode === 86 && e.ctrlKey && !this.parent.isEdit) {\n            var target_1 = closest(document.activeElement, '.e-rowcell');\n            if (!target_1) {\n                return;\n            }\n            this.activeElement = document.activeElement;\n            this.clipBoardTextArea.value = '';\n            var x_1 = window.scrollX;\n            var y_1 = window.scrollY;\n            this.clipBoardTextArea.focus();\n            setTimeout(function () {\n                _this.activeElement.focus();\n                window.scrollTo(x_1, y_1);\n                _this.paste(_this.clipBoardTextArea.value, parseInt(target_1.parentElement.getAttribute('aria-rowindex'), 10), parseInt(target_1.getAttribute('aria-colindex'), 10));\n            }, 10);\n        }\n    };\n    /**\n     * Paste data from clipboard to selected cells.\n     * @param {boolean} data - Specifies the date for paste.\n     * @param {boolean} rowIndex - Specifies the row index.\n     * @param {boolean} colIndex - Specifies the column index.\n     */\n    Clipboard.prototype.paste = function (data, rowIndex, colIndex) {\n        var grid = this.parent;\n        var cIdx = colIndex;\n        var rIdx = rowIndex;\n        var col;\n        var value;\n        var isAvail;\n        if (!grid.editSettings.allowEditing || grid.editSettings.mode !== 'Batch' ||\n            grid.selectionSettings.mode !== 'Cell' || grid.selectionSettings.cellSelectionMode === 'Flow') {\n            return;\n        }\n        var rows = data.split('\\n');\n        var cols;\n        var dataRows = grid.getDataRows();\n        var mRows;\n        var isFrozen = this.parent.getFrozenColumns();\n        if (isFrozen) {\n            mRows = grid.getMovableDataRows();\n        }\n        for (var r = 0; r < rows.length; r++) {\n            cols = rows[r].split('\\t');\n            cIdx = colIndex;\n            if ((r === rows.length - 1 && rows[r] === '') || isUndefined(grid.getRowByIndex(rIdx))) {\n                cIdx++;\n                break;\n            }\n            for (var c = 0; c < cols.length; c++) {\n                isAvail = grid.getCellFromIndex(rIdx, cIdx);\n                if (isFrozen) {\n                    var fTr = dataRows[rIdx];\n                    var mTr = mRows[rIdx];\n                    isAvail = !fTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') ?\n                        mTr.querySelector('[aria-colindex=\"' + cIdx + '\"]') : true;\n                }\n                if (!isAvail) {\n                    cIdx++;\n                    break;\n                }\n                col = grid.getColumnByIndex(cIdx);\n                value = col.getParser() ? col.getParser()(cols[c]) : cols[c];\n                if (col.allowEditing && !col.isPrimaryKey && !col.template) {\n                    var args = {\n                        column: col,\n                        data: value,\n                    };\n                    this.parent.trigger(events.beforePaste, args);\n                    if (!args.cancel) {\n                        if (grid.editModule) {\n                            if (col.type === 'number') {\n                                this.parent.editModule.updateCell(rIdx, col.field, parseInt(args.data, 10));\n                            }\n                            else {\n                                grid.editModule.updateCell(rIdx, col.field, args.data);\n                            }\n                        }\n                    }\n                }\n                cIdx++;\n            }\n            rIdx++;\n        }\n        grid.selectionModule.selectCellsByRange({ rowIndex: rowIndex, cellIndex: colIndex }, { rowIndex: rIdx - 1, cellIndex: cIdx - 1 });\n        var cell = this.parent.getCellFromIndex(rIdx - 1, cIdx - 1);\n        if (cell) {\n            classList(cell, ['e-focus', 'e-focused'], []);\n        }\n    };\n    Clipboard.prototype.initialEnd = function () {\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.clipBoardTextArea = this.parent.createElement('textarea', {\n            className: 'e-clipboard',\n            styles: 'opacity: 0',\n            attrs: { tabindex: '-1', 'aria-label': 'clipboard' }\n        });\n        this.parent.element.appendChild(this.clipBoardTextArea);\n    };\n    Clipboard.prototype.keyDownHandler = function (e) {\n        if (e.action === 'ctrlPlusC') {\n            this.copy();\n        }\n        else if (e.action === 'ctrlShiftPlusH') {\n            this.copy(true);\n        }\n    };\n    Clipboard.prototype.setCopyData = function (withHeader) {\n        if (window.getSelection().toString() === '') {\n            var isFrozen = this.parent.getFrozenColumns();\n            this.clipBoardTextArea.value = this.copyContent = '';\n            var mRows = void 0;\n            var rows = this.parent.getRows();\n            if (isFrozen) {\n                mRows = this.parent.getMovableDataRows();\n            }\n            if (this.parent.selectionSettings.mode !== 'Cell') {\n                var selectedIndexes = this.parent.getSelectedRowIndexes().sort(function (a, b) { return a - b; });\n                if (withHeader) {\n                    var headerTextArray = [];\n                    for (var i = 0; i < this.parent.getVisibleColumns().length; i++) {\n                        headerTextArray[i] = this.parent.getVisibleColumns()[i].headerText;\n                    }\n                    this.getCopyData(headerTextArray, false, '\\t', withHeader);\n                    this.copyContent += '\\n';\n                }\n                for (var i = 0; i < selectedIndexes.length; i++) {\n                    if (i > 0) {\n                        this.copyContent += '\\n';\n                    }\n                    var cells = [].slice.call(rows[selectedIndexes[i]].querySelectorAll('.e-rowcell'));\n                    if (isFrozen) {\n                        cells.push.apply(cells, [].slice.call(mRows[selectedIndexes[i]].querySelectorAll('.e-rowcell')));\n                    }\n                    this.getCopyData(cells, false, '\\t', withHeader);\n                }\n            }\n            else {\n                var obj = this.checkBoxSelection();\n                if (obj.status) {\n                    if (withHeader) {\n                        var headers = [];\n                        for (var i = 0; i < obj.colIndexes.length; i++) {\n                            headers.push(this.parent.getColumnHeaderByIndex(obj.colIndexes[i]));\n                        }\n                        this.getCopyData(headers, false, '\\t', withHeader);\n                        this.copyContent += '\\n';\n                    }\n                    for (var i = 0; i < obj.rowIndexes.length; i++) {\n                        if (i > 0) {\n                            this.copyContent += '\\n';\n                        }\n                        var cells = [].slice.call(rows[obj.rowIndexes[i]].\n                            querySelectorAll('.e-cellselectionbackground'));\n                        if (isFrozen) {\n                            cells.push.apply(cells, [].slice.call(mRows[obj.rowIndexes[i]].querySelectorAll('.e-cellselectionbackground')));\n                        }\n                        this.getCopyData(cells, false, '\\t', withHeader);\n                    }\n                }\n                else {\n                    this.getCopyData([].slice.call(this.parent.element.querySelectorAll('.e-cellselectionbackground')), true, '\\n', withHeader);\n                }\n            }\n            var args = {\n                data: this.copyContent,\n                cancel: false,\n            };\n            this.parent.trigger(events.beforeCopy, args);\n            if (args.cancel) {\n                return;\n            }\n            this.clipBoardTextArea.value = this.copyContent = args.data;\n            if (!Browser.userAgent.match(/ipad|ipod|iphone/i)) {\n                this.clipBoardTextArea.select();\n            }\n            else {\n                this.clipBoardTextArea.setSelectionRange(0, this.clipBoardTextArea.value.length);\n            }\n            this.isSelect = true;\n        }\n    };\n    Clipboard.prototype.getCopyData = function (cells, isCell, splitKey, withHeader) {\n        var isElement = typeof cells[0] !== 'string';\n        for (var j = 0; j < cells.length; j++) {\n            if (withHeader && isCell) {\n                this.copyContent += this.parent.getColumns()[parseInt(cells[j].getAttribute('aria-colindex'), 10)].headerText + '\\n';\n            }\n            if (isElement) {\n                if (!cells[j].classList.contains('e-hide')) {\n                    this.copyContent += cells[j].innerText;\n                }\n            }\n            else {\n                this.copyContent += cells[j];\n            }\n            if (j < cells.length - 1) {\n                this.copyContent += splitKey;\n            }\n        }\n    };\n    /**\n     * Copy selected rows or cells data into clipboard.\n     * @param {boolean} withHeader - Specifies whether the column header data need to be copied or not.\n     */\n    Clipboard.prototype.copy = function (withHeader) {\n        if (document.queryCommandSupported('copy')) {\n            this.setCopyData(withHeader);\n            document.execCommand('copy');\n            this.clipBoardTextArea.blur();\n        }\n        if (this.isSelect) {\n            window.getSelection().removeAllRanges();\n            this.isSelect = false;\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    /**\n     * To destroy the clipboard\n     * @return {void}\n     * @hidden\n     */\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.clipBoardTextArea) {\n            remove(this.clipBoardTextArea);\n        }\n    };\n    Clipboard.prototype.checkBoxSelection = function () {\n        var gridObj = this.parent;\n        var obj = { status: false };\n        if (gridObj.selectionSettings.mode === 'Cell') {\n            var rowCellIndxes = gridObj.getSelectedRowCellIndexes();\n            var str = void 0;\n            var isBox = void 0;\n            var rowIndexes = [];\n            var i = void 0;\n            for (i = 0; i < rowCellIndxes.length; i++) {\n                if (rowCellIndxes[i].cellIndexes.length) {\n                    rowIndexes.push(rowCellIndxes[i].rowIndex);\n                }\n                if (rowCellIndxes[i].cellIndexes.length) {\n                    if (!str) {\n                        str = JSON.stringify(rowCellIndxes[i].cellIndexes.sort());\n                    }\n                    if (str !== JSON.stringify(rowCellIndxes[i].cellIndexes.sort())) {\n                        break;\n                    }\n                }\n            }\n            rowIndexes.sort(function (a, b) { return a - b; });\n            if (i === rowCellIndxes.length && rowIndexes[rowIndexes.length - 1] - rowIndexes[0] === rowIndexes.length - 1) {\n                obj = { status: true, rowIndexes: rowIndexes, colIndexes: rowCellIndxes[0].cellIndexes };\n            }\n        }\n        return obj;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n"]},"metadata":{},"sourceType":"module"}